"use strict";var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.MORNING="morning",this.AFTERNOON="afternoon",this.EVENING="evening"}return a}();a.TimeOfDay=b;var c=function(){function a(){this.MORNING=12,this.AFTERNOON=17,this.EVENING=23}return a}();a.TimeOfDayBounds=c;var d=function(){function a(){this.DATE_FORMAT="YYYY-MM-DD",this.TIME_FORMAT="HH:mm:ss.SSS",this.DATE_TIME_FORMAT="YYYY-MM-DDTHH:mm:ss.SSS"}return a}();a.DateDefaultsConst=d}(b=a.constants||(a.constants={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(){angular.module("bookingsDynamicForm",["ngMessages","schedulerCommonStatics","schedulerCommonScrollbar"])}(b=a.form||(a.form={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.FULL="Full",a.PARTIAL="Partial",a}();a.DynamicAttributeDisplayTypes=b;var c=function(){function a(){}return a.SHORT_TEXT="SHORT_TEXT",a.LONG_TEXT="LONG_TEXT",a.EMAIL="EMAIL",a.PHONE="PHONE_NUMBER",a.DROP_DOWN="DROP_DOWN",a.NUMBER="NUMBER",a.CHECKBOX="CHECK_BOX",a}();a.DynamicFormValueTypes=c;var d=function(){function a(){}return a.FULL_NAME="FullName",a.EMAIL="Email",a.CUSTOM_FIELD="Custom",a.PHONE="PhoneNumber",a.MESSAGE="Message",a.ADDRESS="Address",a.CITY="City",a.STREET="Street",a.STATE="State",a.ZIP="ZipCode",a.APARTMENT="AptFloorNo",a.NUM_OF_PARTICIPANTS="NumberOfParticipants",a.SMS_REMINDER="SMSReminder",a.isAddressProperty=function(a){return["Street","AptFloorNo","City","State","ZipCode"].indexOf(a)>-1},a}();a.DynamicFormFieldTypes=d;var e=function(){function a(){}return a.FULL_NAME="name",a.EMAIL="email",a.PHONE="tel",a.STREET="street-address",a.CITY="address-level2",a.STATE="address-level1",a.ZIP="postal-code",a.NO_AUTO_FILL="",a}();a.DynamicFormFieldAutofills=e,a.DynamicFormFieldTypeAutofillMap=(new Map).set(d.FULL_NAME,e.FULL_NAME).set(d.EMAIL,e.EMAIL).set(d.PHONE,e.PHONE).set(d.STREET,e.STREET).set(d.CITY,e.CITY).set(d.STATE,e.STATE).set(d.ZIP,e.ZIP);var f=function(){function a(){}return a.PRISTINE="Default",a.DIRTY="OwnerCustomized",a}();a.DynamicFormSources=f;var g=function(){function a(a){void 0===a&&(a={});var b={fieldType:d.CUSTOM_FIELD,valueType:c.SHORT_TEXT,label:"",displayType:"Full",isReadOnly:!1};Object.assign(this,b,a)}return a}();a.DynamicFormAttribute=g}(b=a.form||(a.form={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.API_PREFIX="_api/bookings-viewer/",a.DYNAMIC_FORM_API_PREFIX=a.API_PREFIX+"bookingsForm/",a}();a.DynamicFormApiConst=b;var c=function(){function a(a,b,c){var d=this;this.$http=a,this.commonApiBase=b,this.apiConst=c,this.gettingBookingsDynamicForm=this.commonApiBase.httpWrapper(function(a){var b=a.isDummyOffering?"preview/":a.offeringType+"/",c=a.isDummyOffering?"":a.offeringId+"/"+("GROUP"===a.offeringType?a.offeringInstanceId+"/":""),e=d.isPricingPlanSuffixRequired(a)?a.bookedAs+"/":"";return d.$http.get(d.apiConst.BOOKINGS_VIEWER_FES+"/bookingsForm/"+b+c+e)})}return a.$inject=["$http","commonApiBase","apiConst"],a.prototype.isPricingPlanSuffixRequired=function(a){return!a.isDummyOffering&&a.bookedAs},a}();a.DynamicFormApiSrv=c,angular.module("bookingsDynamicForm").service("dynamicFormApiSrv",c)}(b=a.form||(a.form={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a,b,c){this.dynamicFormApiSrv=a,this.experimentsEnabler=b,this.$q=c}return b.$inject=["dynamicFormApiSrv","experimentsEnabler","$q"],b.prototype.gettingBookingsDynamicForm=function(a,c,d){return this.dynamicFormApiSrv.gettingBookingsDynamicForm(a).then(function(c){return b.overrideLegacyInfo(a,c)}).then(function(a){return b.enrichFormDataWithContactInfo(a,c,d)})},b.overrideLegacyInfo=function(c,d){if(c.legacyLabels&&b.isNeverModifiedByOwner(d)&&c.legacyLabels.message){var e=d.form.fields.find(function(b){return b.fieldType===a.DynamicFormFieldTypes.MESSAGE});e&&(e.label=c.legacyLabels.message)}return d},b.isNeverModifiedByOwner=function(b){return b.source===a.DynamicFormSources.PRISTINE},b.enrichFormDataWithContactInfo=function(a,c,d){var e={},f=c.dynamicFormData;if(e.name=c.name||d.fullName,e.phone=c.phone||d.phoneNumber,e.email=c.email||d.email,e.message=c.message,e.address=c.address||{},a.form.fields=a.form.fields.map(function(a){return b.updateDynamicFormAttributeByLegacyContactInfo(a,e,d)}),f&&f.form&&f.form.fields){var g=new Map;b.createDynamicFormFieldValueMap(g,f.form.fields,d),a.form.fields=a.form.fields.map(function(a){return b.updateDynamicFormAttributeWithExistingDynamicForm(a,g)})}return a},b.createDynamicFormFieldValueMap=function(c,d,e){d.forEach(function(d){c.set(d.id,d.fieldType===a.DynamicFormFieldTypes.EMAIL?e.email||d.value:d.value),d.subFields&&d.subFields.length>0&&b.createDynamicFormFieldValueMap(c,d.subFields,e)})},b.prototype.enrichContactInfoWithFormData=function(a,c){c&&c.form&&c.form.fields&&c.form.fields.forEach(function(c){return b.updateContactInfoByDynamicFormAttribute(a,c)})},b.updateDynamicFormAttributeByLegacyContactInfo=function(c,d,e){var f=new a.DynamicFormAttribute(c);switch(c.fieldType){case a.DynamicFormFieldTypes.FULL_NAME:f.value=d.name||f.value;break;case a.DynamicFormFieldTypes.PHONE:f.value=d.phone||f.value;break;case a.DynamicFormFieldTypes.EMAIL:f.value=d.email||f.value,f.isReadOnly=!!e.email;break;case a.DynamicFormFieldTypes.MESSAGE:f.value=d.message||f.value;break;case a.DynamicFormFieldTypes.ADDRESS:f.subFields=b.updateDynamicFormAddressAttributeByLegacyContactInfo(f,d.address)}return f},b.updateDynamicFormAddressAttributeByLegacyContactInfo=function(b,c){return b.subFields.map(function(b){var d=new a.DynamicFormAttribute(b);switch(d.displayType=a.DynamicAttributeDisplayTypes.PARTIAL,d.fieldType){case a.DynamicFormFieldTypes.STREET:d.value=c.addressLine;break;case a.DynamicFormFieldTypes.STATE:d.value=c.state;break;case a.DynamicFormFieldTypes.CITY:d.value=c.city;break;case a.DynamicFormFieldTypes.APARTMENT:d.value=c.aptOrFloor}return d})},b.updateDynamicFormAttributeWithExistingDynamicForm=function(a,c){var d=c.get(a.id);return a.value=d||a.value,a.subFields&&a.subFields.length>0&&(a.subFields=b.updateSubFieldsAttributesWithExistingDynamicForm(a,c)),a},b.updateSubFieldsAttributesWithExistingDynamicForm=function(a,c){return a.subFields.map(function(a){return b.updateDynamicFormAttributeWithExistingDynamicForm(a,c)})},b.updateContactInfoByDynamicFormAttribute=function(c,d){switch(d.fieldType){case a.DynamicFormFieldTypes.FULL_NAME:c.name=d.value;break;case a.DynamicFormFieldTypes.PHONE:c.phone=d.value;break;case a.DynamicFormFieldTypes.EMAIL:c.email=d.value;break;case a.DynamicFormFieldTypes.MESSAGE:c.message=d.value;break;case a.DynamicFormFieldTypes.ADDRESS:c.address=c.address||{},d.subFields.forEach(function(a){return b.updateAddressByDynamicFormAttribute(c.address,a)})}},b.updateAddressByDynamicFormAttribute=function(b,c){if(c.value)switch(c.fieldType){case a.DynamicFormFieldTypes.STREET:b.addressLine=c.value;break;case a.DynamicFormFieldTypes.CITY:b.city=c.value;break;case a.DynamicFormFieldTypes.APARTMENT:b.aptOrFloor=c.value;break;case a.DynamicFormFieldTypes.STATE:b.state=c.value}},b.prototype.countRequiredFields=function(a){var b=function(a){return a?a.reduce(function(a,c){return a+(c.userConstraints&&c.userConstraints.required?1:0)+b(c.subFields)},0):0};return a&&a.form?b(a.form.fields):0},b.prototype.getTypeById=function(a,b){var c=void 0,d=function(a){a.forEach(function(a){a.id===b?c=a.fieldType:a.subFields&&d(a.subFields)})};return a&&a.form&&d(a.form.fields),c},b.prototype.fieldTypeToAutofill=function(b){var c=a.DynamicFormFieldTypeAutofillMap.get(b);return c||a.DynamicFormFieldAutofills.NO_AUTO_FILL},b.prototype.mapDynamicFormToCashierMandatoryFields=function(b){var c=this,d={},e=[{keys:["firstName","lastName"],type:a.DynamicFormFieldTypes.FULL_NAME,eval:function(a){return c.getFirstLastName(a)}},{keys:["phone"],type:a.DynamicFormFieldTypes.PHONE,eval:function(a){return[a]}},{keys:["email"],type:a.DynamicFormFieldTypes.EMAIL,eval:function(a){return[a]}},{keys:["city"],type:a.DynamicFormFieldTypes.CITY,eval:function(a){return[a]}},{keys:["street"],type:a.DynamicFormFieldTypes.STREET,eval:function(a){return[a]}},{keys:["houseNumber"],type:a.DynamicFormFieldTypes.APARTMENT,eval:function(a){return[a]}}];return e.forEach(function(a){var e=a.keys,f=a.eval(c.getDynamicFormFieldByType(b,a.type));e.forEach(function(a,b){void 0!==f[b]&&(d[a]=f[b])})}),d},b.prototype.getDynamicFormFieldByType=function(a,b){var c=a.form.fields.find(function(a){return a.fieldType===b});return c?c.value:void 0},b.prototype.getFirstLastName=function(a){var b,c=a.split(" "),d="";return b=c.splice(0,1)[0],c.length>0&&(d=c.join(" ")),[b,d]},b}();a.DynamicFormSrv=b,angular.module("bookingsDynamicForm").service("dynamicFormSrv",b)}(b=a.form||(a.form={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a,b,c,d,e,f,g){this.$compile=a,this.$element=b,this.$scope=c,this.$filter=d,this.dynamicFormSrv=e,this.smsRemindersSrv=f,this.experimentsEnabler=g,this.isInFocus=!1,this.isChecked=!1,this.escapeHtml=d("escapeHtml"),this.isUoUCTAEnabled=g.isUoUCTAEnabled(),this.isCheckbox()&&this.isRequired()&&!this.attribute.value&&this.onValidValueSelected("false"),this.notifyDropDownAttributeValueExist(),this.shouldEnrichPhoneInput=f.isEnabled(this.businessInfo)}return b.$inject=["$compile","$element","$scope","$filter","dynamicFormSrv","smsRemindersSrv","experimentsEnabler"],b.prototype.notifyDropDownAttributeValueExist=function(){this.attribute.value&&this.isDropDown()&&this.onAttributeValueChanged()},b.prototype.getInputNodeName=function(){var b="";switch(this.attribute.valueType){case a.DynamicFormValueTypes.EMAIL:case a.DynamicFormValueTypes.PHONE:case a.DynamicFormValueTypes.NUMBER:case a.DynamicFormValueTypes.CHECKBOX:b="input";break;case a.DynamicFormValueTypes.SHORT_TEXT:b=this.isMobileContainer()&&this.attribute.fieldType===a.DynamicFormFieldTypes.CUSTOM_FIELD?"textarea":"input";break;case a.DynamicFormValueTypes.LONG_TEXT:b="textarea"}return b},b.prototype.getInputTypeByValueType=function(){var b="";switch(this.attribute.valueType){case a.DynamicFormValueTypes.EMAIL:b="email";break;case a.DynamicFormValueTypes.PHONE:b="tel";break;case a.DynamicFormValueTypes.NUMBER:b="number";break;case a.DynamicFormValueTypes.CHECKBOX:b="checkbox";break;default:b="text"}return b},b.prototype.onValidValueSelected=function(a){this.attribute.value=a,this.onAttributeValueChanged()},b.prototype.onAttributeValueChanged=function(){this.onAttributeChanged({attribute:this.attribute})},b.prototype.renderDropDown=function(){var b="";if(this.attribute.valueType===a.DynamicFormValueTypes.DROP_DOWN)this.dropDownValidValues=this.attribute.validValues.map(function(a){return{value:a.id,label:a.label}}),b=this.generateDropDownTemplate();else if(this.attribute.fieldType===a.DynamicFormFieldTypes.NUM_OF_PARTICIPANTS){var c=1,d=this.attribute.userConstraints.max;if(d>1){this.dropDownValidValues=[];for(var e=c;d>=e;e++)this.dropDownValidValues.push({value:e,label:""+e});b=this.generateDropDownTemplate("max-participants-dropdown")}}return b},b.prototype.generateDropDownTemplate=function(a){var b=this;void 0===a&&(a="dynamic-form-attribute-dropdown");var c=this.dropDownValidValues.indexOf(this.dropDownValidValues.find(function(a){return a.value===b.attribute.value})),d=c>-1?'selected-item="$ctrl.dropDownValidValues['+c+']"':"";return'<boost-dropdown data-hook="'+a+'"\n                              items="$ctrl.dropDownValidValues"\n                              on-select="$ctrl.onValidValueSelected(value)"\n                              custom-class="dropdown--input dropdown--input__form"\n                              '+d+"></boost-dropdown>"},b.prototype.isInvalid=function(){var a=this.attribute.id;return this.formController[a]&&this.formController[a].$dirty&&this.formController[a].$invalid},b.prototype.shouldRenderTemplate=function(){return!(this.isSubFieldExist()||this.hasOneParticipant())},b.prototype.hasOneParticipant=function(){return this.isNumberOfParticipantAttribute()&&this.attribute.userConstraints.max<=1},b.prototype.isNumberOfParticipantAttribute=function(){return this.attribute.fieldType===a.DynamicFormFieldTypes.NUM_OF_PARTICIPANTS},b.prototype.isSubFieldExist=function(){return this.attribute.subFields&&this.attribute.subFields.length>0},b.prototype.ngRequired=function(){return this.setFieldDirtyIfNeeded(),this.isRequired()},b.prototype.setFieldDirtyIfNeeded=function(){if(this.isDirty()){var a=this.attribute.id;this.formController[a].$setDirty()}},b.prototype.isDirty=function(){return this.attribute.userConstraints&&this.attribute.userConstraints.dirty},b.prototype.isRequired=function(){return this.attribute.userConstraints&&this.attribute.userConstraints.required},b.prototype.shouldRenderLabel=function(){return this.attribute.valueType!==a.DynamicFormValueTypes.CHECKBOX},b.prototype.getSubComponentToRender=function(){return"bks-dynamic-form-attribute"},b.prototype.getPlaceholder=function(){return""},b.prototype.isAttributeWithSubElements=function(){return!1},b.prototype.hasTextAreaAutoScale=function(){return!1},b.prototype.mapCamelCaseToDashed=function(){return this.attribute.fieldType.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},b.prototype.getInputConstrains=function(){var b="";switch(this.attribute.valueType){case a.DynamicFormValueTypes.EMAIL:b+='maxlength="256"';break;case a.DynamicFormValueTypes.SHORT_TEXT:case a.DynamicFormValueTypes.PHONE:b+='maxlength="30"';break;case a.DynamicFormValueTypes.LONG_TEXT:b+='maxlength="255"'}return b},Object.defineProperty(b.prototype,"label",{get:function(){var b=this.isRequired(),c=this.attribute,d=c.label,e=c.link,f=c.valueType;if(!e||f!==a.DynamicFormValueTypes.CHECKBOX)return""+this.escapeHtml(d)+(b?" *":"");var g=e.url&&e.text?'<a data-hook="dynamic-form-attribute-label-link" class="label-link" href="'+this.escapeHtml(e.url)+'" target="_blank">'+this.escapeHtml(e.text)+"</a>":"",h=g?['<span class="label-text">'+this.escapeHtml(d),g]:['<span class="label-text">'+this.escapeHtml(d)];return[h.join(" "),b?"*</span>":"</span>"].filter(Boolean).join(" ")},enumerable:!0,configurable:!0}),b.prototype.updateNumberOfParticipantValue=function(){this.isNumberOfParticipantAttribute()&&1===this.attribute.userConstraints.max&&(this.attribute.value=1,this.onAttributeChanged({attribute:this.attribute}))},b.prototype.isDropDown=function(){return this.isNumberOfParticipantAttribute()||this.attribute.valueType===a.DynamicFormValueTypes.DROP_DOWN},b.prototype.isCheckbox=function(){return this.attribute.valueType===a.DynamicFormValueTypes.CHECKBOX},b.prototype.onFocusChanged=function(a){this.isInFocus=a},b.prototype.isInvalidIndicationShown=function(){return this.isInvalid()&&!this.isInFocus},b.prototype.isMobileContainer=function(){return!1},b.prototype.renderInput=function(a,b){var c=this.getInputNodeName(),d=this.getInputTypeByValueType(),e=this.getPlaceholder(),f=this.hasTextAreaAutoScale(),g=""+this.getInputConstrains(),h=this.getEnrichInputConstraints(),i=this.dynamicFormSrv.fieldTypeToAutofill(this.attribute.fieldType);return"<"+c+' data-hook="dynamic-form-attribute-input"\n                        '+h+'\n                        id="'+a+'"\n                        ng-model="$ctrl.attribute.value"\n                        ng-change="$ctrl.onAttributeValueChanged()"\n                        ng-focus="$ctrl.onFocusChanged(true)"\n                        ng-blur="$ctrl.onFocusChanged(false)"\n                        class="dynamic-form-attribute__input input"\n                        name="'+a+'"\n                        type="'+d+'"\n                        '+(b?"disabled":"")+'\n                        ng-required="$ctrl.ngRequired()"\n                        '+g+'\n                        placeholder="'+e+'"\n                        '+(f?'auto-scale-text-area rows="1"':"")+"\n                        "+(i?'autocomplete="'+i+'"':"")+'\n                        tabindex="0"/>'},b.prototype.getIsCheckboxDisabled=function(){return this.attribute.isReadOnly?"disabled":""},b.prototype.getEnrichInputConstraints=function(){return this.shouldEnrichPhoneInput&&this.attribute.valueType===a.DynamicFormValueTypes.PHONE?'ng-intl-tel-input data-initial-country="'+this.businessInfo.countryCode+'"':""},b.prototype.renderCheckbox=function(){var a=this.attribute.id,b=!this.isUoUCTAEnabled&&this.isRequired()?"required":"";return'\n      <label data-hook="dynamic-form-attribute-label" class="dynamic-form-attribute--checkbox-container">'+this.label+'\n        <input data-hook="dynamic-form-attribute-input"\n               id="'+a+'"\n               name="'+a+'"\n               type="checkbox"\n               ng-click="$ctrl.onAttributeValueChanged()"\n               ng-model="$ctrl.attribute.value"\n               ng-true-value="\'true\'"\n               ng-false-value="\'false\'"\n               '+(this.isUoUCTAEnabled?'ng-required="$ctrl.ngRequired()"':"")+"\n               "+[b,this.getInputConstrains()].join(" ")+" \n               "+this.getIsCheckboxDisabled()+"\n               "+("true"===this.attribute.value?'checked="checked"':"")+' \n        />\n        <span data-hook="dynamic-form-attribute-checkbox" class="checkbox" '+(this.isUoUCTAEnabled?"ng-class=\"{'invalid': $ctrl.isDirty() && $ctrl.isRequired()}\"":"")+"></span>\n      </label>"},b.prototype.getContactInfoClass=function(){return this.isAttributeWithSubElements()?"contact-info-input":""},b.prototype.renderField=function(){return this.isDropDown()?this.renderDropDown():this.isCheckbox()?this.renderCheckbox():this.renderInput(this.attribute.id,this.attribute.isReadOnly)},b.prototype.getErrorMessage=function(){var a=this.attribute.id,b=this.formController[a].$error;return b.ngIntlTelInput&&!this.isRequired()?{invalidPhone:!0}:b},b.prototype.$onInit=function(){var a=this.attribute.id,b=this.attribute.isReadOnly,c=this.getSubComponentToRender(),d=this.mapCamelCaseToDashed(),e=this.shouldRenderTemplate(),f=this.getContactInfoClass(),g='<div data-hook="dynamic-form-attribute-input-container"\n              class="dynamic-form-attribute--container dynamic-form-attribute--container__'+this.attribute.displayType+'">\n            <div data-hook="dynamic-form-attribute-'+this.attribute.fieldType+"\" \n                 ng-class=\"{'checkbox-container': $ctrl.isCheckbox(), 'dynamic-form-attribute__invalid': $ctrl.isInvalidIndicationShown() }\" \n                 class=\"dynamic-form-attribute dynamic-form-attribute__"+d+" "+f+'">\n            <label ng-if="'+(e&&this.shouldRenderLabel())+'"\n                   data-hook="dynamic-form-attribute-label"\n                   for="'+a+'"\n                   ng-class="{\'checkbox-label\': $ctrl.isCheckbox() }"\n                   class="label">'+this.label+'\n            </label>\n            <div ng-if="'+e+'" \n                  class="dynamic-form-attribute__input-container">\n               '+this.renderField()+'\n               <div ng-if="'+b+'"\n                    data-hook="dynamic-form-attribute-lock"\n                    ng-class="{\'checkbox-lock\': $ctrl.isCheckbox() }"\n                    class="dynamic-form-attribute__disabled-indication scheduler-svg-font-icons-lock">\n               </div>\n             </div>\n            </div>\n            <div ng-if="$ctrl.isInvalidIndicationShown()" ng-messages="$ctrl.getErrorMessage()" role="alert"\n                 class="dynamic-form-attribute__validation-message"\n                 ng-class="{\'checkbox-validation-message\': $ctrl.isCheckbox() }"\n                 data-hook="dynamic-form-attribute-validation-message">\n                 <span ng-message="ngIntlTelInput">{{\'visitor.contact-info.form.validation.tel\' | translate}}</span>\n                 <span ng-message="invalidPhone">{{\'visitor.contact-info.form.validation.not-required-tel\' | translate}}</span>\n                 <span ng-message="required">{{\'visitor.contact-info.form.validation.required\' | translate}}</span>\n                 <span ng-message="email">{{\'visitor.contact-info.form.validation.email\' | translate}}</span>\n            </div>\n           </div>\n          <'+c+'\n             ng-repeat="subField in $ctrl.attribute.subFields"\n             data-hook="dynamic-dynamic-form-attribute-sub-field"\n             class="contact-info-form__field contact-info-form__field__{{subField.displayType}}"\n             business-info="$ctrl.businessInfo"\n             attribute="subField"/>',h=angular.element(g);this.$element.append(h),this.$compile(h)(this.$scope),this.updateNumberOfParticipantValue()},b}();a.DynamicFormAttributeComponent=b,angular.module("bookingsDynamicForm").component("bksDynamicFormAttribute",{template:"",controller:b,require:{formController:"^form"},bindings:{attribute:"=",onAttributeChanged:"&",businessInfo:"<"}})}(b=a.form||(a.form={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){Object.assign(this,a)}return a}();a.BusinessInfo=b}(b=a.domain||(a.domain={}))}(b=a.common||(a.common={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.BUSINESS="business",a.CLIENT="client"}(b=a.DefaultTimezoneOptions||(a.DefaultTimezoneOptions={})),a.DEFAULT_TIMEZONE_PROPERTIES={clientCanChooseTimezone:!0,defaultTimezone:b.BUSINESS}}(b=a.domain||(a.domain={}))}(b=a.common||(a.common={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.staffList=[]}return a.prototype.withStaffList=function(a){return this.staffList=a,this},a.prototype.build=function(){return{staff:this.staffList}},a}();a.StaffMemberListDtoBuilder=b;var c=function(){function a(){this.staffMember={id:"staffMember-id",fullName:"staffMember name"}}return a.prototype.withName=function(a){return this.staffMember.fullName=a,this},a.prototype.withId=function(a){return this.staffMember.id=a,this},a.prototype.build=function(){return this.staffMember},a}();a.StaffMemberDtoBuilder=c}(b=a.staff||(a.staff={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.createBookingResponseDto={bookingId:null,bookingStatus:null,orderId:null,bookingsData:(new c).build()}}return a.prototype.withBookingId=function(a){return this.createBookingResponseDto.bookingId=a,this},a.prototype.withStatus=function(a){return this.createBookingResponseDto.bookingStatus=a,this},a.prototype.withExternalOrderId=function(a){return this.createBookingResponseDto.orderId=a,this},a.prototype.withBookingsData=function(a){return this.createBookingResponseDto.bookingsData=a,this},a.prototype.build=function(){return this.createBookingResponseDto},a}();a.CreateBookingResponseBuilder=b;var c=function(){function a(){this.createBookingsDataResponseDto={locationInfo:"location",payment:{priceText:"priceText",type:"customPayment"}}}return a.prototype.withLocationInfo=function(a){return this.createBookingsDataResponseDto.locationInfo=a,this},a.prototype.withPayment=function(a){return this.createBookingsDataResponseDto.payment=a,this},a.prototype.withVideoConferenceLink=function(a){return this.createBookingsDataResponseDto.videoConferenceLink=a,this},a.prototype.build=function(){return this.createBookingsDataResponseDto},a}();a.CreateBookingsDataResponseBuilder=c}(b=a.domain||(a.domain={}))}(b=a.offering||(a.offering={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.category={name:"",order:0,id:"category-id"}}return a.prototype.withCategoryId=function(a){return this.category.id=a,this},a.prototype.withName=function(a){return this.category.name=a,this},a.prototype.withOrder=function(a){return this.category.order=a,this},a.prototype.build=function(){return this.category},a}();a.OfferingCategoryDtoBuilder=b}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.boost.visitor.constants.DateDefaultsConst,d=WixBookingsUoUDomain.OfferedAsType,e=function(){function a(){this.idGenerator=function(){return"offering-id-"+Math.random()},this.offering=this.validOfferingDto()}return a.prototype.validWeekHours=function(){return{sun:null,mon:{workingHours:[{id:this.idGenerator(),workingHour:{startTime:"12:00",endTime:"13:00"},staffId:null}]},tue:{workingHours:[{id:this.idGenerator(),workingHour:{startTime:"14:00",endTime:"15:00"},staffId:null},{id:this.idGenerator(),workingHour:{startTime:"16:00",endTime:"18:30"},staffId:null}]}}},a.prototype.validOfferingDto=function(){var a=(new c).DATE_FORMAT,b=moment();return{id:this.idGenerator(),categoryId:this.idGenerator(),order:0,type:this.getOfferingType(),urlName:"offering-id-0",offeredAs:[],info:{name:"Offering Name",description:"This is some description blah blah blah",images:null},location:{type:"BUSINESS",locationText:"Location"},payment:{currency:"USD",price:10,isFree:!1,priceText:"",minCharge:9,paymentType:"OFFLINE"},schedulePolicy:{maxParticipantsPerOrder:1,capacity:1,uouHidden:!1,displayOnlyNoBookFlow:!1,futureBookingsPolicy:{shouldLimit:!1,limitXMinutesToTheFuture:50},bookUpToXMinutesBefore:0,isPendingApprovalFlow:!1,isCourseFull:!1},schedule:{scheduleIds:["123"],startDate:b.clone().add(20,"days").format(a),endDate:b.clone().add(100,"days").format(a)},pricingPlanInfo:{displayText:null,pricingPlans:[]}}},a.prototype.withStartDate=function(a){return this.offering.schedule.startDate=a.clone().format((new c).DATE_FORMAT),this},a.prototype.withEndDate=function(a){return this.offering.schedule.endDate=a.clone().format((new c).DATE_FORMAT),this},a.prototype.withExpired=function(){var a=moment();return this.withStartDate(a.clone().add(-20,"days")).withEndDate(a.clone().add(-10,"days"))},a.prototype.withId=function(a){return this.offering.id=a,this},a.prototype.withDummyIndication=function(){return this.offering.dummy=!0,this},a.prototype.withUrlName=function(a){return this.offering.urlName=a,this},a.prototype.withIdGenerator=function(a){return this.idGenerator=a,this},a.prototype.withCategoryId=function(a){return this.offering.categoryId=a,this},a.prototype.withLocation=function(a){return this.offering.location.type=a.type,this.offering.location.locationText=a.text,this},a.prototype.withName=function(a){return this.offering.info.name=a,this},a.prototype.withPaymentType=function(a){return this.offering.payment.paymentType=a,this},a.prototype.withDescription=function(a){return this.offering.info.description=a,this},a.prototype.withCapacity=function(a){return this.offering.schedulePolicy.capacity=a,this},a.prototype.withFutureBookingsPolicy=function(a){return this.offering.schedulePolicy.futureBookingsPolicy=a,this},a.prototype.withBookUpToXMinutesBefore=function(a){return this.offering.schedulePolicy.bookUpToXMinutesBefore=a,this},a.prototype.withPendingApproval=function(a){return this.offering.schedulePolicy.isPendingApprovalFlow=a,this},a.prototype.withNameSuffix=function(a){return this.offering.info.name+=a,this},a.prototype.withImages=function(a){return this.offering.info.images=a,this},a.prototype.withOrder=function(a){return this.offering.order=a,this},a.prototype.withConferenceProvider=function(a){return this.offering.conferenceProvider=a,this},a.prototype.withPrice=function(a){var b=a.price,c=void 0===b?1.99:b,d=a.priceText,e=void 0===d?"":d,f=a.currency,g=void 0===f?"USD":f,h=a.isFree,i=void 0===h?!1:h,j=a.minCharge,k=void 0===j?0:j;return this.offering.payment.currency=g,this.offering.payment.priceText=e,this.offering.payment.isFree=i,this.offering.payment.price=c,this.offering.payment.minCharge=k,this},a.prototype.withHidden=function(a){return this.offering.schedulePolicy.uouHidden=a,this},a.prototype.withMaxParticipants=function(a){return this.offering.schedulePolicy.maxParticipantsPerOrder=a,this},a.prototype.asDisplayOnly=function(){return this.offering.schedulePolicy.displayOnlyNoBookFlow=!0,this.offering.payment.paymentType=b.PaymentType.OFFLINE,this},a.prototype.build=function(){return 0===this.offering.offeredAs.length&&this.offering.offeredAs.push(d.ONE_TIME),this.offering},a}();b.BaseOfferingDtoBuilder=e}(c=b.offerings||(b.offerings={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=WixBookingsUoUDomain.OfferedAsType,c=WixBookingsUoUDomain.OfferingType,d=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}return __extends(d,a),d.prototype.getOfferingType=function(){return c.INDIVIDUAL},d.prototype.withDuration=function(a){return this.offering.schedule.durationInMinutes=a,this},d.prototype.validOfferingDto=function(){var b=a.prototype.validOfferingDto.call(this);return __assign({},b,{schedule:__assign({},b.schedule,{durationInMinutes:10,isDurationVaries:!1}),schedulePolicy:__assign({},b.schedulePolicy,{staffMembersIds:[]}),pricingPlanInfo:{displayText:null,pricingPlans:[]}})},d.prototype.addOfferedAsPricingPlan=function(){-1===this.offering.offeredAs.indexOf(b.PRICING_PLAN)&&this.offering.offeredAs.push(b.PRICING_PLAN)},d.prototype.withPricePlan=function(a){var b=a.name,c=void 0===b?"pricing plan name":b,d=a.id,e=void 0===d?"1":d;return this.addOfferedAsPricingPlan(),this.offering.pricingPlanInfo={displayText:""+c,pricingPlans:[{id:e,name:c}]},this},d.prototype.withPricePlans=function(a){var b=a.displayText,c=void 0===b?"pricing plan displayText":b,d=a.pricingPlans,e=void 0===d?[{name:"pricing plan name",id:"1"}]:d;return this.addOfferedAsPricingPlan(),this.offering.pricingPlanInfo={displayText:c,pricingPlans:e},this},d.prototype.withOfferedAs=function(a){return-1===this.offering.offeredAs.indexOf(a)&&this.offering.offeredAs.push(a),this},d.prototype.withOfferedAsOnly=function(a){return this.offering.offeredAs=[a],this},d.prototype.withStaffMembers=function(a){return this.offering.schedulePolicy.staffMembersIds=a.map(function(a){return a.id}),this},d.prototype.withUpfrontPayment=function(a){return this.offering.payment.minCharge=a,this},d.prototype.build=function(){return a.prototype.build.call(this)},d}(a.BaseOfferingDtoBuilder);a.IndividualOfferingDtoBuilder=d}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])
}return a},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=WixBookingsUoUDomain.OfferedAsType,c=WixBookingsUoUDomain.OfferingType,d=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}return __extends(d,a),d.prototype.getOfferingType=function(){return c.GROUP},d.prototype.validOfferingDto=function(){var b=a.prototype.validOfferingDto.call(this);return __assign({},b,{schedule:__assign({},b.schedule,{classHours:this.validWeekHours(),durationInMinutes:10,isDurationVaries:!1}),pricingPlanInfo:{displayText:null,pricingPlans:[]}})},d.prototype.withDuration=function(a){return this.offering.schedule.durationInMinutes=a,this},d.prototype.withOfferedAs=function(a){return this.offering.offeredAs=[a],this},d.prototype.withPricePlan=function(a){var c=a.name,d=void 0===c?"pricing plan name":c,e=a.id,f=void 0===e?"1":e;return this.offering.offeredAs=[b.PRICING_PLAN],this.offering.pricingPlanInfo={displayText:"in pp: "+d,pricingPlans:[{id:f,name:d}]},this},d.prototype.withStaffMembers=function(a){var b=this.offering,c=Object.keys(b.schedule.classHours),d=0;return c.map(function(a){return b.schedule.classHours[a]}).forEach(function(b){return b&&b.workingHours&&b.workingHours.forEach(function(b){return b.staffId=a[d++%a.length].id})}),this},d.prototype.withMaxParticipants=function(a){return this.offering.schedulePolicy.maxParticipantsPerOrder=a,this},d.prototype.build=function(){return a.prototype.build.call(this)},d}(a.BaseOfferingDtoBuilder);a.GroupOfferingDtoBuilder=d}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.boost.visitor.constants.DateDefaultsConst,d=WixBookingsUoUDomain.OfferingType,e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getOfferingType=function(){return d.COURSE},b.prototype.withRepeatEveryXWeeks=function(a){return this.offering.schedule.repeatEveryXWeeks=a,this},b.prototype.validOfferingDto=function(){var b=a.prototype.validOfferingDto.call(this);return __assign({},b,{schedule:__assign({},b.schedule,{classHours:this.validWeekHours(),repeatEveryXWeeks:1})})},b.prototype.withStaffMembers=function(a){var b=this.offering,c=Object.keys(b.schedule.classHours),d=0;return c.map(function(a){return b.schedule.classHours[a]}).forEach(function(b){return b&&b.workingHours&&b.workingHours.forEach(function(b){return b.staffId=a[d++%a.length].id})}),this},b.prototype.build=function(){return a.prototype.build.call(this)},b}(b.BaseOfferingDtoBuilder);b.CourseOfferingDtoBuilder=e;var f=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.withTotalNumberOfSessions=function(a){return this.offering.schedule.totalNumberOfSessions=a,this},b.prototype.withStartTime=function(a){return this.offering.schedule.startTime=a.clone().format((new c).TIME_FORMAT),this},b.prototype.withEndDate=function(a){return this.offering.schedule.endDate=a.clone().format((new c).DATE_FORMAT),this},b.prototype.validOfferingDto=function(){var b=a.prototype.validOfferingDto.call(this);return __assign({},b,{schedule:__assign({},b.schedule,{totalNumberOfSessions:12,startTime:moment().format((new c).TIME_FORMAT)})})},b.prototype.withSessions=function(a,b){return this.offering.schedule.sessions=a,this.offering.schedule.exceptionSessions=b,this},b.prototype.build=function(){return a.prototype.build.call(this)},b}(e);b.CourseOfferingDetailsDtoBuilder=f}(c=b.offerings||(b.offerings={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c,d=WixBookingsUoUDomain.OfferedAsType,e=WixBookingsUoUDomain.OfferingType;!function(a){a.ONLINE="ONLINE",a.OFFLINE="OFFLINE",a.TENTATIVE="TENTATIVE",a.ALL="ALL"}(c=b.PaymentType||(b.PaymentType={}));var f=function(){function a(){}return a}();b.LegacyOfferingDto=f;var g=function(b){function f(a){var c=b.call(this)||this;return Object.assign(c,a),c.initOfferedAs(),c}return __extends(f,b),f.fromOfferingDomain=function(a,b,c){if(void 0===c&&(c=!0),!a)return null;a.isCourseFull=a.isCourseFull||!c;var d=b.staff.reduce(function(a,b){return a.set(b.id,b.fullName),a},new Map),e=a.staffMemberIds.map(function(a){return d.get(a)});return new f(__assign({},a.toLegacyService(),{staffMemberNames:e}))},f.fromDto=function(a){return a?new f(a):null},f.prototype.initOfferedAs=function(){this.offeredAs&&this.offeredAs.indexOf(d.ONE_TIME)>=0&&this.offeredAs.indexOf(d.PRICING_PLAN)>=0&&(0===this.pricingPlanInfo.pricingPlans.length?this.offeredAs=[d.ONE_TIME]:this.isPricingPlanInstalled||(this.offeredAs=[d.ONE_TIME]))},f.prototype.isMultiParticipantsOffering=function(){return f.MULTI_PARTICIPANTS_OFFERINGS.indexOf(this.type)>-1},f.prototype.isCustomerLocationAllowed=function(){return f.CUSTOMER_LOCATION_ALLOWED.indexOf(this.type)>-1},f.prototype.isLocationPerInstance=function(){return f.LOCATION_PER_INSTANCE_OFFERINGS.indexOf(this.type)>-1},f.prototype.isMultipleSessionOffering=function(){return f.MULTI_INSTANCES_REGISTRATION_OFFERINGS.indexOf(this.type)>-1},f.prototype.isCalendarNeeded=function(){return f.CALENDAR_REQUIRED.indexOf(this.type)>-1},f.prototype.isSingleDayOffering=function(){return this.startDate===this.endDate},f.prototype.isPricingPlanOffering=function(){return this.offeredAs&&this.offeredAs.indexOf(d.PRICING_PLAN)>-1},f.prototype.isOnlineMeetingConnected=function(){return!(!this.conferenceProvider||!this.conferenceProvider.providerId)},f.prototype.isBothSingleSessionAndPricingPlanOffering=function(){return this.offeredAs.indexOf(d.ONE_TIME)>=0&&this.offeredAs.indexOf(d.PRICING_PLAN)>=0},f.prototype.getDefaultTimeSlot=function(){var b=new a.boost.visitor.constants.DateDefaultsConst;return this.sessions&&this.sessions.length?{startTime:moment(this.sessions[0].start,b.DATE_TIME_FORMAT).valueOf(),endTime:moment(this.sessions[0].start,b.DATE_TIME_FORMAT).valueOf()}:{startTime:moment(this.startDate+"T"+this.startTime,b.DATE_TIME_FORMAT).valueOf(),endTime:moment(this.startDate+"T"+this.startTime,b.DATE_TIME_FORMAT).valueOf()}},f.prototype.getOfferedAs=function(){return this.offeredAs},Object.defineProperty(f.prototype,"pricingPlans",{get:function(){return this.pricingPlanInfo.pricingPlans},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"isPossibleToBook",{get:function(){return!this.displayOnlyNoBookFlow},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"isOnlinePayment",{get:function(){return this.paymentType===c.ONLINE||this.paymentType===c.ALL},enumerable:!0,configurable:!0}),f.MULTI_PARTICIPANTS_OFFERINGS=[e.GROUP,e.TOUR,e.COURSE],f.LOCATION_PER_INSTANCE_OFFERINGS=[e.GROUP],f.MULTI_INSTANCES_REGISTRATION_OFFERINGS=[e.TOUR,e.COURSE],f.CUSTOMER_LOCATION_ALLOWED=[e.INDIVIDUAL],f.CALENDAR_REQUIRED=[e.INDIVIDUAL,e.GROUP],f}(f);b.SelectedOfferingDomain=g}(c=b.offerings||(b.offerings={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){function b(a,b){void 0===b&&(b=""),(b?a.find(b):a).focus()}function c(a,b,c){void 0===c&&(c=""),e(l,a,b,c)}function d(a,b,c){void 0===c&&(c=""),e(m,a,b,c)}function e(a,b,c,d){void 0===d&&(d=""),a.has(b)&&a.get(b)(c,d)}a.focusOn=b;var f=function(a,c){return b(a.next(),c)},g=function(a,c){return b(a.prev(),c)},h=40,i=38,j=37,k=39,l=new Map;l.set(h,f),l.set(i,g);var m=new Map;m.set(k,f),m.set(j,g),a.navigateWithVerticalArrowWhileOnElement=c,a.navigateWithHorizontalArrowWhileOnElement=d}(b=a.accessibility||(a.accessibility={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){function b(a,b){var d=c(a,b);window.Raven?window.Raven.captureException(d):console.error("No tracking tool - using console error: ",d)}function c(a,b){return new d(b?b instanceof Error?a+"\n cause: "+b.message:a+"\n details:"+JSON.stringify(b):a)}var d=function(){function a(a){this.message="Booking Monitor Tracking: "+a}return a}();a.BookingTracking=d,d.prototype=new Error,a.trackMessage=b}(b=a.monitoring||(a.monitoring={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var __assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};angular.module("environment",["wix"]),angular.module("schedulerAngularClientAppInternal",["schedulerAngularClientTranslations","ngIntlTelInput","schedulerAngularClientAppConstants","schedulerGroupAppInternal","schedulerOfferingsAppInternal","schedulerClientCommon","wix","schedulerTemplatesInternal","schedulerAngularClientCommon","bookingsDynamicForm","schedulerBiLogger","ngRoute","fedops","wixAngularLazyLoad","modalOpenner","environment","schedulerTracking","wix.ab-translate"]).config(["fedopsLoggerProvider","$compileProvider","$qProvider","$locationProvider","$translateProvider","abTranslateProvider","experimentManagerProvider","ngIntlTelInputProvider",function(a,b,c,d,e,f,g,h){h.set({initialCountry:"us"}),a.setAppName(window.__APP_NAME__||"appName"),d.hashPrefix(""),c.errorOnUnhandledRejections(!1),b.preAssignBindingsEnabled(!0);var i=e.preferredLanguage(),j=e.translations()[i],k=f.abTranslate.default(g.experiments,j);e.translations(i,k)}]).run(["$rootScope","experimentsEnabler","navigationMonitoring",function(a,b){a.experimentsEnabler=b}]),angular.module("schedulerTemplatesInternal",[]),angular.module("schedulerAngularClientAppConstants",[]),angular.module("schedulerGroupAppInternal",[]),angular.module("schedulerOfferingsAppInternal",[]);try{angular.module("schedulerAngularClientTranslations")}catch(e){angular.module("schedulerAngularClientTranslations",["pascalprecht.translate"])}angular.module("schedulerAngularClientCommon",["wixSdkUtilInternal","schedulerCommonStatics","schedulerCommonScrollbar"]),angular.module("wixSdkUtilInternal",["wix","schedulerAngularClientTranslations"]),angular.module("schedulerAngularClientBootstrap",["schedulerAngularClientAppInternal","ui.bootstrap"]).config(["$tooltipProvider",function(a){a.setTriggers({mouseenter:"mouseleave","staff-member-selection.open":"staff-member-selection.close","timezone-switch-popover.open":"timezone-switch-popover.close"})}]),angular.module("schedulerBiLogger",["wix.common.bi"]).config(["wixBiLoggerProvider","appEventMap",function(a,b){var c=function(a){try{return a()}catch(b){return""}},d=function(){var a=Wix.Utils.getInstanceValue("uid");return null===a?Wix.Utils.getInstanceValue("aid"):a},e=function(){try{return"OWNER"===Wix.Utils.getPermissions()}catch(a){return""}},f=window.iframeAppBiContext.getBiContext(Wix);a.setConfig({eventMap:b,defaultEventArgs:__assign({visitor_id:c(d),src:16,businessId:c(Wix.Utils.getInstanceId),is_owner:e(),biToken:c(function(){return Wix.Utils.getInstanceValue("biToken")}),contactId:c(Wix.Utils.getUid)},f),adapter:"wixboost-ugc"})}]).run(["$window","$q",function(a,b){a.Promise=b}]);var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},_this=this,EntryPointNavigation=wix.boost.visitor.EntryPointNavigation;angular.module("schedulerAngularClientAppInternal").run(["entryPointNavigationSrv","clientPages","flowManagerSrv",function(a,b,c){return __awaiter(_this,void 0,void 0,function(){return __generator(this,function(b){switch(b.label){case 0:return c.init(),a.registerNavigationServices(),[4,a.redirect()];case 1:return b.sent(),[2]}})})}]);var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.$window=a}return a.$inject=["$window"],a.prototype.getHistoryLength=function(){return this.$window.history.length},a.prototype.isHistoryEmpty=function(){return 1===this.getHistoryLength()},a}();a.HistoryAdapter=b,angular.module("schedulerAngularClientAppInternal").service("historyAdapter",b)}(b=a.services||(a.services={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.API_PREFIX="_api/bookings-viewer/",a.CALCULATE_PRICE_API=a.API_PREFIX+"calculatePrice",a.HAS_COUPONS_API=a.API_PREFIX+"hasCoupons",a}();a.CouponsApiConstFES=b;var c;!function(a){a.ERROR_COUPON_HAS_EXPIRED="ERROR_COUPON_HAS_EXPIRED",a.ERROR_COUPON_USAGE_EXCEEDED="ERROR_COUPON_USAGE_EXCEEDED",a.ERROR_COUPON_SERVICE_UNAVAILABLE="ERROR_COUPON_SERVICE_UNAVAILABLE",a.ERROR_COUPON_DOES_NOT_EXIST="ERROR_COUPON_DOES_NOT_EXIST"}(c=a.CouponsErrorType||(a.CouponsErrorType={}));var d=function(){function a(a,c){var d=this;this.$http=a,this.commonApiBase=c,this.calculateNewPrice=this.commonApiBase.httpWrapper(function(a){var c=a.codeCoupon,e=a.currency,f=a.offeringId,g=a.price,h=a.numberOfParticipants,i=a.startTime,j=b.CALCULATE_PRICE_API;return d.$http.post(j,{couponCode:c,currency:e,slotStartTime:i,items:[{serviceId:f,price:g,numberOfParticipants:h}]})}),this.hasCoupons=this.commonApiBase.httpWrapper(function(){var a=b.HAS_COUPONS_API;return d.$http.get(a)})}return a.$inject=["$http","commonApiBase"],a}();a.CouponsApi=d,angular.module("schedulerAngularClientAppInternal").service("couponsApi",d)}(b=a.booking||(a.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var __assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(b){var c;!function(b){b.COUPONS_EVENTS={COUPON_UPDATED:"Sidebar.COUPON_UPDATED"};var c=function(){function c(b,c,d,e){var f=this;this.couponsApi=b,this.appointmentService=c,this.$rootScope=d,this.experimentsEnabler=e;var g=d.$on(a.boost.visitor.VisitorSidebar.EVENTS.SERVICE_UPDATED,function(){return f.isCouponApplied()&&f.applyCoupon()});d.$on("$destroy",function(){g()})}return c.$inject=["couponsApi","appointmentService","$rootScope","experimentsEnabler"],c.prototype.setCouponCode=function(a){this.couponCode=a},c.prototype.getCouponCode=function(){return this.couponCode},c.prototype.clearCouponCode=function(){this.couponCode=void 0},c.prototype.clearAppliedCoupon=function(){this.appliedCoupon=void 0,this.$rootScope.$emit(b.COUPONS_EVENTS.COUPON_UPDATED)},c.prototype.clearLastAppliedCoupon=function(){this.clearCouponCode(),this.clearAppliedCoupon()},c.prototype.applyCoupon=function(){var a=this,c=this.appointmentService.getSelectedOffering(),d=c.price,e=c.id,f=c.currency,g=c.numberOfParticipants,h=this.appointmentService.getSelectedTime().startTime;return this.couponsApi.calculateNewPrice({codeCoupon:this.couponCode,currency:f,offeringId:e,price:d*g,numberOfParticipants:g,startTime:h}).then(function(c){return c.errors.length?(a.clearAppliedCoupon(),c):(a.appliedCoupon=__assign({},c),a.addDeposit(),a.$rootScope.$emit(b.COUPONS_EVENTS.COUPON_UPDATED),a.appliedCoupon)})},c.prototype.getAppliedCoupon=function(){return this.appliedCoupon},c.prototype.isCouponApplied=function(){return!!this.appliedCoupon},c.prototype.addDeposit=function(){var a=this.appointmentService.getSelectedOffering(),b=a.minCharge,c=a.numberOfParticipants,d=b*c;this.appliedCoupon.deposit=d<=this.appliedCoupon.priceAfterDiscount?d:this.appliedCoupon.priceAfterDiscount},c}();b.CouponsSrv=c,angular.module("schedulerAngularClientAppInternal").service("couponsSrv",c)}(c=b.booking||(b.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.$translate=a}return a.$inject=["$translate"],a.prototype.isTimeInBookingWindow=function(a){var b=a.startTime,c=a.shouldLimit,d=a.limitXMinutesToTheFuture;return!c||moment().add(d,"minutes").isAfter(b)},a.prototype.isPassBookingWindow=function(a){var b=a.startTime,c=a.bookUpToXMinutesBefore;return 0!==c&&moment().add(c,"minutes").isAfter(b)},a.prototype.isTimeStampsInBookingWindow=function(a){var b=this,c=a.timeStamps,d=a.shouldLimit,e=a.limitXMinutesToTheFuture;return!d||!c.length||!c.find(function(a){return!b.isTimeInBookingWindow({shouldLimit:d,limitXMinutesToTheFuture:e,startTime:moment(+a)})})},a.prototype.splitDuration=function(a){var b=moment.duration(a,"minutes"),c=Math.floor(b.asDays()),d=b.hours(),e=b.minutes(),f=[];return c&&f.push(c+" "+this.$translate(1===c?"visitor.calendar.day":"visitor.calendar.days")),d&&f.push(d+" "+this.$translate(1===d?"visitor.calendar.hour":"visitor.calendar.hours")),e&&f.push(e+" "+this.$translate(1===e?"visitor.calendar.minute":"visitor.calendar.minutes")),f.join(", ")},a}();a.FutureBookingSrv=b,angular.module("schedulerAngularClientAppInternal").service("futureBookingSrv",b)}(b=a.booking||(a.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a}();a.GeneralErrorMessage=b,angular.module("schedulerAngularClientAppInternal").component("bksGeneralErrorMessage",{template:'<div class="general-error-message__container" data-hook="general-error-message-container">\n                  <div class="general-error-message__title" data-hook="general-error-message-title">{{$ctrl.title}}</div>\n                  <div class="general-error-message__message" data-hook="general-error-message-message">{{$ctrl.message}}</div>\n                  <button class="general-error-message__action btn-primary"\n                    data-hook="general-error-message-action"\n                    ng-click="$ctrl.onClick()"\n                    role="button"\n                    type="button"\n                    tabindex="0">{{$ctrl.actionText}}</button>\n                </div>',controller:b,bindings:{title:"@",message:"@",actionText:"@",onClick:"&"}})}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(){var b=this,c=a.boost.common.general.Timezone,d=WixBookingsUoUDomain.OfferingType;angular.module("schedulerAngularClientAppSeverConfig",["schedulerAngularClientAppInternal"]),angular.module("schedulerAngularClientApp",["wixAngular","isoCurrency","ngRaven","ui.calendar","debounce","ngAria","react","schedulerAngularClientAppSeverConfig","schedulerAngularClientAppInternal"]).config(["$provide",function(a){a.decorator("$exceptionHandler",["$delegate","$window",function(a){return function(b,c){a(b,c)}}])}]).config(["$routeProvider","clientPages","experimentsEnablerProvider","experimentManagerProvider",function(a,e,f,g){g.setExperiments(bookingsExperiments);var h=e.PREFIX,i={template:'<bks-offering-list-page ng-if="!$resolve.isBookingsSplitted" offerings-list="$resolve.offeringList" page-url="{{$resolve.pageUrl}}">',resolve:{isBookingsSplitted:["$wix",function(a){return a.isBookingsSplitted().then(function(b){return b&&a.navigateToSection("bookings_list"),b})}],offeringList:["offeringsListGetterSrv",function(a){return a.gettingOfferingsList()}],styleParams:["wixSdkUtil",function(a){return a.getStyleParams()}],pageUrl:["siteUrlManagerSrv",function(a){return a.getUrl()}]}};a.when(h+e.VISITOR_SERVICES,i).when(h+e.VISITOR_CALENDAR+"/:timezone?",{template:'<boost-calendar-page business-timezone="$resolve.businessTimezone" user-timezone="$resolve.userTimezone"/>',reloadOnSearch:!0,resolve:{waitForVisibility:["waitForBookingsVisibilitySrv",function(a){return a.waitForBookingsVisibility()}],lazyLoader:["lazyLoaderSrv","$q","experimentsEnabler","$ocLazyLoad",function(a,b,c,d){return a.lazyLoadLibs(["bootstrap","bookingFlow"]).then(function(){return d.inject("schedulerAngularClientBootstrap")})}],capableStaff:["visitorStaffSrv",function(a){return a.getCapableStaffForCalendarSlots()}],staff:["visitorStaffSrv",function(a){return a.gettingStaffMembers()}],userTimezone:["timezoneSrv",function(a){return a.gettingUserTimezone()}],businessTimezone:["businessInfoSrv",function(a){return a.gettingBusinessInfo().then(function(a){return new c(a.timeZone,a.timeZoneStandardOffset,a.timeZoneOffset)})}],selectedOfferingEnforced:["appointmentService",function(a){a.enforceSelectedOfferingType(d.INDIVIDUAL)}],firstAvailableDate:["timezoneSrv","appointmentService","slotsSrv",function(a,b,c){return a.gettingUserTimezone().then(function(a){var d=b.getSelectedOffering();return c.getFirstAvailableSlotForIndividualService(d,a.name)})}],businessInfo:["businessInfoSrv",function(a){return a.gettingBusinessInfo()}]}}).when(h+e.VISITOR_CONTACT_INFO,{template:'<bks-contact-info-page has-coupons="$resolve.hasCoupons" business-info="$resolve.businessInfo"/>',resolve:{lazyLoader:["lazyLoaderSrv",function(a){return a.lazyLoadLibs(["bootstrap"])}],businessInfo:["businessInfoSrv",function(a){return a.gettingBusinessInfo()}],timezone:["appointmentService",function(a){var b=a.getSelectedTime();return b&&b.timeZone}],hasCoupons:["couponsApi",function(a){return a.hasCoupons().then(function(a){var b=a.hasCoupons;return b})}],staff:["visitorStaffSrv",function(a){return a.gettingStaffMembers()}],dynamicFormData:["contactInfoSrv",function(a){return a.gettingBookingsDynamicForm()}]},reloadOnSearch:!1}).when(h+e.VISITOR_PAYMENT,{template:'<bks-payment-page timezone="$resolve.timezone" staff="$resolve.staff" dynamic-form-data="$resolve.dynamicFormData"/>',resolve:{lazyLoader:["lazyLoaderSrv",function(a){return a.lazyLoadLibs(["react","cashier"])}],timezone:["appointmentService",function(a){return a.getSelectedTimezone()}],staff:["visitorStaffSrv",function(a){return a.gettingStaffMembers()}],dynamicFormData:["contactInfoSrv",function(a){return a.gettingBookingsDynamicForm()}]}}).when(h+e.VISITOR_CONGRATS,{template:'<bks-congratulations-page payment-data="$resolve.paymentData" booked-location="{{$resolve.bookedLocation}}" video-conference-link="{{$resolve.videoConferenceLink}}"/>',resolve:{bookConfirmationLog:["bookConfirmationSrv","experimentsEnabler",function(a,c){return __awaiter(b,void 0,void 0,function(){return __generator(this,function(){return[2,c.isLogAfterBookConfirmationEnabled()?a.logBookConfirmationResult():""]})})}],lazyLoader:["lazyLoaderSrv",function(a){return a.lazyLoadLibs(["react","offeringPage"])}],businessInfo:["businessInfoSrv",function(a){return a.gettingBusinessInfo()}],staff:["visitorStaffSrv",function(a){return a.gettingStaffMembers()}],paymentData:["bookingDataSrv",function(a){return a.getBookedPayment()}],videoConferenceLink:["bookingDataSrv",function(a){return a.getBookedVideoConferenceLink()}],bookedLocation:["bookingDataSrv",function(a){return __awaiter(b,void 0,void 0,function(){return __generator(this,function(){return[2,a.getBookedLocation()]})})}]}}).when(h+e.VISITOR_GROUPS_CALENDAR+"/:timezone?",{template:'<boost-groups-calendar business-timezone="$resolve.businessTimezone" user-timezone="$resolve.userTimezone"/>',reloadOnSearch:!1,resolve:{waitForVisibility:["waitForBookingsVisibilitySrv",function(a){return a.waitForBookingsVisibility()}],lazyLoader:["lazyLoaderSrv","$q","experimentsEnabler","$ocLazyLoad",function(a,b,c,d){return a.lazyLoadLibs(["bootstrap","bookingFlow"]).then(function(){return d.inject("schedulerAngularClientBootstrap")})}],businessInfo:["businessInfoSrv",function(a){return a.gettingBusinessInfo()}],selectedOfferingEnforced:["appointmentService",function(a){a.enforceSelectedOfferingType(d.GROUP)}],firstAvailableDate:["appointmentService","groupsSrv",function(a,b){var c=a.getSelectedOffering();return b.getFirstAvailableSlotForPrototype(c)}],staff:["visitorStaffSrv",function(a){return a.gettingStaffMembers()}],userTimezone:["timezoneSrv",function(a){return a.gettingUserTimezone()}],businessTimezone:["businessInfoSrv",function(a){return a.gettingBusinessInfo().then(function(a){return new c(a.timeZone,a.timeZoneStandardOffset,a.timeZoneOffset)})}]}}).when(h+e.VISITOR_GROUPS,i).when(h+e.USER_ACCOUNT_MANAGEMENT,{redirectTo:function(){return h+e.USER_ACCOUNT_MANAGEMENT+"/"+e.USER_ACCOUNT_MANAGEMENT_APPOINTMENTS}}).when(h+e.USER_ACCOUNT_MANAGEMENT+"/"+e.USER_ACCOUNT_MANAGEMENT_INFO,{template:"<bks-account-management-user-info/>"}).when(h+e.USER_ACCOUNT_MANAGEMENT+"/"+e.USER_ACCOUNT_MANAGEMENT_APPOINTMENTS,{template:'<bks-account-management-bookings booking-list="$resolve.bookingList" timezone="{{$resolve.timezone}}"/>',resolve:{timezone:["businessInfoSrv",function(a){return a.gettingBusinessInfo().then(function(a){return a.timeZone})}],bookingList:["bookingHistorySrv",function(a){return a.gettingBookings()}]}}).when(h+e.OFFERING_PAGE+"/:timezone?",{template:'<bks-offering-page\n            offering="$resolve.offering"\n            timezone-note="{{$resolve.timezoneNote}}"\n            business-info="$resolve.businessInfo"\n            business-timezone="$resolve.businessTimezone"\n            user-timezone="$resolve.userTimezone"/>',resolve:{lazyLoader:["lazyLoaderSrv",function(a){return a.lazyLoadLibs(["react","offeringPage"])}],offering:["offeringFinder",function(a){return a.selected()}],businessInfo:["businessInfoSrv",function(a){return a.gettingBusinessInfo()}],timezoneNote:["visitorTimezoneSrv",function(a){return a.gettingUserTimezoneNote("business")}],userTimezone:["timezoneSrv",function(a){return a.gettingUserTimezone()}],businessTimezone:["businessInfoSrv",function(a){return a.gettingBusinessInfo().then(function(a){return new c(a.timeZone,a.timeZoneStandardOffset,a.timeZoneOffset)})}]}}).when(h+e.EMPTY_PAGE,{template:""})}])}(c=b.desktop||(b.desktop={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));try{angular.module("schedulerAngularClientTranslations")}catch(e){angular.module("schedulerAngularClientTranslations",["pascalprecht.translate"])}try{angular.module("ngRaven")}catch(e){angular.module("ngRaven",[])}angular.module("schedulerAngularClientApp").config(["routeManagerProvider","clientPages",function(a,b){a.setPrefix(b.PREFIX)}]).run(["visitorBiListener",function(a){a.init()}]).run(["$$testability","$wix",function(a,b){b.Performance.applicationLoadingStep(20,"app-bootstrap-start"),a.whenStable(function(){b.Performance.applicationLoaded()})}]).run(["$route","$rootScope","eventsConst","$location","$routeParams","$window","wixSdkUtil","clientPages","routeManager","wixPageNavigation","userManagementSrv",function(a,b,c,d,e,f,g,h,i,j,k){var l=function(a){return a&&a.$$route.originalPath.indexOf(h.EMPTY_PAGE)>0},m=function(a,b){return l(a)||l(b)};i.suspendFocus=!0,i.routeRecurringErrorCount=0,b.$on("$locationChangeStart",function(a,b){k.isPathAllowed(b)||i.gotoPage("")}),b.$on("$routeChangeStart",function(){b.$emit("showLoading")}),b.$on("$routeChangeError",function(a,b,c,e){var f=b?b.originalPath:"",g=c?c.originalPath:"",h=f!==g&&i.routeRecurringErrorCount<3;throw h&&d.path(g),console.error("Route change failure: ",a,f,g,e),i.routeRecurringErrorCount++,new Error(e)}),j.init(),b.$on("$routeChangeSuccess",function(a,h,j){i.routeRecurringErrorCount=0,b.$emit("hideLoading"),b.$emit(c.CONTENT_CHANGED);var k=d.path()+"?";angular.forEach(e,function(a,b){k+=b+"="+a+"&"}),k=k.substr(0,k.length-1),f._gaq&&f._gaq.push(["_trackPageview",k]),j&&i.suspendFocus===!1&&g.resetHeight(),m(h,j)||(i.suspendFocus=!1)}),a.reload()}]);var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d){this.timezone=b,this.staffMember=c,this.groupInstance=d,this.time=moment.tz(+a,b)}return a.prototype.getStaff=function(){return this.staffMember},a.prototype.getTime=function(){return this.time},a.prototype.getPurchasedPricingPlan=function(){return this.purchasedPricingPlan},a.prototype.setPurchasedPricingPlan=function(a){this.purchasedPricingPlan=a},a.prototype.getTimeStamp=function(){return this.time.valueOf()},a}();a.TimeSlotOption=b}(b=a.calendar||(a.calendar={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.TILE_IMAGE_SHAPE=a,this.commonServices=b}return a.prototype.isSquareImage=function(){return this.tileConfig.imageType===this.TILE_IMAGE_SHAPE.SQUARE},a.prototype.isRoundImage=function(){return this.tileConfig.imageType===this.TILE_IMAGE_SHAPE.ROUND},a.prototype.isImageVisible=function(){return this.tileConfig.imageType!==this.TILE_IMAGE_SHAPE.NONE
},a.prototype.getImageUrl=function(a,b){return this.commonServices.getImageUrl(a,b)},a}();a.BaseTileController=b}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={})),function(){function a(a){a.$emit("we are using controllerAs syntax, scope is used only for events and watches"),this.awesomeThings=["Bower","Grunt","Haml","Compass","AngularJS","Karma"]}a.$inject=["$scope"],angular.module("schedulerAngularClientAppInternal").controller("MainController",a)}();var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=["ar","fa","he"],c=function(){function a(a,b,c){this.$translate=a,this.boostInjectionPersister=b,this.experimentsEnabler=c,this.regionalSettingsLocale=this.boostInjectionPersister.getRegionalSettingsLocale(),this.momentLocale=this.boostInjectionPersister.getMomentLocale(),this.isLocalizeFirstDayEnabled=this.experimentsEnabler.isLocalizeFirstDayEnabled()}return a.$inject=["$translate","boostInjectionPersister","experimentsEnabler"],a.prototype.getBookingsWeekdays=function(){return 0===this.getFirstDayOfWeek()?["sun","mon","tue","wed","thu","fri","sat"]:["mon","tue","wed","thu","fri","sat","sun"]},a.prototype.getFirstDayOfWeek=function(){return this.shouldUseRegionalSettingsLocale()?moment().locale(this.regionalSettingsLocale).localeData().firstDayOfWeek():moment.localeData().firstDayOfWeek()},a.prototype.getLastDayOfWeek=function(){return this.shouldUseRegionalSettingsLocale()?moment().locale(this.regionalSettingsLocale).localeData().firstDayOfWeek():moment.localeData().firstDayOfWeek()},a.prototype.getStartOfWeekForLocale=function(a){return this.shouldUseRegionalSettingsLocale()?a.clone().locale(this.regionalSettingsLocale).startOf("week").locale(this.momentLocale):a.clone().startOf("week")},a.prototype.getEndOfWeekForLocale=function(a){return this.shouldUseRegionalSettingsLocale()?a.clone().locale(this.regionalSettingsLocale).endOf("week").locale(this.momentLocale):a.clone().endOf("week")},a.prototype.isRTL=function(){return b.indexOf(moment.locale())>-1},a.prototype.getDaysOfWeekShortFormatMap=function(){var a=moment(),b=this.$translate("visitor.short-day-of-week-format");return new Array(7).fill(null).reduce(function(c,d,e){return c[e]=a.day(e).format(b),c},{})},a.prototype.shouldUseRegionalSettingsLocale=function(){return this.isLocalizeFirstDayEnabled&&this.momentLocale!==this.regionalSettingsLocale},a}();a.BookingsLocalizationSrv=c,angular.module("schedulerAngularClientAppInternal").service("bookingsLocalizationSrv",c)}(b=a.localization||(a.localization={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.RTL_CLASS="bookings-direction__rtl",a.LTR_CLASS="bookings-direction__ltr",angular.module("schedulerAngularClientAppInternal").directive("bksLocalizationClasses",["bookingsLocalizationSrv",function(b){return{restrict:"A",bindToController:!0,link:function(c,d){b.isRTL()?(d.addClass(a.RTL_CLASS),d.removeClass(a.LTR_CLASS)):(d.addClass(a.LTR_CLASS),d.removeClass(a.RTL_CLASS))}}}])}(b=a.localization||(a.localization={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c=function(){function a(){}return a.API_PREFIX="_api/bookings-viewer/",a.CREATING_BOOKING_API=a.API_PREFIX+"booking",a.BOOKING_DETAILS=a.API_PREFIX+"booking",a.BOOKING_API_PREFIX="_api/bookings-server/",a.BOOKING_AVAILABILITY=a.BOOKING_API_PREFIX+"v1/bookings/availability",a}();b.BookingApiConstFES=c;var d=function(){function b(b,d){var e=this;this.$http=b,this.commonApiBase=d,this.creatingBooking=this.commonApiBase.httpWrapper(function(a){return e.$http.post(""+e.CREATING_BOOKING_API,a)}),this.gettingBookingDetails=this.commonApiBase.httpWrapper(function(a){var b=a.bookingId,c=a.groupInstanceId;return e.$http.get(e.BOOKING_DETAILS+"/"+b+(c?"/"+c:""))}),this.isBookingAvailable=this.commonApiBase.httpWrapper(function(b){return b||a.visitor.monitoring.trackMessage("Booking id is null when calling get booking availability: ",{bookingId:b}),e.$http.get(e.BOOKING_AVAILABILITY+"?bookingId="+b)},"",""),Object.assign(this,c)}return b.$inject=["$http","commonApiBase"],b}();b.BookingApiSrv=d,angular.module("schedulerAngularClientAppInternal").service("bookingApiSrv",d)}(c=b.booking||(b.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){Object.assign(this,a)}return a}();a.Booking=b}(b=a.booking||(a.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a[a.RESCHEDULE=0]="RESCHEDULE",a[a.BOOK_NEW=1]="BOOK_NEW",a[a.UNKNOWN=2]="UNKNOWN"}(b=a.ValidateBookingType||(a.ValidateBookingType={}));var c;!function(a){a[a.ONLINE=0]="ONLINE",a[a.OFFLINE=1]="OFFLINE",a[a.NA=2]="NA"}(c=a.ValidationPaymentType||(a.ValidationPaymentType={}));var d;!function(a){a[a.VALID=0]="VALID",a[a.INVALID_UNKNOWN=1]="INVALID_UNKNOWN",a[a.INVALID_ONLINE=2]="INVALID_ONLINE",a[a.SESSION_EXPIRED=3]="SESSION_EXPIRED"}(d=a.ValidateBookingResult||(a.ValidateBookingResult={}));var e;!function(a){a[a.VALID=0]="VALID",a[a.VALIDATION_NOT_NEEDED=1]="VALIDATION_NOT_NEEDED",a[a.NOT_EXIST_IN_SERVER=2]="NOT_EXIST_IN_SERVER",a[a.NOT_EXIST_IN_CLIENT=3]="NOT_EXIST_IN_CLIENT",a[a.INVALID_OFFERING_ID=4]="INVALID_OFFERING_ID",a[a.INVALID_START_TIME=5]="INVALID_START_TIME",a[a.INVALID_NUM_OF_PARTICIPANTS=6]="INVALID_NUM_OF_PARTICIPANTS",a[a.INVALID_GROUP_INSTANCE_ID=7]="INVALID_GROUP_INSTANCE_ID",a[a.INVALID_BOOKING_ID=8]="INVALID_BOOKING_ID"}(e=a.ValidateBookingSubResult||(a.ValidateBookingSubResult={})),a.mapValidationResult2Status=function(a){return d[a]},a.mapValidationSubResult2SubCategory=function(a){return e[a]},a.mapValidateBookingType2Transaction=function(a){return b[a]};var f=function(){function a(a,b,c,d,e){this.bookingType=a,this.offeringType=b,this.bookingId=c,this.paymentType=d,this.groupInstanceId=e}return a.fromOther=function(b){var c=b.bookingType,d=b.offeringType,e=b.bookingId,f=b.paymentType,g=b.groupInstanceId;return new a(c,d,e,f,g)},a}();a.ValidateBookingInfo=f;var g=function(){function a(a){this.cacheSrv=a}return a.$inject=["cacheSrv"],a.prototype.setBookingInfoForValidation=function(b){this.cacheSrv.setToCache(a.BOOKING_VALIDATION_INFO_KEY,b)},a.prototype.getBookingInfoForValidation=function(){var b=this.cacheSrv.getFromCache(a.BOOKING_VALIDATION_INFO_KEY);return b?f.fromOther(b):null},a.BOOKING_VALIDATION_INFO_KEY="booking-validation-info",a}();a.ValidateBookingDataSrv=g,angular.module("schedulerAngularClientAppInternal").service("validateBookingDataSrv",g)}(b=a.booking||(a.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var __assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f){this.categorySrv=a,this.trackingSrv=b,this.navigationMonitoring=c,this.appointmentService=d,this.validateBookingDataSrv=e,this.$q=f}return a.$inject=["categorySrv","trackingSrv","navigationMonitoring","appointmentService","validateBookingDataSrv","$q"],a.prototype.logBookConfirmationResult=function(){this.navigationMonitoring.endInteraction();var a=this.appointmentService.getSelectedOffering(),b=this.validateBookingDataSrv.getBookingInfoForValidation(),c=b?b.bookingId:"unknown";if(a&&!a.dummy){var d=this.categorySrv.getCategoryNameById(a.categoryId);this.trackingSrv.trackBooking(__assign({bookingId:c},a,{categoryName:d}))}return this.$q.when({})},a}();a.BookConfirmationSrv=b,angular.module("schedulerAngularClientAppInternal").service("bookConfirmationSrv",b)}(b=a.booking||(a.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var __assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(b){var c;!function(b){function c(c,e,f,g,h,i){function j(a,b,c){var d;return b?d=b.isLocationPerInstance()?c&&c.groupInstance?c.groupInstance[a]:"":b[a]:""}var k=this,l=this;this.init=function(){l.fillContactInfoWithLoggedInUserDetails(),i.$on(a.bookings.user.UserManagementSrv.USER_INFO_CHANGED,function(){l.fillContactInfoWithLoggedInUserDetails()}),i.$on(a.bookings.user.UserManagementSrv.LOGOUT_INITIATED,function(){c.clearKey("contactInfo")}),i.$on(a.bookings.user.UserManagementSrv.MY_ACCOUNT_USER_INFO_CHANGED,function(){c.clearKey("contactInfo")})},this.initiate=function(a,e){if(e||(c.clearKey("bookingInfo"),c.clearKey("appointmentDateTime")),null===a)return c.clearKey(b.SELECTED_OFFERING_KEY);var f=d.fromDto(a);if(!f.isCalendarNeeded()){var g={fullName:a.staffMemberNames?a.staffMemberNames.join(", "):""},h=f.getDefaultTimeSlot(),i=h.startTime,j=h.endTime;this.setSelectedTime({groupInstance:{},staffMember:g,startTime:i,endTime:j})}return l.serviceWithZeroPricePaymentTypeOnlineWorkaround(a),this.setSelectedOffering(a)},this.clearBookingFlow=function(){k.clearPurchasedPricingPlan(),c.clearKey("videoConferenceLink")},this.setSelectedOffering=function(a){return c.setToCache(b.SELECTED_OFFERING_KEY,a)},this.enforceSelectedOfferingType=function(a){var d=c.getFromCache(b.SELECTED_OFFERING_KEY);d&&a!==d.type&&c.clearKey(b.SELECTED_OFFERING_KEY)},this.getSelectedOffering=function(){var a=c.getFromCache(b.SELECTED_OFFERING_KEY);return a=e.enrichOfferingIfOverEditor(a),a&&d.fromDto(a)},this.serviceWithZeroPricePaymentTypeOnlineWorkaround=function(a){0===a.price&&a.paymentType===f.PAYMENT_TYPE_ONLINE&&(a.paymentType=f.PAYMENT_TYPE_OFFLINE,a.isFree=!0)},this.fillContactInfoWithLoggedInUserDetails=function(){var a=h.getCurrentSiteMember(),b=this.getContactInfo()||{};if(!e.isOverEditor&&a.email){var c={email:a.email,name:a.fullName,phone:a.phoneNumber};this.setContactInfo(__assign({},b,c))}},this.setPaymentInfo=function(a){return c.setToCache("paymentInfo",a)},this.getPaymentInfo=function(){return c.getFromCache("paymentInfo")},this.isInTentativePayment=function(){var a=c.getFromCache("paymentInfo");return a.paymentType===f.PAYMENT_TYPE_TENTATIVE},this.setOrderId=function(a){return c.setToCache("orderId",a)},this.getOrderId=function(){return c.getFromCache("orderId")},this.setCurrentBooking=function(a){return c.setToCache("bookingInfo",a)},this.getCurrentBooking=function(){return c.getFromCache("bookingInfo")},this.getSelectedTime=function(){return e.enrichSelectedTimeIfOverEditor(c.getFromCache("appointmentDateTime"))},this.setSelectedTime=function(a){return c.setToCache("appointmentDateTime",a)},this.updateBookedAs=function(a){var b=this.getSelectedTime();return b.bookedAs=a,c.setToCache("appointmentDateTime",b)},this.getSelectedTimezone=function(){var a=this.getSelectedTime();return a&&a.timeZone},this.clearSelectedTime=function(){return c.clearKey("appointmentDateTime")},this.setLastSelectedTime=function(a){return c.setToCache("appointmentLastDateTime",a)},this.getLastSelectedTime=function(){return c.getFromCache("appointmentLastDateTime")},this.getContactInfo=function(){return e.fillContactIfOverEditor(c.getFromCache("contactInfo"))},this.setContactInfo=function(a){return c.setToCache("contactInfo",a)},this.getPurchasedPricingPlan=function(){var a=this.getSelectedTime();return a?a.purchasedPricingPlan:null},this.setPurchasedPricingPlan=function(a){var b=this.getSelectedTime();b.purchasedPricingPlan=a,this.setSelectedTime(b)},this.getFirstUsablePurchasedPricingPlan=function(){return c.getFromCache("firstUsablePurchasedPricingPlan")},this.setFirstUsablePurchasedPricingPlan=function(a){return c.setToCache("firstUsablePurchasedPricingPlan",a)},this.clearPurchasedPricingPlan=function(){var a=this.getSelectedTime();a&&delete a.purchasedPricingPlan,c.clearKey("firstUsablePurchasedPricingPlan")},this.getAppointmentLocation=function(a,b){return a=this.populateService(a),b=this.populateTime(b),j("location",a,b)},this.getAppointmentLocationText=function(a,b){return a=this.populateService(a),b=this.populateTime(b),j("locationText",a,b)},this.isShowBusinessAddress=function(a,b,c,d){return a=this.populateService(a),b=this.populateTime(b),d=d||!1,l.isShowBusinessAddressIndividual(a,b,c,d)||l.isShowBusinessAddressGroups(a,b)},this.populateService=function(a){return a||(a=l.getSelectedOffering()),a},this.populateTime=function(a){return a||(a=l.getSelectedTime()),a},this.isShowBusinessAddressIndividual=function(a,b,c,d){var e=l.getAppointmentLocation(a,b);return a&&a.isCustomerLocationAllowed()&&(l.isCustomerLocationToShow(e,d)||l.isBusinessLocationOnTheGoAndNotServiceLocationCustomer(e,c))&&!this.isInBusinessPlaceWhichIsNotDefined(e,c)},this.isInBusinessPlaceWhichIsNotDefined=function(a,b){return"BUSINESS"===a&&b&&"ON_THE_GO"===b.businessLocation},this.isCustomerLocationToShow=function(a,b){return"CUSTOMER"===a&&b},this.isBusinessLocationOnTheGoAndNotServiceLocationCustomer=function(a,b){return"CUSTOMER"!==a&&(!b||"ON_THE_GO"!==b.businessLocation)},this.isShowBusinessAddressGroups=function(a,b){return a&&!a.isCustomerLocationAllowed()&&!!b&&!!b.groupInstance},this.getBusinessCity=function(a,b,c){if(b=this.populateService(b),c=this.populateTime(c),!this.isOtherLocation(b,c)&&"ON_THE_GO"!==a.businessLocation){var d=a.city,e=a.zipCode;return g("sidebar.address.line2",{city:d,zipCode:e})}},this.isOtherLocation=function(a,b){return"OTHER"===this.getAppointmentLocation(a,b)},l.init()}c.$inject=["cacheSrv","overEditor","paymentType","$translate","userManagementSrv","$rootScope"];var d=a.bookings.visitor.offerings.SelectedOfferingDomain;b.BOOKING_CONFLICT="BOOKING_CONFLICT",b.SELECTED_OFFERING_KEY="SelectedOffering",angular.module("schedulerAngularClientAppInternal").service("appointmentService",c)}(c=b.booking||(b.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c){this.appointmentService=a,this.businessInfoSrv=b,this.experimentsEnabler=c}return a.$inject=["appointmentService","businessInfoSrv","experimentsEnabler"],a.prototype.isEnabled=function(a){return this.experimentsEnabler.isUoUSMSRemindersEnabled()&&a.clientCanAskForSMSReminder&&!this.appointmentService.getSelectedOffering().isPendingApprovalFlow&&this.isNextDayBeforeStartTime()},a.prototype.isNextDayBeforeStartTime=function(){var a=moment(+this.appointmentService.getSelectedTime().startTime);return moment().add(24,"hours").isBefore(a)},a}();a.SmsRemindersSrv=b,angular.module("schedulerAngularClientAppInternal").service("smsRemindersSrv",b)}(b=a.booking||(a.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var SelectedOfferingDomain=wix.bookings.visitor.offerings.SelectedOfferingDomain,BookingProcess=function(){function a(a){this.experimentsEnabler=a}return a.$inject=["experimentsEnabler"],a.prototype.calculateBookingMethod=function(a,b){var c=a.getOfferedAs();return 0===c.length?OfferedAsType.ONE_TIME:1===c.length?c[0]:b},a}();angular.module("schedulerAngularClientAppInternal").service("bookingProcess",BookingProcess),function(){angular.module("schedulerAngularClientAppConstants").constant("serviceConst",{LOCATION_CUSTOMER:"CUSTOMER",LOCATION_OTHER:"OTHER",LOCATION_BUSINESS:"BUSINESS",LOCATIONS_WITH_ADDRESS:["CUSTOMER"]}).constant("SERVICE_EDITOR_DEFAULTS",{imagesList:[{images:[{fileName:"Receptionist",relativeUri:"413707c67361480983896a2e55509f29.jpg",width:7360,height:4912}]},{images:[{fileName:"Clock",relativeUri:"2c2ed29dab6946dfb37072e57fd294a3.jpg",width:3666,height:2435}]},{images:[{fileName:"Modern Coffee Table",relativeUri:"6142ea7f91914d1c9bee8f8380110f78.jpg",width:3025,height:1706}]},{images:[{fileName:"Laptop",relativeUri:"f656fb99b72847c7b66e01324d843074.jpg",width:2560,height:1709}]},{images:[{fileName:"Business Meeting ",relativeUri:"bfc7011abc1642358204a81111b9e72b.jpg",width:4368,height:2912}]},{images:[{fileName:"Table Plant",relativeUri:"e2d524c78f3842a1b74dc3b2f4827727.jpg",width:2560,height:1709}]},{images:[{fileName:"Cactus Plant ",relativeUri:"a781e4805ee549c193112e17192b376c.jpg",width:2560,height:1707}]},{images:[{fileName:"Making Appointments",relativeUri:"7f70fae2af3e444d9ab8c3b7698a6c1a.jpg",width:4944,height:3948}]},{images:[{fileName:"Coffee Time",relativeUri:"d18f6586a05443c8a8d4b671cee5ea4c.jpg",width:2560,height:1707}]}]}).constant("SERVICE_IMAGE_SIZE",{angelina:{width:105,height:105},angelina_round:{width:105,height:105},heidi:{width:470,height:446},heidi_round:{width:360,height:360},bar:{width:300,height:200},bar_round:{width:185,height:185},bar_with_sidebar:{width:370,height:220},bar_with_sidebar_round:{width:225,height:225},mobile:{width:282,height:169},mobile_round:{width:370,height:169}}).constant("GROUP_IMAGE_SIZE",{simple:{width:470,height:446}})}();var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.imagesList=[],this.imagesList.push({images:[{fileName:"Receptionist",relativeUri:"94529b508b40459fb23e9c35b7e7cc0c.jpg",width:2560,height:1707}]}),this.imagesList.push({images:[{fileName:"Receptionist",relativeUri:"2789fba4f9de4318a4fe0cbcfd39b671.jpg",width:2560,height:1707}]}),this.imagesList.push({images:[{fileName:"Receptionist",relativeUri:"515c2410e09149e89d8d70b84beaba0a.jpg",width:2560,height:1707}]})}return a}();a.GroupEditorDefaults=b,angular.module("schedulerAngularClientAppConstants").constant("GROUP_EDITOR_DEFAULTS",new b)}(b=a.groups||(a.groups={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var MemberAreaDeepLinkConst=function(){function a(){}return a.BOOK_ANOTHER_DEEP_LINK_NAME="memberArea_bookAnotherDeepLink",a.RESCHEDULE_DEEP_LINK_NAME="memberArea_rescheduleDeepLink",a.BOOKING="booking",a}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.CANCEL_BOOKING="cancel-booking",a.CANCEL_BOOKING_CONFIRMED="cancel-booking-confirmed",a.MEMBERSHIP_INSTALLED_CHECK="membership-installed-check",a}();a.FedopsInteraction=b}(b=a.constants||(a.constants={}))}(b=a.common||(a.common={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a[a.BUSINESS=0]="BUSINESS",a[a.USER=1]="USER"}(b=a.Timezones||(a.Timezones={}))}(b=a.constants||(a.constants={}))}(b=a.common||(a.common={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(){var b=a.boost.common.constants.Timezones,c=function(){function c(a,b,c){this.$q=a,this.$translate=b,this.momentSrv=c}return c.$inject=["$q","$translate","momentSrv"],c.prototype.getBookingBaseOnTimeZoneText=function(a){var b=a.timezone,c=a.isBookingsTimezoneIndicatorImprovementEnabled,d=a.businessTimezone,e=a.userTimezone,f=this.getTranslationKey({timezone:b,isBookingsTimezoneIndicatorImprovementEnabled:c,businessTimezone:d,userTimezone:e});return this.$translate(f,{city:this.getTranslateTimezoneCity(this.timezoneString({timezone:b,businessTimezone:d,userTimezone:e})),offset:this.currentTimezoneOffset({timezone:b,businessTimezone:d,userTimezone:e})})},c.prototype.getActionTextBaseOnTimeZone=function(a,b){return this.$translate(b?"calendar.timezone-switch.action.mobile":this.isBusiness(a)?"calendar.timezone-switch.action.user":"calendar.timezone-switch.action.business")},c.prototype.getDropdownTextBasedOnTimezone=function(a){var b=a.timezone,c=a.businessTimezone,d=a.userTimezone,e=this.isUSATimezone({timezone:b,businessTimezone:c,userTimezone:d}),f=this.isBusiness(b)?"business":"user",g=e?"-usa":"",h="calendar.timezone"+g+"-dropdown."+f;return this.$translate(h,{city:this.getTranslateTimezoneCity(this.timezoneString({timezone:b,businessTimezone:c,userTimezone:d})),offset:this.currentTimezoneOffset({timezone:b,businessTimezone:c,userTimezone:d})})},c.prototype.calculateOffset=function(a){return this.momentSrv.timestampToLocaleMoment(this.nowTimestamp(),a).format("Z")},c.prototype.currentTimezoneOffset=function(a){var b=a.timezone,c=a.businessTimezone,d=a.userTimezone;return this.calculateOffset(this.timezoneString({timezone:b,businessTimezone:c,userTimezone:d}))},c.prototype.getTranslationKey=function(a){var b=a.timezone,c=a.isBookingsTimezoneIndicatorImprovementEnabled,d=a.businessTimezone,e=a.userTimezone,f=this.isBusiness(b)?"business":"user",g="-city",h=this.isUSATimezone({timezone:b,businessTimezone:d,userTimezone:e})?"-usa":"",i="calendar.timezone"+h+g+"-switch."+(c?"message":f);return i},c.prototype.isUSATimezone=function(b){var c=b.timezone,d=b.businessTimezone,e=b.userTimezone;return a.bookings.timezone.USATimezone.has(this.timezoneString({timezone:c,businessTimezone:d,userTimezone:e}))},c.prototype.getTranslateTimezoneCity=function(a){return this.$translate("timezone-"+a+"-city")},c.prototype.isBusiness=function(a){return+a===b.BUSINESS},c.prototype.timezoneString=function(a){var c=a.timezone,d=a.businessTimezone,e=a.userTimezone;return+c===b.BUSINESS?d:e},c.prototype.nowTimestamp=function(){return moment().valueOf()},c}();angular.module("schedulerAngularClientAppInternal").service("switchTimezoneSrv",c)}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.boost.common.constants.Timezones,d=function(){function a(a,b,d,e,f,g,h,i){this.momentSrv=a,this.libs=b,this.visitorBILogger=d,this.cacheSrv=e,this.$translate=f,this.$element=g,this.switchTimezoneSrv=h,this.experimentsEnabler=i,this.isBookingsTimezoneIndicatorImprovementEnabled=this.experimentsEnabler.isBookingsTimezoneIndicatorImprovementEnabled(),"true"===this.openByDefault&&this.openPopover(),this.isMobile&&(this.timezoneOptions=[{label:this.switchTimezoneSrv.getDropdownTextBasedOnTimezone({timezone:c.BUSINESS,businessTimezone:this.businessTimezone,userTimezone:this.userTimezone}),value:c.BUSINESS},{label:this.switchTimezoneSrv.getDropdownTextBasedOnTimezone({timezone:c.USER,businessTimezone:this.businessTimezone,userTimezone:this.userTimezone}),value:c.USER}],this.selectedItem=this.isBusiness()?c.BUSINESS:c.USER)}return a.$inject=["momentSrv","libs","visitorBILogger","cacheSrv","$translate","$element","switchTimezoneSrv","experimentsEnabler"],a.prototype.isPopoverOpen=function(){return this.popoverOpen},a.prototype.togglePopover=function(){this.popoverOpen?this.closePopover():this.openPopover()},a.prototype.onKeyPress=function(a){var b=a.which,c=13,d=32;(c===b||d===b)&&this.togglePopover()},a.prototype.openPopover=function(){this.popoverOpen=!0,this.visitorBILogger.logPopupOpened(),this.cacheSrv.setToCache(a.CACHE_KEY,!0)},a.prototype.closePopover=function(){this.popoverOpen=!1,this.visitorBILogger.logPopupClosed("time_zone"),this.focusOnTimeZoneLinkElement()},a.prototype.focusOnTimeZoneLinkElement=function(){var a=this.$element.find('[data-hook="timezone-switch"]');focusOn(a)},a.prototype.onSwitch=function(a){this.onSwitchCallback({timezone:a})},a.prototype.isBusiness=function(){return+this.currentTimezone===c.BUSINESS},a.prototype.isUser=function(){return+this.currentTimezone===c.USER},a.prototype.calculateOffset=function(a){return this.switchTimezoneSrv.calculateOffset(a)},a.prototype.userTimezoneOffset=function(){return this.calculateOffset(this.userTimezone)},a.prototype.businessTimezoneOffset=function(){return this.calculateOffset(this.businessTimezone)},a.prototype.getBookingBaseOnTimeZoneText=function(){return this.switchTimezoneSrv.getBookingBaseOnTimeZoneText({timezone:this.currentTimezone,isBookingsTimezoneIndicatorImprovementEnabled:this.isBookingsTimezoneIndicatorImprovementEnabled,businessTimezone:this.businessTimezone,userTimezone:this.userTimezone})},a.prototype.shouldRenderNewTimeZoneSwitch=function(){return this.isBookingsTimezoneIndicatorImprovementEnabled},a.prototype.toggleTimezone=function(){var a=this.isBusiness()?c.USER:c.BUSINESS;this.onSwitchCallback({timezone:a})},a.prototype.getActionTextBaseOnTimeZone=function(){return this.switchTimezoneSrv.getActionTextBaseOnTimeZone(this.currentTimezone)},a.prototype.onDropDownChange=function(a){this.onSwitchCallback({timezone:a})},a.CACHE_KEY="tz_switch_shown",a}();b.TimezoneSwitch=d,angular.module("schedulerAngularClientAppInternal").component("bksTimezoneSwitch",{template:'\n               <div ng-if="!$ctrl.shouldRenderNewTimeZoneSwitch()" class="timezone-switch" ng-click="$ctrl.togglePopover()" ng-keypress="$ctrl.onKeyPress($event)" data-hook="timezone-switch" tabindex="0">\n                 <div class="timezone-switch__icon scheduler-svg-font-icons-clock-icon"\n                 bks-timezone-switch-popover="test"\n                 bks-timezone-switch-popover-placement="bottom"\n                 bks-timezone-switch-popover-animation="false"\n                 bks-timezone-switch-popover-is-open="$ctrl.isPopoverOpen()"\n                 bks-timezone-switch-popover-on-close="$ctrl.closePopover()"\n                 bks-timezone-switch-popover-on-switch="$ctrl.onSwitch(timezone)"\n                 bks-timezone-switch-popover-append-to-body="true"\n                 bks-timezone-switch-popover-btz="{{$ctrl.businessTimezone}}"\n                 bks-timezone-switch-popover-utz="{{$ctrl.userTimezone}}"\n                 bks-timezone-switch-popover-current="{{$ctrl.currentTimezone}}"\n                 bks-timezone-switch-popover-utz-offset="{{$ctrl.userTimezoneOffset()}}"\n                 bks-timezone-switch-popover-btz-offset="{{$ctrl.businessTimezoneOffset()}}"\n                 aria-hidden="true"\n               ></div>\n                 <div class="timezone-switch__label" data-hook="timezone-switch-label">\n                    {{$ctrl.getBookingBaseOnTimeZoneText()}}\n                 </div>\n               </div>\n               <div ng-if="$ctrl.shouldRenderNewTimeZoneSwitch()">\n                <div ng-if="!$ctrl.isMobile">\n                  <span data-hook="timezone-switch-message" class="timezone-switch__message">{{$ctrl.getBookingBaseOnTimeZoneText()}}</span>\n                  <span ng-if="!$ctrl.isNoteOnly" data-hook="timezone-switch-toggle-button" class="basic-link timezone-switch__action" ng-click="$ctrl.toggleTimezone()">{{$ctrl.getActionTextBaseOnTimeZone()}}</span>\n                </div>\n                <div ng-if="$ctrl.isMobile" class="timezone-switch__mobile-wrapper">\n                  <span data-hook="timezone-switch-message" class="timezone-switch__mobile-message">{{$ctrl.getBookingBaseOnTimeZoneText()}}</span>\n                  <boost-hidden-dropdown ng-if="!$ctrl.isNoteOnly"  data-hook="mobile-timezone-dropdown" options="$ctrl.timezoneOptions" on-select="$ctrl.onDropDownChange(value)" action-text="{{\'calendar.timezone-switch.action.mobile\' | translate}}" selected-item="$ctrl.selectedItem"/>\n                </div>\n               </div>\n',controller:d,bindings:{businessTimezone:"@",userTimezone:"@",onSwitchCallback:"&onSwitch",currentTimezone:"@",openByDefault:"@",isNoteOnly:"<",isMobile:"<"}})}(c=b.components||(b.components={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){function c(a){return{restrict:"EA",replace:!0,controller:e,bindTocontroller:!0,controllerAs:"$ctrl",scope:{title:"@",content:"@",placement:"@",animation:"&"},template:function(){return a.getIsMobile()?'<div class="timezone-switch-popover popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }" data-hook="timezone-switch-popover">\n                <div class="arrow"></div>\n                <div class="timezone-switch-popover__body popover-inner">\n                    <div class="timezone-switch-popover__content">\n                        <div class="timezone-switch-popover__current-state" data-hook="timezone-switch-popover__current-state">{{ ::getCurrentStateText()}}</div>\n                        <a class="timezone-switch-popover__switch-button" data-hook="tsp-switch-to" ng-click="onSwitch()">{{ ::getSwitchText()}}</a>\n                    </div>\n                </div>\n             </div>':'\n             <div class="timezone-switch-popover popover {{placement}}" \n                  ng-keydown="onKeyDown($event)" \n                  ng-class="{ in: isOpen(), fade: animation() }" \n                  data-hook="timezone-switch-popover"\n                  aria-label="{{ \'calendar.timezone-switch.popover.accessibility.insidePopup\' | wixSdkTranslate }}"\n                  aria-describedby="switchTimeZoneDesc"\n                  role="dialog"\n                  tabindex="0">\n                <div class="timezone-switch-popover__body popover-inner">\n                    <div ng-click="close()"\n                         ng-keydown="$ctrl.onCloseKeyDown($event)"\n                         class="timezone-switch-popover__close scheduler-svg-font-icons-close"\n                         data-hook="tsp-close"\n                         tabindex="0"\n                         role="button"\n                         aria-label="{{ \'calendar.timezone-switch.popover.accessibility.closePopup\' | wixSdkTranslate }}">\n                    </div>\n                    <div class="timezone-switch-popover__content">\n                        <div class="timezone-switch-popover__current-state" data-hook="timezone-switch-popover__current-state" id="switchTimeZoneDesc">{{::getCurrentStateText()}}</div>\n                        <button data-hook="tsp-switch-to"\n                                class="btn-primary"\n                                type="button"\n                                ng-click="onSwitch()"\n                                tabindex="0"\n                                ng-keydown="$ctrl.onButtonKeyDown($event)">{{::getSwitchText()}}</button>\n                    </div>\n                </div>\n             </div>'}}}var d=a.boost.common.constants.Timezones,e=function(){function b(b,c,e,f,g){var h=this;this.$scope=b,this.$translate=c,this.experimentsEnabler=e,this.$element=f,this.$timeout=g,this.onButtonKeyDown=function(a){var b=9;a.which!==b||a.shiftKey?a.shiftKey&&a.stopPropagation():(a.preventDefault(),a.stopPropagation(),focusOn($(".timezone-switch-popover__close")))},this.onCloseKeyDown=function(a){var b=9,c=13,d=32;a.which===b&&a.shiftKey?(a.preventDefault(),a.stopPropagation(),focusOn($('[data-hook="tsp-switch-to"]'))):(a.which===c||a.which===d)&&(a.preventDefault(),a.stopPropagation(),h.$scope.close())};var i=b.$parent.$parent.$parent,j=i.onSwitch,k=i.onClose,l=i.userOffset,m=i.businessOffset,n=i.userTimezone,o=i.businessTimezone,p=function(){return+i.currentTimezone};b.userOffset=l,b.businessOffset=m,b.onSwitch=function(){var a=b.isBusinessTimezone()?d.USER:d.BUSINESS;j(a),k()},b.isBusinessTimezone=function(){return p()===d.BUSINESS},b.isUserTimezone=function(){return p()===d.USER},b.close=function(){return k()};var q=function(d,e,f){var g=a.bookings.timezone.USATimezone.has(d)?"-usa":"",h=b.isUserTimezone()?"user":"business",i="-city",j=b.getTranslateTimezoneCity(d),k="calendar.timezone-switch.popover."+h+g+i+f;return c(k,{city:j,offset:e})};b.getSwitchText=function(){var a=b.isUserTimezone()?o:n,c=b.isUserTimezone()?m:l;return q(a,c,".button")},b.getCurrentStateText=function(){var a=b.isUserTimezone()?n:o,c=b.isUserTimezone()?l:m;return q(a,c,".message")},b.getTranslateTimezoneCity=function(a){return c("timezone-"+a+"-city")},f.on("click",function(a){a.stopPropagation()}),b.onKeyDown=function(a){var c=27,d=9;a.which===c?b.close():a.which===d&&a.shiftKey&&(a.preventDefault(),a.stopPropagation(),focusOn($('[data-hook="tsp-switch-to"]')))},g(function(){return focusOn(f)})}return b.$inject=["$scope","$translate","experimentsEnabler","$element","$timeout"],b}();b.TimezoneSwitchPopoverCtrl=e,angular.module("schedulerAngularClientAppInternal").directive("bksTimezoneSwitchPopoverPopup",["appConfig",c]),angular.module("schedulerAngularClientAppInternal").directive("bksTimezoneSwitchPopover",["$tooltip","$timeout",function(a,b){var c=a("bksTimezoneSwitchPopover","bksTimezoneSwitchPopover","timezone-switch-popover.open");
c.scope={isOpen:"=bksTimezoneSwitchPopoverIsOpen",onCloseCallback:"&bksTimezoneSwitchPopoverOnClose",onSwitchCallback:"&bksTimezoneSwitchPopoverOnSwitch",businessTimezone:"@bksTimezoneSwitchPopoverBtz",userTimezone:"@bksTimezoneSwitchPopoverUtz",currentTimezone:"@bksTimezoneSwitchPopoverCurrent",userOffset:"@bksTimezoneSwitchPopoverUtzOffset",businessOffset:"@bksTimezoneSwitchPopoverBtzOffset"};var d=c.compile();return{restrict:"A",scope:c.scope,link:function(a,c,e){d.call(null,a,c,e);var f=angular.element("body"),g=function(a){return b(function(){return c.trigger(a)})},h=function(){g("timezone-switch-popover.close"),focusOn(c)},i=function(){return f.click(a.onClose)},j=function(){return f.off("click",a.onClose)};a.onClose=function(){h(),a.onCloseCallback(),j()},a.$watch("isOpen",function(a){a?(g("timezone-switch-popover.open"),b(i)):h()}),a.onSwitch=function(b){a.onSwitchCallback({timezone:b})}}}}])}(c=b.components||(b.components={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){a.PREMIUM_MODAL_WIDTH=600,a.PREMIUM_MODAL_HEIGHT=600,a.ACTION_MODAL_WIDTH=580,a.ACTION_MODAL_HEIGHT=600;var b;!function(a){a.PREVIEW_PREMIUM_MODAL="preview_premium",a.PREVIEW_PREMIUM_PAYMENT_MODAL="preview_premium_payment",a.WAITLIST_MODAL="waitlist",a.MESSAGE_MODAL="message"}(b=a.ModalTypes||(a.ModalTypes={}));var c=function(){function a(){}return a.CONFIRM="confirm",a.CLOSE="close",a}();a.MessageResponse=c;var d=function(){function c(a,b,c,d,e){this.$wix=a,this.visitorBILogger=b,this.urlUtilSrv=c,this.appointmentService=d,this.appConfig=e}return c.$inject=["$wix","visitorBILogger","urlUtilSrv","appointmentService","appConfig"],c.prototype.openModal=function(c,d,e,f){var g=this,h=function(a){return btoa(encodeURIComponent(a))},i=c===b.WAITLIST_MODAL||c===b.MESSAGE_MODAL,j=this.appointmentService.getSelectedOffering(),k=j?j.type:"UNKNOWN",l=d?"&content="+d:"",m=e?"&message="+h(e):"",n=f?"&buttonLabel="+h(f):"",o="_api/bookings-viewer/viewer-modals?modal="+c+"&serviceType="+k+l+m+n,p=this.urlUtilSrv.getUrlForEnv({urlSuffix:o});return i?this.$wix.openBareModal(p,a.ACTION_MODAL_WIDTH,a.ACTION_MODAL_HEIGHT,function(){return null}):(this.appConfig.getIsOwner().then(function(b){return b?g.$wix.openBareModal(p,a.PREMIUM_MODAL_WIDTH,a.PREMIUM_MODAL_HEIGHT,function(){return null}):void 0}),void 0)},c}();a.PreviewModalSrv=d,angular.module("schedulerAngularClientAppInternal").service("previewModalSrv",d)}(b=a.preview||(a.preview={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){a.ACTION_MODAL_WIDTH=580,a.ACTION_MODAL_HEIGHT=284;var b;!function(a){a.GO_BACK_TO_CALENDAR="slot-not-available-go-back-to-calendar",a.GO_BACK_TO_OFFERING_LIST="course-not-available-go-back-to-offering-list",a.SLOT_NOT_AVAILABLE_ON_CALENDAR="slot-not-available-on-calendar"}(b=a.ContentTypes||(a.ContentTypes={}));var c;!function(a){a.DOUBLE_BOOKING_RESCHEDULE="Double_Booking_Reschedule",a.DOUBLE_BOOKING_PAYMENT_PAGE="Double_Booking_Payment_Page",a.DOUBLE_BOOKING_FORM_PAGE="Double_Booking_Form_Page",a.DOUBLE_BOOKING_PAYMENT_PAGE_BOOK_CALL="Double_Booking_Payment_Page_Book"}(c=a.ReferralInfo||(a.ReferralInfo={}));var d=function(){function d(a,b,c,d,e,f,g,h,i){this.$wix=a,this.urlUtilSrv=b,this.routeManager=c,this.clientPages=d,this.appointmentService=e,this.$routeParams=f,this.$rootScope=g,this.visitorBILogger=h,this.bookingDataSrv=i}return d.$inject=["$wix","urlUtilSrv","routeManager","clientPages","appointmentService","$routeParams","$rootScope","visitorBILogger","bookingDataSrv"],d.prototype.openModal=function(b){var c=this,d=this.appointmentService.getSelectedOffering().type,e=this.getModalContent(b,d),f=this.getBookingId(b),g=this.urlUtilSrv.getUrlForEnv({urlSuffix:"_api/bookings-viewer/viewer-modals?modal=message&content="+e});this.$wix.openBareModal(g,a.ACTION_MODAL_WIDTH,a.ACTION_MODAL_HEIGHT,function(a){return c.navigateToTimeSelection(a)}),this.visitorBILogger.logDoubleBooking(b,d,f)},d.prototype.getBookingId=function(a){return a===c.DOUBLE_BOOKING_PAYMENT_PAGE?this.bookingDataSrv.getBookingId():void 0},d.prototype.getModalContent=function(a,c){return"Double_Booking_Reschedule"===a?b.SLOT_NOT_AVAILABLE_ON_CALENDAR:c===OfferingType.COURSE?b.GO_BACK_TO_OFFERING_LIST:b.GO_BACK_TO_CALENDAR},d.prototype.navigateToTimeSelection=function(a){if(a&&a.message&&"confirm"===a.message.reason){var b=this.appointmentService.getSelectedOffering().type;switch(b){case OfferingType.GROUP:this.routeManager.gotoPage(this.clientPages.VISITOR_GROUPS_CALENDAR);break;case OfferingType.INDIVIDUAL:this.routeManager.gotoPage(this.clientPages.VISITOR_CALENDAR);break;default:this.routeManager.gotoPage(this.clientPages.VISITOR_SERVICES)}this.$rootScope.$digest()}},d}();a.SlotNotAvailableModalSrv=d,angular.module("schedulerAngularClientAppInternal").service("slotNotAvailableModalSrv",d)}(b=a.modals||(a.modals={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a,b,c,d,e,f){this.$wix=a,this.urlUtilSrv=b,this.$translate=c,this.$routeParams=d,this.$rootScope=e,this.bookingDataSrv=f}return b.$inject=["$wix","urlUtilSrv","$translate","$routeParams","$rootScope","bookingDataSrv"],b.prototype.openModal=function(){var b=this.$translate("visitor.confirmation.error.general"),c=this.$translate("visitor.confirmation.error.general-button"),d="&message="+btoa(b),e="&buttonLabel="+btoa(c),f=this.urlUtilSrv.getUrlForEnv({urlSuffix:"_api/bookings-viewer/viewer-modals?modal=message&content=dynamic"+d+e});this.$wix.openBareModal(f,a.ACTION_MODAL_WIDTH,a.ACTION_MODAL_HEIGHT,function(){return null})},b}();a.GeneralErrorModalSrv=b,angular.module("schedulerAngularClientAppInternal").service("generalErrorModalSrv",b)}(b=a.modals||(a.modals={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.boost.visitor.calendar.TimeSlotOption,d=a.boost.common.constants.Timezones,e=a.bookings.visitor.components.TimezoneSwitch,f=a.visitor.preview.ModalTypes,g=a.bookings.common.domain.DefaultTimezoneOptions,h=function(){function b(a,b,c,d,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J){this.$scope=a,this.$rootScope=b,this.slotsSrv=c,this.appointmentService=d,this.$route=e,this.$element=g,this.clientPages=h,this.routeManager=i,this.flowManagerSrv=j,this.$timeout=k,this.wixBiLogger=l,this.$wix=m,this.TimeOfDay=n,this.CALENDAR_EVENTS=o,this.visitorBILogger=p,this.experimentsEnabler=q,this.$routeParams=r,this.$q=s,this.cacheSrv=t,this.visitorTimezoneSrv=v,this.libs=w,this.$translate=x,this.offeringValidationsSrv=y,this.siteUrlManagerSrv=z,this.historyAdapter=A,this.pricingPlanTPANavigator=B,this.nextLabelSrv=C,this.userPurchasedPlanSrv=D,this.bookingProcess=E,this.membershipSrv=F,this.overEditor=G,this.premiumService=H,this.previewModalSrv=I,this.futureBookingSrv=J,this.isActionComplete=!1,this.displayFutureBookingMessage=!1,this.blockProgressWithMsg="",this.firstUsablePurchasedPricingPlan=null,this.shouldShowCalendarErrorMessage=!1,this.sideBarErrorMessage="",this.isTimezoneIndicationImprovementEnabled=q.isBookingsTimezoneIndicatorImprovementEnabled(),this.isUoUCTAEnabled=q.isUoUCTAEnabled(),this.businessInfo=e.current.locals.businessInfo,this.isTimezoneNoteOnly=!this.businessInfo.timezoneProperties.clientCanChooseTimezone,this.selectedOffering=this.appointmentService.getSelectedOffering(),this.staff=e.current.locals.staff,this.firstAvailableDate=e.current.locals.firstAvailableDate,this.currentTimezone=this.determineInitialTimezone(r.timezone),this.visitorBILogger.logTimezone();var K=e.current.locals.capableStaff;this.capableStaff=u(OrderByLowerCase.FILTER_NAME)(K.map(function(a){return{value:a.id,label:a.fullName}}),"label"),this.registerListeners(a,o,p),this.restorePreviousStateIfPresent(),this.libs.$(".aria-page-title").html(""),this.libs.$(".aria-page-title").attr("aria-hidden",!1),this.offeringValidationsSrv.isOfferingBookableTroughCalendar(this.selectedOffering)||(this.blockProgressWithMsg="offering-list.premium-not-enabled.message"),this.siteUrlManagerSrv.setCalendarPrefix(this.selectedOffering.urlName),this.overEditor.isOverEditor&&!this.premiumService.isOfferingTypeFeatureEnabled(this.selectedOffering.type)&&this.previewModalSrv.openModal(f.PREVIEW_PREMIUM_MODAL)}return b.$inject=["$scope","$rootScope","slotsSrv","appointmentService","$route","$element","clientPages","routeManager","flowManagerSrv","$timeout","wixBiLogger","$wix","TimeOfDay","CALENDAR_EVENTS","visitorBILogger","experimentsEnabler","$routeParams","$q","cacheSrv","$filter","visitorTimezoneSrv","libs","$translate","offeringValidationsSrv","siteUrlManagerSrv","historyAdapter","pricingPlanTPANavigator","nextLabelSrv","userPurchasedPlanSrv","bookingProcess","membershipSrv","overEditor","premiumService","previewModalSrv","futureBookingSrv"],b.prototype.closeFutureBookingPolicyMessage=function(){this.displayFutureBookingMessage=!1},Object.defineProperty(b.prototype,"actionLabel",{get:function(){return this.showMultipleOfferedAsLabel()?this.nextLabelSrv.getMultipleOfferedAsLabel():this.isPricingPlanOffering()&&this.slot&&!this.hasValidPlan()?this.nextLabelSrv.getIndividualViewPricingPlanLabel():this.nextLabelSrv.getLabel({isLastStep:!1,onlinePaymentLabel:"",offlinePaymentLabel:""})},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"ariaActionLabel",{get:function(){return this.nextLabelSrv.getAriaLabel({isLastStep:!1,onlinePaymentLabel:"",offlinePaymentLabel:"",isNextStepDisabled:this.isActionComplete})},enumerable:!0,configurable:!0}),b.prototype.showMultipleOfferedAsLabel=function(){return!!this.bookedAs},b.prototype.focusOnTimeZoneLinkElement=function(){var a=this.$element.find('[data-hook="timezone-switch"]');focusOn(a)},b.prototype.$onInit=function(){this.setAccessibleData()},b.prototype.setAccessibleData=function(){var a=this;this.$timeout(function(){a.libs.$(".aria-page-title").html(a.ariaLabelPageAlert())},1500),this.$timeout(function(){a.libs.$(".aria-page-title").html("")},2e3),this.hasTimezoneRouteParameter()&&this.$timeout(function(){a.focusOnTimeZoneLinkElement()}),this.siteUrlManagerSrv.getUrl().then(function(b){a.pageUrl=b})},b.prototype.$onDestroy=function(){this.pageUrl&&this.pageUrl.search("/calendar$")>0&&this.siteUrlManagerSrv.resetUrl()},b.prototype.hasTimezoneRouteParameter=function(){return this.$routeParams.hasOwnProperty("timezone")},b.prototype.ariaLabelPageAlert=function(){return this.$translate("calendar.accessibility.alert-title",{serviceName:this.selectedOffering.name})},b.prototype.determineInitialTimezone=function(a){var b=this.appointmentService.getSelectedTime();return angular.isDefined(a)?+a:b?this.businessTimezone&&b.timeZone===this.businessTimezone.name?d.BUSINESS:d.USER:this.businessInfo.timezoneProperties.defaultTimezone===g.BUSINESS?d.BUSINESS:d.USER},b.prototype.durationInMinutes=function(){return this.selectedOffering.futureBookingsPolicy.limitXMinutesToTheFuture},b.prototype.registerListeners=function(a,b,c){var d=this;a.$on(b.DAY_SELECTED,function(a,b){d.slot=null,d.isActionComplete=!1,d.selectedDate=b.startOf("day"),c.selectDay(),d.availableSlotsForDay=d.createAvailableSlotsForDay(d.selectedDate),d.displayFutureBookingMessage=d.availableSlotsForDay&&d.selectedOffering.futureBookingsPolicy&&d.isDayHaveUnavailableSlots(),d.storeLastSelectionIfOverTheEditor(""+b.valueOf()),d.handlePrepopulatedDateIfRequired()}),a.$on(b.SLOT_SELECTED,function(a,b){d.isActionComplete=!!b.getStaff(),d.slot=b,c.selectSlot(),d.selectedOffering.isPricingPlanOffering()&&d.handlePlanWhenSlotChanged(),d.isActionComplete&&(d.sideBarErrorMessage="",d.$rootScope.$broadcast(d.CALENDAR_EVENTS.SLOT_WITH_STAFF_SELECTED))}),a.$on(PricingPlanConst.BOOKING_METHOD_SELECTED,function(a,b){return d.handleBookedAsChange(b)})},b.prototype.isDayHaveUnavailableSlots=function(){var a=this.selectedOffering.futureBookingsPolicy,b=a.shouldLimit,c=a.limitXMinutesToTheFuture,d=Object.keys(this.getMorningSlots()),e=Object.keys(this.getAfternoonSlots()),f=Object.keys(this.getEveningSlots());return!this.futureBookingSrv.isTimeStampsInBookingWindow({shouldLimit:b,limitXMinutesToTheFuture:c,timeStamps:d})||!this.futureBookingSrv.isTimeStampsInBookingWindow({shouldLimit:b,limitXMinutesToTheFuture:c,timeStamps:e})||!this.futureBookingSrv.isTimeStampsInBookingWindow({shouldLimit:b,limitXMinutesToTheFuture:c,timeStamps:f})},b.prototype.handleBookedAsChange=function(a){this.bookedAs=a},b.prototype.handlePlanWhenSlotChanged=function(){var a=this;return this.userPurchasedPlanSrv.bookableSelected(this.slot.getTime().valueOf()).then(function(b){return a.slot.setPurchasedPricingPlan(b),a.$rootScope.$emit("CALENDAR_EVENTS.SLOT_UPDATED",a.slot),b})},b.prototype.getCapableStaff=function(){return this.capableStaff},Object.defineProperty(b.prototype,"numOfStaff",{get:function(){return this.staff?this.staff.staff.length:0},enumerable:!0,configurable:!0}),b.prototype.handlePrepopulatedDateIfRequired=function(){var a=this;if(this.prePopulatedDate){var b=this.prePopulatedDate,d=b.startTime,e=b.staffMember,f=new c(+d,this.currentTimezoneString(),e);this.$timeout(function(){a.$rootScope.$broadcast(a.CALENDAR_EVENTS.SLOT_SELECTED,f),a.prePopulatedDate=null})}},b.prototype.storeLastSelectionIfOverTheEditor=function(a){this.$wix.isInEditingMode()&&this.appointmentService.setSelectedTime({startTime:a})},b.prototype.restorePreviousStateIfPresent=function(){var a,b=this,c=this.appointmentService.getSelectedTime();if(c)this.prePopulatedDate=c,a=c.startTime;else{var d=this.appointmentService.getCurrentBooking();d&&(a=d.start)}a&&this.$timeout(function(){b.$rootScope.$broadcast(b.CALENDAR_EVENTS.SELECT_DATE,moment.tz(+a,b.currentTimezoneString()))},200)},b.prototype.createAvailableSlotsForDay=function(a){return this.slotsSrv.partitionSlotsIntoPartsOfDay(this.staffMemberAvailabilityInRange,a,this.currentTimezoneString())},b.prototype.isBookedByPricingPlan=function(){return this.bookedAs===OfferedAsType.PRICING_PLAN},b.prototype.getSlotsAvailability=function(a){var b=this;return this.staffMemberUpdated?(this.staffMemberUpdated=!1,this.$q.when(this.staffMemberAvailabilityInRange)):this.slotsSrv.getSlotsAvailability(a,this.currentTimezoneString(),this.selectedOffering).then(function(a){return b.slotsAvailabilityForRange=a,b.experimentsEnabler.isBookingsPackagesEnabled()&&!b.firstAvailableSlot&&b.selectedOffering.isPricingPlanOffering()&&b.getFirstAvailableSlot(a),b.resolveStaffMemberAvailability(),b.staffMemberAvailabilityInRange}).catch(function(){b.shouldShowCalendarErrorMessage=b.experimentsEnabler.isCalendarFailedErrorMessageUOUEnabled()})},b.prototype.getFirstAvailableSlot=function(b){var c=this,d=moment().valueOf();Object.keys(b).some(function(a){return b[a].length>0&&parseInt(a,10)>=d?(c.firstAvailableSlot=moment(parseInt(b[a][0].slots[0],10)),!0):void 0}),this.firstAvailableSlot&&this.membershipSrv.getAvailablePricingPlan(this.firstAvailableSlot.valueOf(),this.selectedOffering.id).then(function(b){c.firstUsablePurchasedPricingPlan=a.visitor.booking.PurchasedPricingPlanFactory.fromDto(b,c.currentTimezoneString())})},b.prototype.getAvailableSlotsDuringTimeOfDay=function(a){return this.availableSlotsForDay[a]},b.prototype.getMorningSlots=function(){return this.getAvailableSlotsDuringTimeOfDay(this.TimeOfDay.MORNING)},b.prototype.getAfternoonSlots=function(){return this.getAvailableSlotsDuringTimeOfDay(this.TimeOfDay.AFTERNOON)},b.prototype.getEveningSlots=function(){return this.getAvailableSlotsDuringTimeOfDay(this.TimeOfDay.EVENING)},b.prototype.isDaySelected=function(){return!!this.selectedDate},b.prototype.getSlotRange=function(){var a=this.slot.getTime();return{start:a,end:a.clone().add(this.selectedOffering.duration,"minutes")}},b.prototype.isPricingPlanOffering=function(){return this.selectedOffering.isPricingPlanOffering()},b.prototype.goToNextPage=function(){this.isUoUCTAEnabled&&!this.isActionComplete?(this.visitorBILogger.sendNextFailed({referralInfo:"calendar",errorReason:this.slot?"missing-staff":"missing-slot"}),this.sideBarErrorMessage="sidebar.next.calendar.error-message"):(this.storeSlotData(),this.visitorBILogger.sendNext({referralInfo:"date&time"}),this.isBookedByPricingPlan()&&!this.hasValidPlan()?this.pricingPlanTPANavigator.navigate(this.selectedOffering.pricingPlanInfo.pricingPlans):this.flowManagerSrv.next())},b.prototype.hasValidPlan=function(){return!!this.slot.getPurchasedPricingPlan()},b.prototype.getBookedAs=function(){return this.bookingProcess.calculateBookingMethod(this.selectedOffering,this.bookedAs)},b.prototype.storeSlotData=function(){var a=this.getSlotDataToStore();this.appointmentService.setSelectedTime(a)},b.prototype.getSlotDataToStore=function(){var a=this.getSlotRange(),b=this.slot.getStaff(),c={startTime:a.start.valueOf(),endTime:a.end.valueOf(),timeZone:this.currentTimezoneString(),staffMember:b,purchasedPricingPlan:this.slot.getPurchasedPricingPlan(),bookedAs:this.getBookedAs()};return c},b.prototype.currentTimezoneString=function(){return this.currentTimezone===d.BUSINESS?this.businessTimezone.name:this.userTimezone.name},b.prototype.goBack=function(){this.visitorBILogger.backButtonPressed("date&time","INDIVIDUAL"),this.flowManagerSrv.prev()},b.prototype.isDayFull=function(){return!this.slotsSrv.getAvailableSlotsForTheDay(this.slotsAvailabilityForRange,this.selectedDate,this.currentTimezoneString())},b.prototype.onCalendarRendered=function(){this.firstAvailableDate&&(this.$rootScope.$broadcast(this.CALENDAR_EVENTS.GO_TO_MONTH,this.firstAvailableDate),this.firstAvailableDate=null)},b.prototype.onStaffSelected=function(a){this.currentStaffMemberId!==a&&(this.currentStaffMemberId=a,this.resolveStaffMemberAvailability(),this.staffMemberUpdated=!0,this.deselectDay(),this.expandCalendar(),this.forceAvailableDatesRefresh(),this.visitorBILogger.staffMemberSelectionChangedFromCalendar())},b.prototype.promptTimezoneSwitch=function(){return!angular.isDefined(this.$routeParams.timezone)&&!this.prePopulatedDate&&!this.cacheSrv.getFromCache(e.CACHE_KEY)},b.prototype.expandCalendar=function(){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.EXPAND)},b.prototype.deselectDay=function(){this.selectedDate=null},b.prototype.forceAvailableDatesRefresh=function(){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.REFRESH_EVENTS_SOURCE,this.currentTimezoneString())},b.prototype.onTimezoneSwitch=function(a){var b=this.selectedOffering.type,c="calendar";this.visitorBILogger.timezoneSwitched({timezone:a,type:b,referralInfo:c}),this.routeManager.gotoPage(this.clientPages.VISITOR_CALENDAR+"/"+a)},b.prototype.resolveStaffMemberAvailability=function(){this.staffMemberAvailabilityInRange=this.currentStaffMemberId?this.slotsSrv.getAvailabilityOfStaffMember(this.slotsAvailabilityForRange,this.currentStaffMemberId):this.slotsAvailabilityForRange},b.prototype.allowTimezoneSwitch=function(){return!this.visitorTimezoneSrv.isBusinessTimezoneEqualToVisitorTimezone(this.businessTimezone,this.userTimezone)},b.prototype.showBackButton=function(){return!this.overEditor.isPreviewMode()&&!this.historyAdapter.isHistoryEmpty()},b}();b.CalendarPageCtrl=h,angular.module("schedulerAngularClientAppInternal").controller("CalendarPageCtrl",h).component("boostCalendarPage",{templateUrl:"modules/calendar-page/calendar-page.preload.html",controller:h,controllerAs:"clpCtrl",bindings:{businessTimezone:"=",userTimezone:"="}})}(c=b.calendar||(b.calendar={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.NEXT="DispatchedEvents.NEXT",a.NEXT_FAILED="DispatchedEvents.NEXT_FAILED",a.APPOINTMENT_BOOKED="DispatchedEvents.APPOINTMENT_BOOKED",a.CONTACT_INFO_SAVE_SUCCESS="DispatchedEvents.CONTACT_INFO_SAVE_SUCCESS",a.CANCELLATION_POLICY="DispatchedEvents.CANCELLATION_POLICY",a.CHOOSE_TIME_SLOT="DispatchedEvents.CHOOSE_TIME_SLOT",a.BOOK_ANOTHER="DispatchedEvents.BOOK_ANOTHER",a.GOOGLE_EXPORT="DispatchedEvents.GOOGLE_EXPORT",a.BOOKIT="DispatchedEvents.BOOKIT",a.BOOKED_GROUP_BUT_NOT_PREMUIM="DispatchedEvents.BOOKED_GROUP_BUT_NOT_PREMUIM",a.CAL_TODAY="DispatchedEvents.CAL_TODAY",a.SERVICE_TYPE_WELCOME_PAGE="DispatchedEvents.SERVICE_TYPE_WELCOME_PAGE",a.CAL_MOVE="DispatchedEvents.CAL_MOVE",a.SERVICES_PAGE_OPENED="DispatchedEvents.SERVICES_PAGE_OPENED",a.CHOOSE_STAFF_MEMBER_POPUP_OPENED="DispatchedEvents.CHOOSE_STAFF_MEMBER_POPUP_OPENED",a.CHOOSE_STAFF_MEMBER="DispatchedEvents.CHOOSE_STAFF_MEMBER",a.CHANGE_STAFF_MEMBER_SELECTION="DispatchedEvents.CHANGE_STAFF_MEMBER_SELECTION",a.LOG_TIMEZONE="DispatchedEvents.LOG_TIMEZONE",a.PARTICIPANTS_AMOUNT_CHANGE="DispatchedEvents.PARTICIPANTS_AMOUNT_CHANGE",a.POPUP_CLOSED="DispatchedEvents.CLOSE_POPUP",a.TIMEZONE_POPUP_OPENED="DispatchedEvents.TIMEZONE_POPUP_OPENED",a.TIMEZONE_SWITCH="DispatchedEvents.TIMEZONE_SWITCH",a.DEEP_LINK_CALENDAR_OPEN="DispatchedEvents.DEEP_LINK_CALENDAR_OPEN",a.LOGIN_CLICKED="DispatchedEvents.LOGIN_CLICKED",a.LOGIN_COMPLETE="DispatchedEvents.LOGIN_COMPLETE",a.POST_LOGIN_COMPLETE="DispatchedEvents.POST_LOGIN_COMPLETE",a.GO_TO_ACCOUNT_MANAGEMENT="DispatchedEvents.GO_TO_ACCOUNT_MANAGEMENT",a.BOOKING_RESCHEDULE="DispatchedEvents.BOOKING_RESCHEDULE",a.BOOKING_RESCHEDULE_SUCCESS="DispatchedEvents.BOOKING_RESCHEDULE_SUCCESS",a.BOOKING_CANCEL="DispatchedEvents.BOOKING_CANCEL",a.ACCOUNT_MANAGEMENT_SECTION_SELECTION="DispatchedEvents.ACCOUNT_MANAGEMENT_SECTION_SELECTION",a.ACCOUNT_MANAGEMENT_SEE_SERVICES="DispatchedEvents.ACCOUNT_MANAGEMENT_SEE_SERVICES",a.USER_INFO_SAVED="DispatchedEvents.USER_INFO_SAVED",a.USER_INFO_EDIT_CLICKED="DispatchedEvents.USER_INFO_EDIT_CLICKED",a.SIGNOUT_CLICKED="DispatchedEvents.SIGNOUT_CLICKED",a.SHOW_SERVICE_DETAILS="DispatchedEvents.SHOW_SERVICE_DETAILS",a.APPOINTMENT_BOOKED_VALIDATION="DispatchedEvents.APPOINTMENT_BOOKED_VALIDATION",a.PRICING_PLAN_VIEW="DispatchedEvents.PRICING_PLAN_VIEW",a.DEEP_LINK_PRICING_PLAN="DispatchedEvents.DEEP_LINK_PRICING_PLAN",a.CHOOSE_DAY="DispatchedEvents.CHOOSE_DAY",a.BACK="DispatchedEvents.BACK",a.ENTER_COUPON_CLICKED="DispatchedEvents.ENTER_COUPON_CLICKED",a.APPLY_COUPON_CLICKED="DispatchedEvents.APPLY_COUPON_CLICKED",a.DELETE_COUPON_CLICKED="DispatchedEvents.DELETE_COUPON_CLICKED",a.NAVIGATION_FROM_WIDGET="DispatchedEvents.NAVIGATION_FROM_WIDGET",a.LOAD_MORE_HOURS="DispatchedEvents.LOAD_MORE_HOURS",a.EXPERIMENT_EXPOSURE="DispatchedEvents.EXPERIMENT_EXPOSURE",a.JOIN_WAITING_LIST_CLICKED="DispatchedEvents.JOIN_WAITING_LIST_CLICKED",a.DOUBLE_BOOKING_HAPPENED="DispatchedEvents.DOUBLE_BOOKING_HAPPENED",a}();a.DispatchedEvents=b;var c=function(){function a(){this.BOOKIT={evid:501},this.MORE={evid:502},this.CAL_MOVE={evid:504},this.CAL_TODAY={evid:505},this.CHOOSE_TIME_SLOT={evid:506},this.CHANGE={evid:508},this.NEXT={evid:509},this.NEXT_FAILED={evid:518},this.BACK={evid:510},this.JOIN_WAITLIST_CTA={evid:581},this.SYS_MSG_CLOSE={evid:511},this.BOOK_ANOTHER={evid:512},this.GOOGLE_EXPORT={evid:513},this.SERVICES_PAGE_OPENED={evid:515},this.CONTACT_INFO_SAVE_SUCCESS={evid:517},this.CANCELLATION_POLICY={evid:521},this.SERVICE_TYPE_WELCOME_PAGE={evid:522},this.APPOINTMENT_BOOKED={evid:526},this.BOOKED_GROUP_BUT_NOT_PREMUIM={evid:527},this.ERROR={evid:524},this.CHANGE_STAFF_MEMBER_SELECTION={evid:529},this.CHOOSE_STAFF_MEMBER={evid:530},this.CHOOSE_STAFF_MEMBER_POPUP_OPENED={evid:531},this.LOG_TIMEZONE={evid:532},this.PARTICIPANTS_AMOUNT_CHANGE={evid:533},this.TIMEZONE_SWITCH={evid:538},this.TIMEZONE_POPUP_OPENED={evid:539},this.DEEP_LINK_CALENDAR_OPEN={evid:541},this.LOGIN_CLICKED={evid:542},this.LOGIN_COMPLETE={evid:543},this.POST_LOGIN_COMPLETE={evid:557},this.GO_TO_ACCOUNT_MANAGEMENT={evid:544},this.BOOKING_RESCHEDULE={evid:546},this.BOOKING_RESCHEDULE_SUCCESS={evid:551},this.BOOKING_CANCEL={evid:547},this.ACCOUNT_MANAGEMENT_SECTION_SELECTION={evid:548},this.ACCOUNT_MANAGEMENT_SEE_SERVICES={evid:549},this.USER_INFO_SAVED={evid:550},this.USER_INFO_EDIT_CLICKED={evid:553},this.SIGNOUT_CLICKED={evid:552},this.SHOW_SERVICE_DETAILS={evid:560},this.APPOINTMENT_BOOKED_VALIDATION={evid:565},this.PRICING_PLAN_VIEW={evid:567},this.DEEP_LINK_PRICING_PLAN={evid:568},this.CHOOSE_DAY={evid:570},this.ENTER_COUPON_CLICKED={evid:571},this.APPLY_COUPON_CLICKED={evid:572},this.DELETE_COUPON_CLICKED={evid:573},this.NAVIGATION_FROM_WIDGET={evid:577},this.LOAD_MORE_HOURS={evid:578},this.EXPERIMENT_EXPOSURE={evid:666},this.MODAL_OPENED={evid:558}}return a}();a.AppEventMap=c;var d=function(){function a(){this.SETTINGS_OPENED={evid:160},this.SETTINGS_GET_STARTED={evid:142},this.SHOW_HIDE={evid:110},this.APP_SET_SCREENS_DROP_DOWN={evid:111},this.APP_SET_TAB_MENU_CLICK={evid:112},this.APP_SET_LAYOUT_SELECTION={evid:113},this.APP_SET_CATEGORY_MENU_SELECTION={evid:125},this.APP_SET_IMAGE_SELECTION={evid:126},this.APP_SET_ALIGNMENT_SELECTION={evid:127},this.UPGRADE_CLICKED={evid:156},this.APP_SET_PATE_TITLE_SHOW={evid:143},this.SETTINGS_ADD_SERVICE={evid:165},this.SETTINGS_TEXT_CHANGED={evid:166},this.SETTINGS_STYLE_CHANGED={evid:167},this.SETTINGS_LAYOUT_TAB_POSITION_CHANGED={evid:168},this.BACKOFFICE_CLICKED={evid:275},this.SETTINGS_CUSTOMISE_INTERVALS={evid:325},this.APP_SET_SCHEDULE_DISPLAY={evid:356}}return a}();a.SettingsEventMap=d,angular.module("schedulerAngularClientAppConstants").constant("appEventMap",new c).constant("settingsEventMap",new d)}(b=a.bi||(a.bi={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.$translate=a,this.futureBookingSrv=b}return a.$inject=["$translate","futureBookingSrv"],Object.defineProperty(a.prototype,"message",{get:function(){return this.$translate("visitor.calendar.future-booking.message",{duration:this.futureBookingSrv.splitDuration(this.durationInMinutes)})},enumerable:!0,configurable:!0}),a}();a.FutureBookingMessage=b,angular.module("schedulerAngularClientAppInternal").component("bksFutureBookingMessage",{template:'<div class="future-booking-message__container" data-hook="future-booking-message-wrapper">\n                  <div class="future-booking-message__message" data-hook="future-booking-message">{{$ctrl.message}}</div>\n                  <div class="future-booking-message__close-button scheduler-svg-font-icons-close"\n                    data-hook="future-booking-message-close"\n                    role="button"\n                    ng-click="$ctrl.onClose()"/>\n                </div>',controller:b,bindings:{durationInMinutes:"<",onClose:"&"}})}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.$translate=a}return a.$inject=["$translate"],Object.defineProperty(a.prototype,"message",{get:function(){return this.$translate("visitor.calendar.no-slots-available.message")},enumerable:!0,configurable:!0}),a}();a.NoSlotsAvailableMessage=b,angular.module("schedulerAngularClientAppInternal").component("bksNoSlotsAvailableMessage",{template:'<div class="no-slots-available-message__container" data-hook="no-slots-available-message-wrapper">\n                  <div class="no-slots-available-message__message" data-hook="no-slots-available-message">{{$ctrl.message}}</div>\n                 </div>',controller:b})}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c=function(){function b(a,b,c){this.$translate=a,this.$filter=b,this.paymentService=c}return b.$inject=["$translate","$filter","paymentService"],b.prototype.$onInit=function(){var a=this;this.paymentService.hasUpfrontPayment(this.deposit).then(function(b){a.hasUpfrontPayment=b})},Object.defineProperty(b.prototype,"newPriceText",{get:function(){return this.formatPrice(this.coupon.priceAfterDiscount)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"originalPriceText",{get:function(){return this.formatPrice(this.coupon.totalPrice)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"discountText",{get:function(){return this.formatPrice(this.coupon.priceAfterDiscount-this.coupon.totalPrice)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"depositText",{get:function(){return this.formatPrice(this.coupon.deposit)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"currency",{get:function(){return this.coupon.currency},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"shouldShowDeposit",{get:function(){return this.showDeposit&&this.hasUpfrontPayment},enumerable:!0,configurable:!0}),b.prototype.formatPrice=function(b){return this.$filter("isoCurrency")(b,this.currency,a.bookings.visitor.payments.getFractionDigitsForPrice(b))},b}();b.SidebarCouponsInfo=c,angular.module("schedulerAngularClientAppInternal").component("bksCouponsInfo",{templateUrl:"modules/coupons/coupons-info/coupons-info.preload.html",bindings:{deposit:"<",coupon:"<",showDeposit:"<"},controller:c})}(c=b.booking||(b.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c=a.visitor.booking.CouponsErrorType;b.COUPONS_STATUS={VALID:"VALID",EXPIRED:"EXPIRED",INVALID:"INVALID"};var d=function(){function a(a,b,c,d,e,f,g,h,i){this.$translate=a,this.$filter=b,this.$rootScope=c,this.appointmentService=d,this.paymentService=e,this.visitorBILogger=f,this.couponsSrv=g,this.$element=h,this.$timeout=i,this.isCollapsed=!0,this.displayMessageDelayer=!1,g.clearLastAppliedCoupon()}return a.$inject=["$translate","$filter","$rootScope","appointmentService","paymentService","visitorBILogger","couponsSrv","$element","$timeout"],a.prototype.$onInit=function(){var a=this,b=this.selectedOffering.minCharge;this.paymentService.hasUpfrontPayment(b).then(function(b){a.hasUpfrontPayment=b})},Object.defineProperty(a.prototype,"couponCode",{get:function(){return this.couponsSrv.getCouponCode()},set:function(a){this.couponsSrv.setCouponCode(a)},enumerable:!0,configurable:!0}),a.prototype.applyCoupon=function(){var a=this;this.couponCode&&this.couponsSrv.applyCoupon().then(function(c){a.displayMessageDelayer=!1,c.errors.length?(a.visitorBILogger.applyCouponClicked(b.COUPONS_STATUS.INVALID),a.showErrorMessage(c.errors.pop().code)):a.visitorBILogger.applyCouponClicked(b.COUPONS_STATUS.VALID)})},a.prototype.onMouseDown=function(){this.couponCode&&(this.displayMessageDelayer=!0)},Object.defineProperty(a.prototype,"isShowMessage",{get:function(){return this.couponCode&&!this.couponApplied&&!this.errorMessage&&!this.displayMessageDelayer&&!this.isInputFocused},enumerable:!0,configurable:!0}),a.prototype.keyPressHandler=function(a){var b=a.which,c=a.target,d=13;b===d?(this.applyCoupon(),c.blur()):this.errorMessage=void 0},a.prototype.cancelClicked=function(){this.visitorBILogger.deleteCouponClicked(),this.couponsSrv.clearLastAppliedCoupon()},Object.defineProperty(a.prototype,"couponApplied",{get:function(){return this.couponsSrv.isCouponApplied()},enumerable:!0,configurable:!0}),a.prototype.toggleCollapse=function(a){var b=this;this.isCollapsed&&(this.visitorBILogger.enterCouponClicked(),this.$timeout(function(){return b.$element.find('[id="coupons-form-input"]').first().trigger("focus")})),this.preventScrollDownWhenSpaceKeyClicked(a),this.isCollapsed=!this.isCollapsed},a.prototype.onFocusInput=function(){this.isInputFocused=!0},a.prototype.onBlurInput=function(){this.isInputFocused=!1},a.prototype.showErrorMessage=function(a){switch(a){case c.ERROR_COUPON_HAS_EXPIRED:case c.ERROR_COUPON_USAGE_EXCEEDED:return this.errorMessage="sidebar.coupon.errors.expired",void 0;case c.ERROR_COUPON_SERVICE_UNAVAILABLE:return this.errorMessage="sidebar.coupon.errors.service-unavailable",void 0;case c.ERROR_COUPON_DOES_NOT_EXIST:default:this.errorMessage="sidebar.coupon.errors.no-valid"}},a.prototype.preventScrollDownWhenSpaceKeyClicked=function(a){var b=32;
b===a.which&&a.preventDefault()},a}();b.SidebarCouponsForm=d,angular.module("schedulerAngularClientAppInternal").component("bksCouponsForm",{templateUrl:"modules/coupons/coupons-form/coupons-form.preload.html",bindings:{selectedOffering:"<"},controller:d})}(c=b.booking||(b.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(){function b(a){this.$rootScope=a}return b.$inject=["$rootScope"],b.prototype.todayClick=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CAL_TODAY)},b.prototype.bookIt=function(b,c,d,e,f,g){var h="";1===e.length&&e[0]===OfferedAsType.ONE_TIME?h="single":1===e.length&&e[0]===OfferedAsType.PRICING_PLAN?h="pricing plan":2===e.length&&e.indexOf(OfferedAsType.ONE_TIME)>=0&&e.indexOf(OfferedAsType.PRICING_PLAN)>=0&&(h="both"),this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.BOOKIT,{bookAnotherLogged:f,type:b,service_id:c,is_membership:d,offered_as:h,accept_online_bookings:g})},b.prototype.backButtonPressed=function(b,c){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.BACK,{referralInfo:b,type:c})},b.prototype.bookedGroupButNotPremium=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.BOOKED_GROUP_BUT_NOT_PREMUIM)},b.prototype.googleCalendar=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.GOOGLE_EXPORT)},b.prototype.bookAnother=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.BOOK_ANOTHER)},b.prototype.selectSlot=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CHOOSE_TIME_SLOT)},b.prototype.selectDay=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CHOOSE_DAY)},b.prototype.enterCouponClicked=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.ENTER_COUPON_CLICKED)},b.prototype.applyCouponClicked=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.APPLY_COUPON_CLICKED,{couponStatus:b})},b.prototype.deleteCouponClicked=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.DELETE_COUPON_CLICKED)},b.prototype.cancellationPolicy=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CANCELLATION_POLICY)},b.prototype.appointmentCreated=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.APPOINTMENT_BOOKED,b)},b.prototype.saveSuccessContactInfo=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CONTACT_INFO_SAVE_SUCCESS,{dynamicForm:b})},b.prototype.sendNext=function(b){var c=b.referralInfo,d=b.dynamicForm,e=b.hasCoupons,f=b.isCouponEntered,g=b.errorOnStaff,h=b.smsNotificationRequest,i=void 0===h?!1:h;this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.NEXT,{referralInfo:c,dynamicForm:d,isCouponEntered:f,hasCoupons:e,errorOnStaff:g,smsNotificationRequest:i})},b.prototype.sendNextFailed=function(b){var c=b.referralInfo,d=b.errorReason;this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.NEXT_FAILED,{referralInfo:c,errorReason:d})},b.prototype.logLoadMoreHours=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.LOAD_MORE_HOURS)},b.prototype.logExperimentExposure=function(b){var c=b.testName,d=b.experimentValue,e=b.triggerName,f=b.offeringType;this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.EXPERIMENT_EXPOSURE,{testName:c,experimentValue:d,triggerName:e,offeringType:f})},b.prototype.reportClickNextInPaymentInfo=function(b,c){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.NEXT,{referralInfo:b,mandatoryFieldsList:c})},b.prototype.selectServiceType=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.SERVICE_TYPE_WELCOME_PAGE,b)},b.prototype.viewPricingPlan=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.PRICING_PLAN_VIEW,b)},b.prototype.logDeepLinkPricingPlan=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.DEEP_LINK_PRICING_PLAN)},b.prototype.monthChangeClick=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CAL_MOVE)},b.prototype.servicesPageOpened=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.SERVICES_PAGE_OPENED,b)},b.prototype.staffMemberPopupOpenedFromTimeSlot=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CHOOSE_STAFF_MEMBER_POPUP_OPENED)},b.prototype.staffMemberSelectedFromTimeSlot=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CHOOSE_STAFF_MEMBER)},b.prototype.staffMemberSelectionChangedFromCalendar=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CHANGE_STAFF_MEMBER_SELECTION)},b.prototype.logTimezone=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.LOG_TIMEZONE)},b.prototype.logParticipantsAmountChanged=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.PARTICIPANTS_AMOUNT_CHANGE,b)},b.prototype.logJoinWaitingListCtaClicked=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.JOIN_WAITING_LIST_CLICKED)},b.prototype.logPopupClosed=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.POPUP_CLOSED,b)},b.prototype.timezoneSwitched=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.TIMEZONE_SWITCH,b)},b.prototype.logPopupOpened=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.TIMEZONE_POPUP_OPENED)},b.prototype.logDeepLinkCalendarOpened=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.DEEP_LINK_CALENDAR_OPEN,b)},b.prototype.logLoginClicked=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.LOGIN_CLICKED)},b.prototype.logLoginComplete=function(b){var c=b.success,d=void 0===c?!1:c,e=b.visitorIdAnon;this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.LOGIN_COMPLETE,{success:d,visitorIdAnon:e})},b.prototype.logPostLoginComplete=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.POST_LOGIN_COMPLETE,b)},b.prototype.logGoToAccountManagement=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.GO_TO_ACCOUNT_MANAGEMENT)},b.prototype.logBookingReschedule=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.BOOKING_RESCHEDULE,b)},b.prototype.logBookingRescheduleSuccess=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.BOOKING_RESCHEDULE_SUCCESS,b)},b.prototype.logNavigationFromWidget=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.NAVIGATION_FROM_WIDGET,b)},b.prototype.logBookingCancelClick=function(a){this.logBookingCancel(a,!1)},b.prototype.logBookingCancelConfirm=function(a){this.logBookingCancel(a,!0)},b.prototype.logAccountManagementSectionSelected=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.ACCOUNT_MANAGEMENT_SECTION_SELECTION,{selection:b})},b.prototype.logAccountManagementHeaderBack=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.ACCOUNT_MANAGEMENT_SEE_SERVICES,{referralInfo:b})},b.prototype.logUserInfoSaved=function(b,c){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.USER_INFO_SAVED,{newUserInfo:b,currentUserInfo:c})},b.prototype.logSignoutClicked=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.SIGNOUT_CLICKED)},b.prototype.logEditUserInfoClicked=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.USER_INFO_EDIT_CLICKED)},b.prototype.logBookingCancel=function(b,c){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.BOOKING_CANCEL,{booking:b,confirmation:c})},b.prototype.logShowOfferingDetails=function(b,c){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.SHOW_SERVICE_DETAILS,{referralInfo:b,accept_online_bookings:c})},b.prototype.appointmentBookedValidation=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.APPOINTMENT_BOOKED_VALIDATION,b)},b.prototype.logDoubleBooking=function(b,c,d){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.DOUBLE_BOOKING_HAPPENED,{referralInfo:b,serviceType:c,bookingId:d})},b}();b.VisitorBILogger=c,angular.module("schedulerAngularClientAppInternal").service("visitorBILogger",c)}(c=b.bi||(b.bi={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={})),function(){angular.module("schedulerAngularClientAppConstants").constant("apiConst",{BOOKINGS_WEB_PREFIX:"_api/bookings-web-uou",BOOKINGS_VIEWER_FES:"_api/bookings-viewer",MEMBER_AREA_APP_ID:"14cc59bc-f0b7-15b8-e1c7-89ce41d0e0c9"})}();var StorageConst=function(){function a(){}return a.DEEP_LINK="deepLink",a.SERVICE_TYPE="serviceType",a.SERVICE_ID="serviceId",a}();angular.module("schedulerAngularClientAppConstants").constant("storageConst",StorageConst);var PricingPlanConst=function(){function a(){}return a.PAGE_NOT_INSTALLED="PageNotInstalled",a.NO_PLANS_ASSIGNED_TO_OFFERING="NoPlansAssignedToOffering",a.BOOKING_METHOD_SELECTED="BookingMethodSelected",a}();angular.module("schedulerAngularClientAppConstants").constant("pricingPlanConst",PricingPlanConst);var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.construct=function(a){return function(b){return b&&a.LOCATIONS_WITH_ADDRESS.indexOf(b.location)>-1}},a}();a.RequireAddressFactory=b}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c=a.bookings.common.domain.DEFAULT_TIMEZONE_PROPERTIES,d=function(){function a(a,b,c,d,e){this.visitorApi=a,this.cacheSrv=b,this.$q=c,this.overEditor=d,this.boostInjectionPersister=e}return a.$inject=["visitorApi","cacheSrv","$q","overEditor","boostInjectionPersister"],a.prototype.setBusinessInfo=function(a){return this.cacheSrv.setToCache("businessInfo",this.enrichBusinessInfoWithTimezoneProperties(a))},a.prototype.getBusinessInfo=function(){var a=this.cacheSrv.getFromCache("businessInfo");return this.overEditor.enrichBusinessInfoIfOverEditor(a),a},a.prototype.gettingBusinessInfo=function(){var a=this,b=this.$q.defer(),c=this.getBusinessInfo();return c?b.resolve(c):this.gettingNewBusinessInfo().then(function(c){return a.setBusinessInfo(c),b.resolve(a.overEditor.enrichBusinessInfoIfOverEditor(c))}),b.promise},a.prototype.getBusinessName=function(){var a=this.getBusinessInfo();return a?a.name:""},a.prototype.gettingNewBusinessInfo=function(){var a=this.boostInjectionPersister.getBusinessInfo();return a?this.$q.when(a):this.visitorApi.gettingBusinessInfo()},a.prototype.enrichBusinessInfoWithTimezoneProperties=function(a){return a.timezoneProperties||(a.timezoneProperties=c),a},a}();b.BusinessInfoSrv=d,angular.module("schedulerAngularClientAppInternal").service("businessInfoSrv",d)}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c=a.boost.common.constants.FedopsInteraction,d=function(){function a(a,b,c,d,e,f){this.accountManagementApiSrv=a,this.userManagementSrv=b,this.fedopsLogger=c,this.$wix=d,this.$q=e,this.experimentsEnabler=f}return a.$inject=["accountManagementApiSrv","userManagementSrv","fedopsLogger","$wix","$q","experimentsEnabler"],a.prototype.getAvailablePricingPlan=function(a,b){if(!this.userManagementSrv.isLoggedIn()){var c=this.$q.defer();return c.resolve(),c.promise}return this.experimentsEnabler.isBookingsPackagesEnabled()?this.accountManagementApiSrv.gettingUserPricingPlansForSlot(b,a):this.accountManagementApiSrv.gettingPurchasedPricingPlans(b).then(function(b){var c=b.pricingPlansOrders;return c.find(function(b){return(!b.expiration.hasEndDate||b.end>a)&&b.start<a})})},a.prototype.getPricingPlans=function(a){if(!this.userManagementSrv.isLoggedIn()){var b=this.$q.defer();return b.resolve(),b.promise}return this.accountManagementApiSrv.gettingPurchasedPricingPlans(a).then(function(a){var b=a.pricingPlansOrders;return b.filter(function(a){return!a.expiration.hasEndDate||a.end>moment().valueOf()})})},a.prototype.isPricingPlanInstalled=function(){var a=this;return this.fedopsLogger.interactionStarted(c.MEMBERSHIP_INSTALLED_CHECK),this.$wix.isPricingPlanInstalled().then(function(b){return a.fedopsLogger.interactionEnded(c.MEMBERSHIP_INSTALLED_CHECK),b})},a}();b.MembershipSrv=d,angular.module("schedulerAngularClientAppInternal").service("membershipSrv",d)}(c=b.booking||(b.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){a.PRICING_PLAN_TRANSACTION_ID="PRICE_PLAN_TRANSACTION_ID";var b=function(){function b(a){this.cacheSrv=a}return b.$inject=["cacheSrv"],b.prototype.isTransactionIdsEquals=function(){var a=this.getTransactionIdFromUrl(),b=this.getTransactionIdFromCache();return a&&a===b},b.prototype.getTransactionIdFromUrl=function(){var a=new URLSearchParams(window.location.search);return a.get("transactionId")},b.prototype.getTransactionIdFromCache=function(){return this.cacheSrv.getFromCache(a.PRICING_PLAN_TRANSACTION_ID)},b.prototype.clearTransactionIdFromCache=function(){this.cacheSrv.clearKey(a.PRICING_PLAN_TRANSACTION_ID)},b.prototype.setTransactionId=function(b){this.cacheSrv.setToCache(a.PRICING_PLAN_TRANSACTION_ID,b)},b}();a.TransactionIdSrv=b,angular.module("schedulerAngularClientAppInternal").service("transactionIdSrv",b)}(b=a.booking||(a.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d){this.appointmentService=a,this.membershipSrv=b,this.userManagementSrv=c,this.$q=d}return a.$inject=["appointmentService","membershipSrv","userManagementSrv","$q"],a.prototype.bookableSelected=function(a){var b=this,c=this.$q.defer();return this.userManagementSrv.getCurrentLogInStatus().then(function(d){if(!d)return c.resolve();var e=b.appointmentService.getSelectedOffering();b.membershipSrv.getAvailablePricingPlan(a,e.id).then(function(a){return c.resolve(a)})}),c.promise},a}();a.UserPurchasedPlanSrv=b,angular.module("schedulerAngularClientAppInternal").service("userPurchasedPlanSrv",b)}(b=a.booking||(a.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.visitorApi=a,this.offeringValidationsSrv=b}return a.$inject=["visitorApi","offeringValidationsSrv"],a.prototype.notifyingNonPricingPlanEnrollmentAttempt=function(a){var b=this.offeringValidationsSrv.isOfferingConnectedToPricingPlan(a);return this.visitorApi.notifyingOwnerNonPricingPlanEnrollmentAttempt({offeringId:a.id,isPricingPlanNotInstalled:!a.isPricingPlanAppInstalled,isOfferingNotConnectedToPricingPlan:!b})},a}();a.PricingPlanApiSrv=b,angular.module("schedulerAngularClientAppInternal").service("pricingPlanApiSrv",b)}(b=a.services||(a.services={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.fromDto=function(a,b){return a?new c(a,b):null},a}();a.PurchasedPricingPlanFactory=b;var c=function(){function a(a,b){this.dto=a,this.timezone=b,this.startDate=this.createMomentFromTime(+a.start),this.endDate=a.end?this.createMomentFromTime(+a.end):void 0}return Object.defineProperty(a.prototype,"type",{get:function(){return this.dto.type},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"name",{get:function(){return this.dto.name},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"pricingPlanId",{get:function(){return this.dto.pricingPlanId},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"start",{get:function(){return this.startDate},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"end",{get:function(){return this.endDate},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"sessions",{get:function(){return this.dto.sessions},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"remains",{get:function(){return this.dto.remains},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"hasExpirationDate",{get:function(){return this.dto.expiration?this.dto.expiration.hasEndDate:!0},enumerable:!0,configurable:!0}),a.prototype.createMomentFromTime=function(a){return this.timezone?moment.tz(a,this.timezone):moment(a)},a}();a.PurchasedPricingPlan=c}(b=a.booking||(a.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d){this.$wix=a,this.visitorBILogger=b,this.$translate=c,this.transactionIdSrv=d}return a.$inject=["$wix","visitorBILogger","$translate","transactionIdSrv"],a.prototype.navigate=function(b){return __awaiter(this,void 0,void 0,function(){var c,d,e,f;return __generator(this,function(g){switch(g.label){case 0:return[4,this.$wix.isBookingsSplitted()];case 1:return c=g.sent(),d=c?"book_checkout":"scheduler",e={appDefinitionId:a.BOOKINGS_APP_DEF_ID,sectionId:d},this.setTransactionStarted(e),f=this.extractedPlansId(b),this.visitorBILogger.viewPricingPlan(b.length),this.$wix.Utils.navigateToSection({sectionId:a.PRICING_PLAN_SECTION_ID,appDefinitionId:a.PRICING_PLAN_APP_DEF_ID,queryParams:{planIds:f,navigateToSectionProps:btoa(JSON.stringify(e)),verticalStatusContent:this.encode(JSON.stringify({titleText:this.$translate("pricing-plan-tpa.title-page"),buttonText:this.$translate("pricing-plan-tpa.cta")}))}}),[2]}})})},a.prototype.encode=function(a){return btoa(encodeURIComponent(a).replace(/%[0-9A-F]{2}/g,this.percentToByte))},a.prototype.percentToByte=function(a){return String.fromCharCode(parseInt(a.slice(1),16))},a.prototype.setTransactionStarted=function(a){var b=(new Date).getTime().toString();this.transactionIdSrv.setTransactionId(b),a.queryParams={transactionId:b}},a.prototype.extractedPlansId=function(a){return a.map(function(a){return a.id}).join(",")},a.PRICING_PLAN_SECTION_ID="membership_plan_picker_tpa",a.PRICING_PLAN_APP_DEF_ID="1522827f-c56c-a5c9-2ac9-00f9e6ae12d3",a.BOOKINGS_APP_DEF_ID="13d21c63-b5ec-5912-8397-c3a5ddb27a97",a}();a.PricingPlanTPANavigator=b,angular.module("schedulerAngularClientAppInternal").service("pricingPlanTPANavigator",b)}(b=a.booking||(a.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h};!function(){function a(a,b,c,d,e){function f(a){return void 0===a&&(a=!1),a?b.BOOKINGS_WEB_PREFIX:b.BOOKINGS_VIEWER_FES}var g=this;this.gettingBusinessInfo=c.httpWrapper(function(){return a.get(f()+"/visitor/business/")}),this.updatingLanguage=c.httpWrapper(function(b){return a.put(f()+"/owner/business/language",b)}),this.notifyingNonPremiumEnrollmentAttempt=c.httpWrapper(function(){return a.post(f()+"/visitor/classes/nonPremium","")}),this.notifyingOwnerNonPricingPlanEnrollmentAttempt=c.httpWrapper(function(b){var c=b.offeringId,e=b.isPricingPlanNotInstalled,g=b.isOfferingNotConnectedToPricingPlan,h=[];return e&&h.push(d.PAGE_NOT_INSTALLED),g&&h.push(d.NO_PLANS_ASSIGNED_TO_OFFERING),a.post(f()+"/visitor/pricing-plans/invalidSetup",{offeringId:c,reasons:h})}),this.gettingGroupsInstances=c.httpWrapper(function(b){var c=b.dateRange,d=b.id,g=c.start.valueOf(),h=c.end.valueOf(),i=e.isViewerWaitlistModalEnabled()?"?waitingList=true":"";return a.get(f()+"/visitor/classes/inst/"+d+"/"+g+"/"+h+i)}),this.getFirstAvailableSlotForIndividualService=c.httpWrapper(function(b){var c=b.timezone.name,d=b.serviceId;return a.get(f()+"/visitor/slots/nextAvailable/"+d+"?tz="+c)}),this.getFirstAvailableSlotForGroupPrototype=c.httpWrapper(function(b){var c=b.groupProtoId;return a.get(f()+"/visitor/classes/inst/nextAvailable/"+c)}),this.gettingStaffMembers=c.httpWrapper(function(){return a.get(f()+"/visitor/staff/")}),this.getAvailableSlotsForIndividualService=c.httpWrapper(function(b){var c=b.range.start.valueOf(),d=b.range.end.valueOf(),e=b.timeZone,g=b.serviceId,h=b.nextPageToken?"&nextPageToken="+b.nextPageToken:"";return a.get(f()+"/visitor/staff/slots/"+g+"/"+c+"/"+d+"?tz="+e+h)}),this.isCashierConnected=function(){return __awaiter(g,void 0,void 0,function(){var b;return __generator(this,function(c){switch(c.label){case 0:return[4,a.get(f()+"/visitor/payments/status/")];case 1:return b=c.sent().data,[2,b.cashier]}})})},this.isMemberAreaInstalled=c.httpWrapper(function(){return a.get(f()+"/visitor/appInstalled/"+b.MEMBER_AREA_APP_ID)})}a.$inject=["$http","apiConst","commonApiBase","pricingPlanConst","experimentsEnabler"],angular.module("schedulerAngularClientCommon").service("visitorApi",a)}();var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.boostInjectionPersister=a}return a.$inject=["boostInjectionPersister"],a.prototype.findInjectedDeepLink=function(){var a=this.boostInjectionPersister.getSession();return a.classInstance&&(a.classInstance.isFull=a.classInstance.registered>=a.classInstance.capacity),a},a}();a.SessionFinderSrv=b,angular.module("schedulerAngularClientAppInternal").service("sessionFinderSrv",b)}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.boostInjectionPersister=a}return a.$inject=["boostInjectionPersister"],a.prototype.findInjectedDeepLink=function(){return __awaiter(this,void 0,void 0,function(){var a,b;return __generator(this,function(){return a=this.boostInjectionPersister.getPricingPlan(),b=function(a){return a?moment(a).valueOf():void 0},[2,a?{name:a.name,type:a.type,pricingPlanId:a.id,start:b(a.validFrom),end:b(a.validUntil),expiration:{hasEndDate:!!a.validUntil},sessions:a.totalSessions,remains:a.remainingSessions}:void 0]})})},a}();a.PricingPlanFinderSrv=b,angular.module("schedulerAngularClientAppInternal").service("pricingPlanFinderSrv",b)}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var VisitorTimezoneSrv=function(){function a(a,b,c,d,e,f){this.$q=a,this.momentSrv=b,this.timezoneSrv=c,this.businessInfoSrv=d,this.$translate=e,this.appointmentService=f}return a.$inject=["$q","momentSrv","timezoneSrv","businessInfoSrv","$translate","appointmentService"],a.prototype.isBusinessTimezoneEqualToVisitorTimezone=function(a,b){return this.isTimezoneEqual(a,b)?!0:this.isStandardOffsetEqual(a,b)&&this.isCurrentOffsetEqual(a,b)?!0:!1},a.prototype.gettingUserTimezoneNote=function(a){var b=this;return void 0===a&&(a="visitor"),this.$q.all([this.businessInfoSrv.gettingBusinessInfo(),this.timezoneSrv.gettingUserTimezone(),this.appointmentService.getSelectedTime()]).then(function(c){var d=c[0].timeZone,e=c[1].name,f=c[2];if(e!==d){var g=b.getTimezoneToShow(a,d,e,f),h=b.momentSrv.timestampToLocaleMoment(moment().valueOf(),g).format("Z");return b.$translate("calendar.displayed-time-timezone-formatted",{offset:h})}return""})},a.prototype.getTimezoneToShow=function(a,b,c,d){return d&&d.timeZone?d.timeZone:"business"===a?b:c},a.prototype.isTimezoneEqual=function(a,b){return a.name===b.name},a.prototype.isStandardOffsetEqual=function(a,b){return a.standardOffset===b.standardOffset},a.prototype.isCurrentOffsetEqual=function(a,b){return a.offset===b.offset},a}();angular.module("schedulerAngularClientAppInternal").service("visitorTimezoneSrv",VisitorTimezoneSrv);var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.cache={}}return a.prototype.getFromCache=function(a){return this.cache[a]},a.prototype.setToCache=function(a,b){this.cache[a]=b},a.prototype.clearKey=function(a){this.cache[a]=void 0},a.prototype.clearCache=function(){this.cache={}},a}(),c=function(){function a(a){this.$window=a}return a.$inject=["$window"],a.prototype.isWebStorageSupported=function(){try{var a="SessionStorageCacheSrvTestKey";this.$window.sessionStorage.setItem(a,"OK");var b=this.$window.sessionStorage.getItem(a);return this.$window.sessionStorage.removeItem(a),"OK"===b}catch(c){return!1}},a.prototype.getFromCache=function(a){return this.$window.sessionStorage.getItem(a)},a.prototype.setToCache=function(a,b){this.$window.sessionStorage.setItem(a,b)},a.prototype.clearKey=function(a){this.$window.sessionStorage.removeItem(a)},a.prototype.clearCache=function(){this.$window.sessionStorage.clear()},a}(),d=function(){function a(a,b,c){this.$wix=a,this.stringsCache=b.isWebStorageSupported()?b:c}return a.$inject=["$wix","sessionStorageCacheSrv","inMemoryCacheSrv"],a.prototype.getCacheKey=function(a){return a+"_"+this.$wix.getBusinessId()},a.prototype.getFromCache=function(a){var b=this.stringsCache.getFromCache(this.getCacheKey(a));return angular.fromJson(b)},a.prototype.setToCache=function(a,b){"undefined"!=typeof b&&this.stringsCache.setToCache(this.getCacheKey(a),angular.toJson(b))},a.prototype.clearKey=function(a){this.stringsCache.clearKey(this.getCacheKey(a))},a.prototype.clearCache=function(){this.stringsCache.clearCache()},a}();a.CacheSrv=d,angular.module("schedulerAngularClientCommon").service("cacheSrv",d).service("inMemoryCacheSrv",b).service("sessionStorageCacheSrv",c)}(b=a.utils||(a.utils={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var scheduler;!function(a){var b;!function(a){function b(a){function b(b,c,d){var e=a.getTextForModel(c+"_Checkbox");return"false"===e?"":d?a.getTextForModel(c,"")||a.getTextForModel(d,b):a.getTextForModel(c,b)}return b.$stateful=!0,b}b.$inject=["wixSdkUtil"],a.wixSdkTranslate=b,angular.module("wixSdkUtilInternal").filter("wixSdkTranslate",b)}(b=a.filter||(a.filter={}))}(scheduler||(scheduler={})),function(){function a(a){return{restrict:"A",link:function(b,c){function d(a){c.css({top:a})}function e(){a.addEventListener(a.Events.SCROLL,h),b.$on("$destroy",function(){a.removeEventListener(a.Events.SCROLL,h)}),f()}function f(){var a=b.$watch(function(){c.parent().find(".sticky-sibling").outerHeight(c.outerHeight())});b.$on("$destroy",function(){a()})}function g(a){var b=a.rect.top,d=c.outerHeight();return 0>b?Math.min(-b,a.rect.height-d-c.parent().offset().top):0}function h(){a.getBoundingRectAndOffsets(function(a){d(g(a))})}function i(){c.css({position:"absolute"}).addClass("sticky"),c.parent().css({position:"relative"}).addClass("sticky__container"),c.parent().append('<div class="sticky-sibling"></div>'),d(0)}i(),e()}}}a.$inject=["$wix"],angular.module("schedulerAngularClientAppInternal").directive("bksViewerSticky",a)}();var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.PRICING_PLAN="pricePlan",a.CUSTOM_PAYMENT="customPayment",a.PAYMENT_WITH_DISCOUNT_ALLOW="paymentWithDiscountAllow",a}();a.PaymentTypes=b;var c=function(){function a(a,b,c){var d={allowedActions:{},numOfParticipants:1};Object.assign(this,d,a),this.offeringDetails=Object.assign({parentOfferingId:a.parentOfferingId},c),this.staffMemberDetails=b}return a}();a.AccountBooking=c}(b=a.bookings||(a.bookings={}))}(b=a.account||(a.account={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.bookings.account.bookings.PaymentTypes;b.getFractionDigitsForPrice=function(a){return 0===a%1?0:2};var d=function(){function a(){}return a.fromDto=function(a){if(a)switch(a.type){case c.PRICING_PLAN:return new h(a);case c.CUSTOM_PAYMENT:return new g(a);case c.PAYMENT_WITH_DISCOUNT_ALLOW:return new f(a)}return null},a}();b.PaymentFactory=d;var e=function(){function a(a){this.dto=a}return a.prototype.toDto=function(){return this.dto},Object.defineProperty(a.prototype,"type",{get:function(){return this.dto.type},enumerable:!0,configurable:!0}),a
}();b.Payment=e;var f=function(b){function c(a){var c=b.call(this,a)||this;return c.dto=a,c}return __extends(c,b),Object.defineProperty(c.prototype,"currency",{get:function(){return this.dto.currency},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"paid",{get:function(){return this.dto.paid},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"price",{get:function(){return this.dto.price},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"priceAfterDiscount",{get:function(){return this.dto.priceAfterDiscount},enumerable:!0,configurable:!0}),c.prototype.getFormattedPrice=function(b){return b(this.priceAfterDiscount,this.currency,a.bookings.visitor.payments.getFractionDigitsForPrice(this.priceAfterDiscount))},c}(e);b.PaymentWithDiscountAllow=f;var g=function(a){function b(b){var c=a.call(this,b)||this;return c.dto=b,c}return __extends(b,a),Object.defineProperty(b.prototype,"priceText",{get:function(){return this.dto.priceText},enumerable:!0,configurable:!0}),b.prototype.getFormattedPrice=function(){return this.priceText},b}(e);b.CustomPayment=g;var h=function(a){function b(b){var c=a.call(this,b)||this;return c.dto=b,c}return __extends(b,a),Object.defineProperty(b.prototype,"planName",{get:function(){return this.dto.planName},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"planType",{get:function(){return this.dto.isLimited?"LIMITED":"UNLIMITED"},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"planRemaining",{get:function(){return this.dto.remaining},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"planTotal",{get:function(){return this.dto.total},enumerable:!0,configurable:!0}),b.prototype.getFormattedPrice=function(){return this.planName},b}(e);b.PricingPlanPayment=h}(c=b.payments||(b.payments={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var StaffMemberDtoBuilder=wix.bookings.visitor.staff.StaffMemberDtoBuilder,OfferingCategoryDtoBuilder=wix.bookings.visitor.offerings.OfferingCategoryDtoBuilder,IndividualOfferingDtoBuilder=wix.bookings.visitor.offerings.IndividualOfferingDtoBuilder,BookingsLocalizationSrv=wix.bookings.visitor.localization.BookingsLocalizationSrv,OfferingType=WixBookingsUoUDomain.OfferingType,OfferedAsType=WixBookingsUoUDomain.OfferedAsType;!function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function r(){return new Array(3).fill(null).map(function(a,c){return(new OfferingCategoryDtoBuilder).withCategoryId("cat_id_"+(c+1)).withOrder(c).withName(b("category-name-editor-"+(c+1))).build()})}function s(){var a=function(){return"offering-id-"+Math.random()};return{sun:null,mon:{workingHours:[{id:a(),workingHour:{startTime:"8:00",endTime:"9:00"},staffId:null},{id:a(),workingHour:{startTime:"14:00",endTime:"15:00"},staffId:null}]},tue:null,wed:{workingHours:[{id:a(),workingHour:{startTime:"9:00",endTime:"10:00"},staffId:null},{id:a(),workingHour:{startTime:"16:00",endTime:"17:00"},staffId:null}]},thu:null,fri:{workingHours:[{id:a(),workingHour:{startTime:"14:00",endTime:"15:00"},staffId:null},{id:a(),workingHour:{startTime:"16:00",endTime:"17:00"},staffId:null}]},sat:null}}var t=this,u=this;u.REDIRECT_TO_PAGE_WHEN_NAVIGATING_AWAY="default-page";try{this.isOverEditor=a.isOverEditor()}catch(v){this.isOverEditor=!1}try{this.isInEditingMode=a.isInEditingMode()}catch(v){this.isInEditingMode=!1}try{this.isInTemplateMode=!!a.isInTemplateMode()}catch(v){this.isInTemplateMode=!1}try{this.isDemoMode=a.Utils.getDemoMode()}catch(v){this.isDemoMode=!1}this.isDemoFlow=this.isDemoMode||this.isOverEditor||this.isInTemplateMode;var w=new Array(3).fill(null).map(function(a,c){return(new StaffMemberDtoBuilder).withId("dummy-staff-"+(c+1)).withName(b("over-editor.staff-name-"+(c+1))).build()});this.enrichStaffIfOverEditor=function(a){this.isOverEditor&&!a.staff.length&&(a.staff=w)},this.isDummyService=function(a){return this.isOverEditor&&(!a||!a.id||a.dummy)},this.enrichOfferingIfOverEditor=function(a){return this.isOverEditor&&!a?{name:b("service-name-editor-selected"),duration:parseInt(b("service-duration-editor"),10),price:parseInt(b("service-price-editor"),10),currency:b("service-currency-editor"),description:b("service-description-editor"),classHours:s(),capacity:5,dummy:!0,type:OfferingType.GROUP,location:"CUSTOMER",maxParticipantsPerOrder:1,urlName:"offering-id-0",tagLine:b("service-tagline-editor"),offeredAs:[OfferedAsType.ONE_TIME],images:j.imagesList[0].images,startDate:moment().add(7,"days").format("YYYY-MM-DD"),endDate:moment().add(1,"years").format("YYYY-MM-DD")}:a},this.enrichBookingPaymentIfOverEditor=function(a){return this.isOverEditor&&!a?{currency:b("service-currency-editor"),paid:0,price:+b("service-price-editor"),priceAfterDiscount:+b("service-price-editor"),type:"paymentWithDiscountAllow"}:a},this.enrichBusinessInfoIfOverEditor=function(a){if(this.isOverEditor){var c=a;return c&&!c.name&&(c.name=b("over-editor.mock-business-name"),c.address=b("over-editor.mock-business-address"),c.formattedAddress=b("over-editor.mock-business-address"),c.phone="null"!==c.phone&&c.phone||b("over-editor.mock-contact.phone"),c.email=c.email||b("over-editor.mock-contact.email")),c}return a},this.enrichSelectedTimeIfOverEditor=function(a){var b=a;if(this.isOverEditor){if(!b){var c=e.moment().hour(12).minutes(0).seconds(0),d=e.moment().hour(12).minutes(45).seconds(0);b={startTime:""+c.valueOf(),endTime:""+d.valueOf()}}b.groupInstance||(b.groupInstance={dummy:!0,id:"id_0"})}return b},this.fillContactIfOverEditor=function(a){return this.isOverEditor&&!a?{name:"",email:"",phone:"",address:{addressLine:"",aptOrFloor:"",city:""}}:a},this.getClassesInstancesIfOverEditor=function(a,c){var d=[];if(this.isOverEditor){var e=c.staff.length?c.staff:w;0===e.length&&e.push({});for(var f=a.start,g=0;25>g;g++){var h=g%5+g%2;h=5===h?1:h;for(var i=0;i<e.length;i++){var j={id:"id_"+g,capacity:5,classProtoId:g,registered:g%7,teacher:b("group-teacher-editor"),staffMemberId:e[i].id,start:q.getStartOfWeekForLocale(f.clone()).add(h,"day").hour(g%12+6).valueOf(),end:q.getStartOfWeekForLocale(f.clone()).add(h,"day").hour(g%12+7).valueOf(),dummy:!0};d.push(j)}}}return{classesInstances:d}},this.getFirstAvailableSlotForService=function(){return e.moment()};var x=function(a,c){return void 0===c&&(c=r()),(new IndividualOfferingDtoBuilder).withId("offering-id-"+a).withName(b("service-name-editor-"+(a%3+1))).withDescription(b("service-description-editor")).withDuration(+b("service-duration-editor")).withUrlName("individual-offering-id-"+a).withDummyIndication().withCategoryId(c[Math.floor(a/c.length)].id).withPrice({price:+b("service-price-editor"),currency:b("service-currency-editor")}).withImages(j.imagesList[a].images).build()};if(this.enrichOfferingListIfOverEditor=function(a){if(!t.isOverEditor||a&&0!==a.offerings.length)return a;var b=9,c=r(),d=new Array(b).fill(null).map(function(a,b){return x(b,c)});return{dummy:!0,offerings:d,categories:c}},this.enrichOfferingDetailsIfOverEditor=function(a){return t.isOverEditor&&!a?x(0):a},this.getSlotsAvailability=function(a,b,c,d){for(var f={},g=e.moment.tz(a.start,b).startOf("month"),h=g.clone(),i=c.staff.length?c.staff:w,j=0;d>j;j++){var k=f[""+g.valueOf()]=[],l=[];if(0===j%3){for(var m=0;m<i.length;m++)k.push({staffId:i[m].id,slots:l});for(var n=0;40>n;n++)h.add(30,"minutes"),l.push(h.valueOf());h.startOf("day")}g.add(1,"days"),h=g.clone()}return f},this.isEditModeAndNotVisitedOwner=function(){return!l.isVisitedOwner()&&this.isInEditingMode},this.isPreviewMode=function(){return"preview"===a.Utils.getViewMode()},this.isOverEditor){var y=function(a){p.setRedirectRequired(a),f.location.reload()};a.addEventListener(a.Events.EDIT_MODE_CHANGE,function(a){"preview"===a.editMode&&f.location.reload()}),a.addEventListener(a.Events.SETTINGS_UPDATED,function(a){i(function(){var b=d.getTextForModel("previewPage");a===g.PREVIEW_UPDATE?m.path().endsWith(b)||c.replacePage(b):a===g.OWNER_OVER_EDITOR_CHANGE?(h.clearCache(),y(b)):(a===g.LANGUAGE_CHANGE||a===g.LAYOUT_CHANGE)&&y(b)},150)}),angular.element(f).bind("load resize",function(){o.height=-1,n.$digest()})}}a.$inject=["$wix","$translate","routeManager","wixSdkUtil","libs","$window","eventsConst","cacheSrv","$timeout","SERVICE_EDITOR_DEFAULTS","GROUP_EDITOR_DEFAULTS","entryPointsIndicator","$location","$rootScope","wixHeightWatcher","overEditorNavigationSrv","bookingsLocalizationSrv"],angular.module("schedulerAngularClientAppInternal").service("overEditor",a)}();var wix;!function(a){var b;!function(a){var b;!function(a){var b=DataCapsuleTools.LocalStorageStrategy,c=DataCapsuleTools.DataCapsule,d=function(){function a(a,d,e,f,g){if(this.$wix=a,this.environmentStorage=d,this.experimentsEnabler=e,this.$q=f,this.deviceType=a.Utils.getDeviceType(),this.isMobile="mobile"===this.deviceType.toLowerCase(),this.capsule=new c({strategy:new b,namespace:"bookings-"+a.getInstanceId()}),g.isDemoFlow)try{this.capsule.setItem("owner-visited",!0)}catch(h){}}return a.$inject=["$wix","environmentStorage","experimentsEnabler","$q","overEditor"],a.prototype.getIsMobile=function(){return this.isMobile},a.prototype.getIsOwner=function(){var a=this.$q.defer();return this.capsule.getItem("owner-visited").then(function(b){a.resolve(b)}).catch(function(){a.resolve(!1)}),a.promise},a.prototype.clearOwnerIndication=function(){this.capsule.removeItem("owner-visited")},a}();a.AppConfig=d,angular.module("schedulerAngularClientAppInternal").service("appConfig",d)}(b=a.services||(a.services={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.appSettings=a,this.SERVICE_CATEGORY_LAYOUT=b,this.columnsAmountToClass={1:"service--single",2:"service--even",3:"service--odd"}}return a.prototype.mapColumnsAmountToClass=function(){return this.columnsAmountToClass[this.columnsAmount]},a.prototype.getTileSize=function(){return this.getCategoryPlacement()===this.SERVICE_CATEGORY_LAYOUT.VERTICAL&&1===this.columnsAmount||this.columnsAmount>2?"small":"large"},a.prototype.getCategoryPlacement=function(){},a}();a.ServicesList=b}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(){var a=function(){function a(){}return a.prototype.categoryChanged=function(a){this.selectedCategoryId=a,this.callbackFunc(a)},a.prototype.isCategorySelected=function(a){return this.selectedCategoryId===a},a.prototype.accessibilityFocusCategoryIndex=function(a){return this.isCategorySelected(a)?0:-1},a}();!function(){function b(){return{scope:{callbackFunc:"=onChangeCategoryCallback",categories:"=",selectedCategoryId:"@",type:"@"},templateUrl:"modules/visitor/services/services-categories-list.preload.html",restrict:"E",controller:"CategoryListController",controllerAs:"$ctrl",bindToController:!0}}angular.module("schedulerAngularClientAppInternal").controller("CategoryListController",a).directive("boostCategoryList",b)}()}(b=a.components||(a.components={}))}(b=a.common||(a.common={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(){angular.module("schedulerAngularClientAppInternal").directive("boostServiceTile",["$timeout",function(a){return{scope:{service:"=",size:"@",template:"@",serviceDays:"=",fullServiceDays:"=",tileConfig:"=config",buttonText:"@",customClass:"@",learnMoreSeoUrl:"@"},controller:"serviceTileController",controllerAs:"stCtrl",template:"<ng-include style=\"width:100%\" src=\"'modules/service-tile/'+stCtrl.template+'/service-'+stCtrl.template+'.preload.html'\"/>",bindToController:!0,transclude:!0,restrict:"EA",link:function(b,c){a(function(){var a=c.find(".mCustomScrollBox");a.on("focus",function(){a.mouseover(),a.addClass("focus")}),a.on("focusout",function(){a.mouseleave(),a.removeClass("focus")})},100)}}}])}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g){var h=a.call(this,b,e)||this;return h.$scope=c,h.TILE_LIST_EVENTS=d,h.wixBiLogger=f,h.experimentsEnabler=g,h.showDescriptionContainer=!1,h}return __extends(b,a),b.$inject=["TILE_IMAGE_SHAPE","$scope","TILE_LIST_EVENTS","commonServices","wixBiLogger","experimentsEnabler"],b.prototype.getImageUrl=function(){return a.prototype.getImageUrl.call(this,this.service.images,this.tileConfig.imageSize)},b.prototype.onLearnMore=function(a){this.moreDetails(a,"learn-more")},b.prototype.onHeidiLearnMore=function(a){this.moreDetails(a,"description")},b.prototype.onDescriptionClick=function(a){this.moreDetails(a,"description")},b.prototype.onImageClick=function(a){this.moreDetails(a,"image")},b.prototype.onShowDetails=function(a){this.moreDetails(a,"service-title")},b.prototype.moreDetails=function(a,b){a&&a.stopImmediatePropagation(),this.$scope.$emit(this.TILE_LIST_EVENTS.TILE_SHOW_DETAILS,this.service,b)},b.prototype.selectTile=function(a){a&&a.stopImmediatePropagation(),this.$scope.$emit(this.TILE_LIST_EVENTS.TILE_SELECTED,this.service)},b.prototype.logShowMore=function(){this.wixBiLogger.log(this.wixBiLogger.events.MORE,{service_id:this.service.id})},b.prototype.toggleDescription=function(a){this.service.description?this.showDescriptionContainer=!this.showDescriptionContainer:this.onShowDetails(a)},b.prototype.applyChanges=function(){return this.$scope.$apply()},b.prototype.mouseover=function(){this.service.description&&(this.service.showFullText=!0)},b.prototype.mouseleave=function(){this.service.description&&(this.service.showFullText=!1)},b}(a.BaseTileController);a.ServiceTileController=b,angular.module("schedulerAngularClientAppInternal").controller("serviceTileController",b)}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var Description=function(){function a(){}return a.prototype.$onInit=function(){this.description||(this.description=""),this.showLearnMore=!!this.description&&this.description.length>0},a}();angular.module("schedulerAngularClientAppInternal").component("bksTileDescription",{template:'<span class="tile-description">\n                <span data-hook="description"\n                        ng-click="$ctrl.descriptionClickCallback(); $event.preventDefault();">{{ $ctrl.description | textShortener:$ctrl.maxChar }}</span>\n                        <a data-hook="learn-more"\n                          ng-if="$ctrl.showLearnMore"\n                          ng-click="$ctrl.learnMoreCallback(); $event.preventDefault();"\n                          ng-href="{{$ctrl.learnMoreSeoUrl}}"\n                          target="_blank"\n                          class="tile-description--learn-more">{{\'service-tile.learn-more\' | translate}}</a>\n               </span>',controller:Description,bindings:{description:"@",learnMoreSeoUrl:"@",maxChar:"=",learnMoreCallback:"&",descriptionClickCallback:"&"}}).filter("textShortener",function(){return function(a,b){var c=a.substr(0,b),d=c.substr(0,c.lastIndexOf(" "));return!b||a.length<=b?a:d+"..."}});var wix;!function(a){var b;!function(b){var c;!function(b){var c=a.bookings.common.domain.BusinessInfo,d=WixBookingsUoUDomain.OfferingType,e=function(){function a(a){this.provider=a}return a.$inject=["provider"],a.prototype.getBusinessInfo=function(){return this.provider.businessInfo?new c(this.provider.businessInfo):null},a.prototype.getStaff=function(){return this.provider.staff},a.prototype.getCurrentMember=function(){return this.provider.currentMember},a.prototype.getOfferingId=function(){return this.provider.offeringId},a.prototype.getOfferingsList=function(){return this.provider.offeringsList},a.prototype.isSpecificOfferingRequested=function(){return this.provider.isSpecificOfferingRequested},a.prototype.isSpecificSessionRequested=function(){return!!this.provider.selectedSession},a.prototype.getOfferingsCount=function(){return this.provider.getOfferingsCount()},a.prototype.getFlowStep=function(){return this.provider.flowStep},a.prototype.getSession=function(){return this.provider.selectedSession},a.prototype.getPricingPlan=function(){return this.provider.selectedPurchasedPricingPlan},a.prototype.getRegionalSettingsLocale=function(){return this.provider.regionalSettingsLocale},a.prototype.getMomentLocale=function(){return this.provider.momentLocale},a}();b.BoostInjectionPersister=e;var f=function(){function a(){this.offeringId=null}return a.prototype.setBusinessInfo=function(a){this.businessInfo=this.safeReadInjectedAttribute(a)},a.prototype.setStaff=function(a){this.staff=this.safeReadInjectedAttribute(a)},a.prototype.setCurrentMember=function(a){this.currentMember=this.safeReadInjectedAttribute(a,{})},a.prototype.setOfferingId=function(a){this.offeringId=this.safeReadInjectedAttribute(a)},a.prototype.setOfferingsList=function(a){this.offeringsList=this.safeReadInjectedAttribute(a)},a.prototype.setRegionalSettingsLocale=function(a){this.regionalSettingsLocale=a},a.prototype.setMomentLocale=function(a){this.momentLocale=a},a.prototype.setSpecificOfferingRequested=function(a){this.isSpecificOfferingRequested=this.safeReadInjectedAttribute(a)},a.prototype.setSelectedSession=function(a){this.selectedSession=this.safeReadInjectedAttribute(a)},a.prototype.setSelectedPlan=function(a){this.selectedPurchasedPricingPlan=this.safeReadInjectedAttribute(a)},a.prototype.setFlowStep=function(a){this.flowStep=a},a.prototype.getOfferingsCount=function(){var a,b={groups:0,individual:0,courses:0,tours:0},c=(a={},a[d.COURSE]="courses",a[d.TOUR]="tours",a[d.INDIVIDUAL]="individual",a[d.GROUP]="groups",a);return this.offeringsList?this.offeringsList.offerings.reduce(function(a,b){return a[c[b.type]]+=1,a},b):b},a.prototype.safeReadInjectedAttribute=function(a,b){void 0===b&&(b=null);try{return angular.fromJson(a)}catch(c){return console.warn("Missing injection from Bookings server",a),b}},a.prototype.$get=function(a){return a.instantiate(e,{provider:this})},a.prototype.$get.$inject=["$injector"],a}();b.BoostInjectionPersisterProvider=f,angular.module("schedulerAngularClientAppInternal").provider("boostInjectionPersister",f)}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c=function(){function a(a,b,c,d,e,f){this.openModal=a,this.$wix=b,this.urlUtilSrv=c,this.$window=d,this.scrollToElementSrv=e,this.$translate=f}return a.$inject=["openModal","$wix","urlUtilSrv","$window","scrollToElementSrv","$translate"],a.prototype.openDetails=function(a){return a.animation=!0,this.openModal(a)},a.prototype.openLoginOutsideSite=function(){this.openNotificationModal(this.$translate("user-management.login-not-in-site.message"),this.$translate("user-management.login-not-in-site.confirm"))},a.prototype.openOwnerIsLoggedIn=function(){this.openNotificationModal(this.$translate("user-management.owner-logged-in.message"),this.$translate("user-management.owner-logged-in.confirm"))},a.prototype.openNonBookableOfferingSelected=function(a){this.openNotificationModal(this.$translate(a),this.$translate("user-management.owner-logged-in.confirm"))},a.prototype.openSuccessMessage=function(a){return this.openDetails({windowClass:"modal--success-message-modal",backdropClass:"modal--success-message-backdrop",template:'<div data-hook="success-message-modal" class="success-message-modal">\n                    <div class="success-message-modal__content">\n                        <div data-hook="success-message-modal-close" \n                             class="success-message-modal__close scheduler-svg-font-icons-close"\n                             ng-click="$ctrl.dismiss()"></div>\n                        <div data-hook="success-message-modal-icon"\n                             class="success-message-modal__icon scheduler-svg-font-icons-confirmation-v"></div>\n                        <div data-hook="success-message-modal-message"\n                             class="success-message-modal__message">'+a+"</div>\n                    </div>\n                  </div>",controller:["$scope",function(a){this.dismiss=a.$dismiss}],controllerAs:"$ctrl"})},a.prototype.openNotificationModal=function(a,b){var c=this;this.openDetails({windowClass:"modal--notification-modal",template:'<bks-notification-modal dismiss="$ctrl.dismiss()"\n                                           confirm="$ctrl.dismiss()"\n                                           ok-label="{{$ctrl.okLabel}}"\n                                           >'+a+"</bks-notification-modal>",controller:["$scope",function(a){this.dismiss=a.$dismiss,this.close=a.$close,this.okLabel=b}],controllerAs:"$ctrl"}).then(function(){c.scrollToElementSrv.scroll("bks-notification-modal",100)})},a}();b.Modal=c,angular.module("schedulerAngularClientAppInternal").service("modal",a.boost.services.Modal)}(c=b.services||(b.services={}))}(b=a.boost||(a.boost={}))}(wix||(wix={})),angular.module("schedulerAngularClientBootstrap").run(["$templateCache",function(a){a.put("template/datepicker/day.html",'<div>\n      <table class="table-navigations" role="presentation">\n        <thead>\n         <tr>\n           <th role="presentation" tabindex="0">\n            <button type="button"\n                    aria-label="{{\'calendar.prev-aria\' | translate}}"\n                    class="btn btn-default btn-sm pull-left"\n                    ng-keydown="onMonthSwitchKeyDown($event)"\n                    ng-click="move(-1)"\n                    tabindex="-1">\n                <i class="glyphicon glyphicon-chevron-left"></i>\n            </button>\n           </th>\n           <th colspan="{{5 + showWeeks}}" role="presentation" tabindex="0">\n            <button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="0" style="width:100%;">\n                <strong>{{title}}</strong>\n            </button>\n           </th>\n           <th role="presentation" tabindex="0">\n            <button type="button"\n                    aria-label="{{\'calendar.next-aria\' | translate}}"\n                    class="btn btn-default btn-sm pull-right"\n                    ng-click="move(1)"\n                    ng-keydown="onMonthSwitchKeyDown($event)"\n                    tabindex="-1">\n                <i class="glyphicon glyphicon-chevron-right"></i>\n            </button>\n           </th>\n         </tr>\n         <tr>\n           <th ng-show="showWeeks" class="text-center" role="presentation" aria-hidden="true"></th>\n           <th ng-repeat="label in labels track by $index" class="text-center" aria-hidden="true" tabindex="-1">\n            <small aria-label="{{label.full}}">{{label.abbr}}</small>\n           </th>\n         </tr>\n       </thead>\n       <tbody>\n         <tr ng-repeat="row in rows track by $index" role="presentation">\n           <td ng-show="showWeeks" class="text-center h6" role="presentation"><em>{{ weekNumbers[$index] }}</em></td>\n           <td ng-repeat="dt in row track by dt.date"\n               class="text-center"\n               id="{{dt.uid}}"\n               role="presentation"\n               tabindex="-1">\n             <button aria-label="{{getAriaLabel(dt)}}"\n                     type="button"\n                     style="width:100%;"\n                     class="btn btn-default btn-sm"\n                     ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}"\n                     ng-click="select(dt.date)"\n                     ng-disabled="dt.disabled"\n                     tabindex="0">\n                     <span ng-class="{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{dt.label}}</span>\n             </button>\n           </td>\n         </tr>\n       </tbody>\n     </table>\n   </div>')}]).decorator("daypickerDirective",["$delegate",function(a){var b=a[0],c=b.link;return b.compile=function(){return function(a,b,d,e){c(a,b,d,e),a.getAriaLabel=function(a){return moment(a.date).format("dddd, MMMM D")},a.onMonthSwitchKeyDown=function(a){(13===a.which||32===a.which)&&(a.preventDefault(),a.stopPropagation(),$(this).click())}}},b.link=null,a}]).directive("datepicker",["$timeout",function(a){return{restrict:"A",require:"datepicker",link:function(b,c){b.getLeftArrow=function(){return c.find(".pull-left")},b.getRightArrow=function(){return c.find(".pull-right")},b.isLeftArrowFocus=function(){return b.getLeftArrow().is(":focus")},b.isRightArrowFocus=function(){return b.getRightArrow().is(":focus")},b.getActiveCell=function(){return c.find(".active")},b.isActiveCellFocus=function(){return b.getActiveCell().is(":focus")};var d={9:"tab",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};c.on("keydown",function(c){var e=d[c.which];e&&(c.preventDefault(),c.stopPropagation(),"tab"===e?c.shiftKey?b.isLeftArrowFocus()?b.getActiveCell().focus():b.isRightArrowFocus()?b.getLeftArrow().focus():b.getRightArrow().focus():b.isLeftArrowFocus()?b.getRightArrow().focus():b.isRightArrowFocus()?b.getActiveCell().focus():b.getLeftArrow().focus():(b.isLeftArrowFocus()||b.isRightArrowFocus())&&a(function(){b.getActiveCell().focus()},0,!1))})}}}]);var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=this;this.$scope=b,this.$rootScope=c,this.$element=d,this.CALENDAR_EVENTS=e,this.slotsSrv=f,this.$q=g,this.DateDefaults=h,this.visitorBILogger=j,this.momentSrv=k,this.$timeout=l,this.bksDebouncePromise=m,this.bookingsLocalizationSrv=n,this.fullCalendarAccessibility=o,this.isInWeeklyMode=!1,this.eventsSource=[],this.onSelectDate=function(a,b){p.calendarRenderedPromise.promise.then(function(){return p.goToMonth(b)}).then(function(){p.selectDate(b)}).then(function(){p.scrollToWeekOfDay(b)}).catch(function(){console.log("ERROR!")})},this.switchToWeekMode=function(){if(p.calendarAPI.switchToWeekView(),p.resetViewOffset(),p.$element.addClass(a.WEEKLY_MODE_CLASS),p.hoverDate){var b=$('[data-date="'+p.hoverDate+'"].fc-day').parents(".fc-week");p.scrollElementIntoView(b[0])}p.setWeekRange(),p.isInWeeklyMode=!0},this.goToNextMonth=function(){p.calendarAPI.goToNextMonth(),p.onMonthChanged()},this.goToToday=function(){var a=moment.tz(p.timezone);p.visitorBILogger.todayClick(),p.calendarAPI.goToToday(),p.notifyMonthChanged(),p.resetViewOffset(),p.updateCurrentViewRange(),p.updateSlotsAvailability().then(function(){p.selectDate(a),p.goToTodayInWeekMode()})},this.goToPrevMonth=function(){p.calendarAPI.goToPrevMonth(),p.onMonthChanged()},this.switchToMonthMode=function(){p.calendarAPI.switchToMonthView(),p.resetViewOffset(),p.fullCalendarAccessibility.enableDaysInMonthViewSelection(),p.notifyMonthChanged(),p.$element.removeClass(a.WEEKLY_MODE_CLASS),p.isInWeeklyMode=!1},this.goToNextWeek=function(){p.currentWeek.start=p.currentWeek.start.clone().add(1,"week"),p.currentWeek.end=p.currentWeek.end.clone().add(1,"week"),p.isNextWeekOutOfCurrentRange()?p.goToFirstUnseenDatesOfNextMonth():p.animateNext(p.calendarSingleWeekHeight),p.notifyWeekChanged()},this.goToPrevWeek=function(){p.currentWeek.start=p.currentWeek.start.clone().subtract(1,"week"),p.currentWeek.end=p.currentWeek.end.clone().subtract(1,"week"),p.isPreviousWeekOutOfCurrentRange()?p.goToFirstUnseenDatesOfPreviousMonth():p.animatePrev(p.calendarSingleWeekHeight),p.notifyWeekChanged()},this.calendarAPI=i.create(this.$element.children().first(),this.timezone),this.calendarRenderedPromise=g.defer(),this.registerListeners(),this.calendarConfig={header:!1,isRTL:this.bookingsLocalizationSrv.isRTL(),firstDay:this.bookingsLocalizationSrv.getFirstDayOfWeek(),contentHeight:"auto",dayNamesShort:n.getDaysOfWeekShortFormatMap(),viewRender:function(){p.onCalendarRendered()},dayClick:function(a){a=p.momentSrv.createMomentWithSameTimeInDifferentTimeZone(a,p.timezone);var b=moment.tz(p.timezone);a.isSameOrAfter(b,"day")&&p.selectDate(a)},eventRender:function(b){p.findElementsByDate(b.start).addClass(a.AVAILABLE_DAYS_CLASS)},eventAfterAllRender:function(){p.calendarAPI.setLocalizedDayInWeek(),p.initializeAccessibility()}}}return a.$inject=["$scope","$rootScope","$element","CALENDAR_EVENTS","slotsSrv","$q","DateDefaults","FullCalendarAdapterFactory","visitorBILogger","momentSrv","$timeout","bksDebouncePromise","bookingsLocalizationSrv","fullCalendarAccessibility"],a.prototype.$onInit=function(){this.debouncedGetSlotsAvailability=this.bksDebouncePromise(this.getSlotsAvailability,2)},a.prototype.initializeAccessibility=function(){this.fullCalendarAccessibility.removeAriaAttributes(),this.fullCalendarAccessibility.hideDaysWeekHeader(),this.fullCalendarAccessibility.hideBlankAreas(),this.fullCalendarAccessibility.initializeDaysSelectionEvents()},a.prototype.goToMonth=function(a){return this.calendarAPI.goToDate(a),this.updateCurrentViewRange(),this.updateSlotsAvailability()},a.prototype.scrollToWeekOfDay=function(a){var b=this.findElementsByDate(a).parents(".fc-week");this.scrollElementIntoView(b)},a.prototype.onCalendarRendered=function(){var a=this;this.onReady();var b;this.retrieveCalendarProperties(),this.onMonthChanged(),this.notifyLowerBound(this.currentViewRange.end),this.calendarRenderedPromise.resolve(),$(document).on("mouseover",".fc-week .fc-day",function(c){var d=angular.element(c.currentTarget);a.$element.find(".fc-day-active").removeClass("fc-day-active"),d.addClass("fc-day-active"),b=d.attr("data-date"),a.hoverDate=b}),$(document).on("mouseout, mouseleave",".fc-week .fc-day",function(b){var c=angular.element(b.currentTarget);c.removeClass("fc-day-active"),a.hoverDate=null})},a.prototype.scrollElementIntoView=function(a){var b=angular.element(a);this.$calendarContent.css({top:0-b.position().top})},a.prototype.selectDate=function(a){this.selectedDate=a,this.notifyDateSelected(a),this.switchToWeekMode(),this.goToWeekOfSelectedDate(a),this.removePreviousSelectionAndSelect(a)},a.prototype.goToWeekOfSelectedDate=function(a){var b=this.bookingsLocalizationSrv.getStartOfWeekForLocale(a.clone());this.setWeekRange(b)},a.prototype.notifyDateSelected=function(a){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.DAY_SELECTED,a)},a.prototype.findElementsByDate=function(a){var b=a.format(this.DateDefaults.DATE_FORMAT);return this.$element.find('[data-date="'+b+'"]')},a.prototype.markSelectedDate=function(b){this.findElementsByDate(b).addClass(a.SELECTED_DAY_CLASS)},a.prototype.removeSelectionMark=function(){this.$element.find("."+a.SELECTED_DAY_CLASS).removeClass(a.SELECTED_DAY_CLASS)},a.prototype.retrieveCalendarProperties=function(){var a=this.$element.find(".fc-week"),b=this.$element.find(".fc-day").first();this.$calendarContent=this.$element.find(".fc-day-grid"),this.calendarSingleWeekWidth=a.width(),this.calendarSingleWeekHeight=a.height(),this.calendarSingleDayWidth=b.outerWidth()},a.prototype.updateCurrentViewRange=function(){var a=this.calendarAPI.getViewDatesRange();this.currentViewRange={start:a.start,end:a.end}},a.prototype.getAvailableSlotsForCurrentRange=function(){return this.debouncedGetSlotsAvailability({range:this.currentViewRange}).then(this.slotsSrv.getDaysWithAvailableSlots).then(this.calendarAPI.convertDatesToAllDayEvents.bind(this.calendarAPI))},a.prototype.getWeeksIntersectionWithPreviousBound=function(){return this.previousViewRange?this.getNumberOfFullWeeksBetweenRanges(this.previousViewRange.end,this.currentViewRange.start):0},a.prototype.getDaysIntersectionWithPreviousLowerBound=function(){return this.previousViewRange?this.getNumberOfFullWeeksBetweenRanges(this.previousViewRange.start,this.currentViewRange.end):0
},a.prototype.getNumberOfFullWeeksBetweenRanges=function(a,b){var c=a.clone().startOf("day").diff(b,"days");return Math.abs(Math.ceil(c/7))},a.prototype.notifyWeekChanged=function(){var a=this;this.notifyVisibleDatesRangeChanged(this.currentWeek),this.$timeout(function(){var b=Math.ceil(parseInt(a.$calendarContent.css("right"),10)/a.calendarSingleWeekWidth);a.fullCalendarAccessibility.enableDaysInWeekViewSelectionOf(a.currentWeek.start,b)},400)},a.prototype.removePreviousSelectionAndSelect=function(a){this.removeSelectionMark(),this.markSelectedDate(a)},a.prototype.onMonthChanged=function(){this.resetViewOffset(),this.notifyMonthChanged(),this.updateCurrentViewRange(),this.updateSlotsAvailability(),this.markPreviouslySelectedDateIfRequired(),this.isInWeeklyMode&&this.calendarAPI.switchToWeekView()},a.prototype.markPreviouslySelectedDateIfRequired=function(){this.selectedDate&&this.selectedDate.isBetween(this.currentViewRange.start,this.currentViewRange.end)&&this.removePreviousSelectionAndSelect(this.selectedDate)},a.prototype.goToTodayInWeekMode=function(){this.setWeekRange(this.bookingsLocalizationSrv.getStartOfWeekForLocale(moment())),this.scrollToWeekOfDay(moment())},a.prototype.updateSlotsAvailability=function(){var a=this;return this.getAvailableSlotsForCurrentRange().then(function(b){a.calendarAPI.addEventsSource(b)})},a.prototype.notifyVisibleDatesRangeChanged=function(a){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.VISIBLE_RANGE_CHANGED,a)},a.prototype.notifyLowerBound=function(a){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.SET_LOWER_BOUND,a)},a.prototype.notifyMonthChanged=function(){var a=this.calendarAPI.getDate(),b={start:a,end:a};this.notifyVisibleDatesRangeChanged(b)},a.prototype.setWeekRange=function(a){void 0===a&&(a=this.currentViewRange.start),this.currentWeek={start:a.clone(),end:a.clone().add(6,"days")},this.notifyWeekChanged()},a.prototype.resetViewOffset=function(){this.retrieveCalendarProperties(),this.$calendarContent.css("top","0px")},a.prototype.goToLastWeekOfMonth=function(){this.$calendarContent.animate({top:"-="+5*this.calendarSingleWeekHeight+"px"})},a.prototype.isNextWeekOutOfCurrentRange=function(){return this.currentWeek.start.isAfter(this.currentViewRange.end.clone().subtract(1,"days"))},a.prototype.goToFirstUnseenDatesOfNextMonth=function(){this.previousViewRange=this.currentViewRange,this.goToNextMonth(),this.animateNext(this.calendarSingleWeekHeight*this.getWeeksIntersectionWithPreviousBound())},a.prototype.animateNext=function(a){this.$calendarContent.animate({top:"-="+a+"px"})},a.prototype.isPreviousWeekOutOfCurrentRange=function(){return this.currentWeek.end.isBefore(this.currentViewRange.start)},a.prototype.goToFirstUnseenDatesOfPreviousMonth=function(){this.previousViewRange=this.currentViewRange,this.goToPrevMonth(),this.goToLastWeekOfMonth(),this.animatePrev(this.calendarSingleWeekHeight*this.getDaysIntersectionWithPreviousLowerBound())},a.prototype.animatePrev=function(a){this.$calendarContent.animate({top:"+="+a+"px"})},a.prototype.refetchEvents=function(b){this.calendarAPI.setTimezone(b),this.calendarAPI.clearEvents(),this.$element.find("[data-date]").removeClass(a.AVAILABLE_DAYS_CLASS),this.updateSlotsAvailability()},a.prototype.registerListeners=function(){var a=this;this.$scope.$on(this.CALENDAR_EVENTS.NEXT_MONTH,this.goToNextMonth),this.$scope.$on(this.CALENDAR_EVENTS.PREV_MONTH,this.goToPrevMonth),this.$scope.$on(this.CALENDAR_EVENTS.COLLAPSE,this.switchToWeekMode),this.$scope.$on(this.CALENDAR_EVENTS.EXPAND,this.switchToMonthMode),this.$scope.$on(this.CALENDAR_EVENTS.NEXT_WEEK,this.goToNextWeek),this.$scope.$on(this.CALENDAR_EVENTS.PREV_WEEK,this.goToPrevWeek),this.$scope.$on(this.CALENDAR_EVENTS.TODAY_REQUESTED,this.goToToday),this.$scope.$on(this.CALENDAR_EVENTS.SELECT_DATE,this.onSelectDate),this.$scope.$on(this.CALENDAR_EVENTS.REFRESH_EVENTS_SOURCE,function(b,c){return a.refetchEvents(c)}),this.$scope.$on(this.CALENDAR_EVENTS.GO_TO_MONTH,function(b,c){return a.goToMonth(c)})},a.WEEKLY_MODE_CLASS="calendar--weekly",a.AVAILABLE_DAYS_CLASS="fc-has-event",a.SELECTED_DAY_CLASS="fc-day-selected",a}();a.VisitorCalendarCtrl=b,angular.module("schedulerAngularClientAppInternal").directive("boostVisitorCalendar",function(){return{templateUrl:"modules/calendar-page/visitor-calendar/visitor-calendar.preload.html",controller:b,controllerAs:"vCldr",bindToController:!0,restrict:"EA",scope:{getSlotsAvailability:"&slotsAvailabilitySource",onReady:"&",timezone:"@"}}})}(b=a.calendar||(a.calendar={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.timezone=b,$.fullCalendar.lang(moment.locale()),this.calendarAPI=a.fullCalendar.bind(a)}return a.prototype.goToNextMonth=function(){this.calendarAPI("next")},a.prototype.goToPrevMonth=function(){this.calendarAPI("prev")},a.prototype.goToToday=function(){this.calendarAPI("today")},a.prototype.getViewDatesRange=function(){var a=this.calendarAPI("getView"),b=a.start,c=a.end;return b.tz(this.timezone),c.tz(this.timezone),{start:b,end:c}},a.prototype.getActualDateRange=function(){var a=this.calendarAPI("getView"),b=a.intervalStart,c=a.intervalEnd;return{start:b,end:c}},a.prototype.getDate=function(){return this.calendarAPI("getDate")},a.prototype.addEventsSource=function(a){this.calendarAPI("addEventSource",a)},a.prototype.clearEvents=function(){this.calendarAPI("removeEvents",function(){return!0})},a.prototype.convertDatesToAllDayEvents=function(a){var b=this,c=a.map(function(a){return a=parseInt(a,10),{start:moment.tz(a,b.timezone).format("YYYY-MM-DD"),end:moment.tz(a,b.timezone).format("YYYY-MM-DD"),rendering:"background",allDay:!0}});return c},a.prototype.goToDate=function(a){this.calendarAPI("gotoDate",a)},a.prototype.switchToWeekView=function(){},a.prototype.switchToMonthView=function(){},a.prototype.setTimezone=function(a){this.timezone=a},a.prototype.setLocalizedDayInWeek=function(){var a=moment();+a.format("D")!==a.date()&&$(".fc-day-number").each(function(a,b){var c=moment($(b).attr("data-date"));$(b).html(c.format("D"))})},a}();a.FullCalendarAdapter=b,angular.module("schedulerAngularClientAppInternal").service("FullCalendarAdapterFactory",function(){this.create=function(a,c){return new b(a,c)}})}(b=a.calendar||(a.calendar={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(){var a=function(){function a(a){this.DateDefaults=a}return a.$inject=["DateDefaults"],a.prototype.hideDaysWeekHeader=function(){$(".fc-head").attr("aria-hidden","true")},a.prototype.removeAriaAttributes=function(){$(".fc-day").removeAttr("aria-hidden"),$(".fc-bg, .fc-bgevent-skeleton").removeAttr("aria-hidden"),$(".fc-day-number").removeAttr("aria-hidden"),$(".fc-content-skeleton").removeAttr("aria-hidden")},a.prototype.hideBlankAreas=function(){$(".fc-day").attr("aria-hidden","true"),$(".fc-bg, .fc-bgevent-skeleton").attr("aria-hidden","true"),$(".fc-day-number").not(".fc-has-event").attr("aria-hidden","true"),$(".fc-day-number.fc-past").attr("aria-hidden","true"),$(".fc-day-number.fc-has-event").each(function(a,b){var c=moment($(b).attr("data-date")),d='<span aria-label="'+c.format("MMMM DD dddd")+'" role="button">'+c.format("D")+"</span>";$(b).html(d)}),$("td").filter(function(){return!this.innerHTML}).attr("aria-hidden","true"),$(".fc-content-skeleton").filter(function(){return 7===$(this).find(".fc-day-number[aria-hidden=true]").length}).attr("aria-hidden","true"),$(".fc-view *").not("span").attr("role","presentation")},a.prototype.initializeDaysSelectionEvents=function(){var a=this;this.setDaysButtonArieEnabled(),this.daysWithNumbersAndEvent().on("click",function(b){var c=b.currentTarget,d=a.dateWithEventFor(c);a.simulateClick(d)}),this.daysWithNumbersAndEvent().keypress(function(b){if(!a.preventKeyPressOnTab(b)&&(b.preventDefault(),a.canSelectSlot(b))){var c=a.dateWithEventFor(b.currentTarget);a.simulateClick(c)}})},a.prototype.preventKeyPressOnTab=function(a){var b=9;return a.keyCode===b?!0:!1},a.prototype.enableDaysInMonthViewSelection=function(){this.setDaysButtonArieEnabled(),$(".fc-week").attr("aria-hidden","false")},a.prototype.enableDaysInWeekViewSelectionOf=function(a,b){this.disableAllDaysSelection(),this.disableWeekBlocks(),this.enableWeekBlockWithChild(a,b)},a.prototype.enableWeekBlockWithChild=function(a,b){$(".fc-week").attr("aria-hidden","true"),$(".fc-week:eq("+b+")").attr("aria-hidden","false"),$(".fc-week:eq("+b+") .fc-day-number.fc-has-event").not(".fc-past").attr("tabindex","0")},a.prototype.disableWeekBlocks=function(){$(".fc-week").attr("aria-hidden","true")},a.prototype.dateWithEventFor=function(a){return $('[data-date="'+$(a).attr("data-date")+'"][aria-hidden="true"]')},a.prototype.simulateClick=function(a){var b=a.offset(),c=jQuery.Event("mousedown",{which:1,pageX:b.left,pageY:b.top});a.mouseover().trigger(c).mouseup()},a.prototype.disableAllDaysSelection=function(){this.daysWithEvent().removeAttr("tabindex")},a.prototype.setDaysButtonArieEnabled=function(){this.daysWithNumbersAndEvent().attr("tabindex","0")},a.prototype.daysWithEvent=function(){return $(".fc-week").find(".fc-has-event").not(".fc-past")},a.prototype.daysWithNumbersAndEvent=function(){return $(".fc-week").find(".fc-day-number.fc-has-event").not(".fc-past")},a.prototype.canSelectSlot=function(a){return this.isEnterPressed(a)||this.isSpacePressed(a)},a.prototype.isSpacePressed=function(a){return 32===a.which},a.prototype.isEnterPressed=function(a){return 13===a.which},a}();angular.module("schedulerAngularClientAppInternal").service("fullCalendarAccessibility",a)}(b=a.components||(a.components={}))}(b=a.crm||(a.crm={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(){var a=function(){function a(a,b,c,d,e,f,g){var h=this;this.$rootScope=a,this.CALENDAR_EVENTS=b,this.libs=c,this.timezoneSrv=d,this.visitorBILogger=e,this.$translate=f,this.$timeout=g,this.isCollapsed=!1,this.onDateRangeChanged=function(a,b){h.visibleDatesRange=b},this.onDaySelected=function(){h.isCollapsed=!0},this.$rootScope.$on(this.CALENDAR_EVENTS.VISIBLE_RANGE_CHANGED,this.onDateRangeChanged),this.$rootScope.$on(this.CALENDAR_EVENTS.DAY_SELECTED,this.onDaySelected),this.$rootScope.$on(this.CALENDAR_EVENTS.SET_LOWER_BOUND,function(a,b){h.lowerBound=b}),this.timezoneSrv.gettingFormattedOffset().then(function(a){h.timeZone=a})}return a.$inject=["$rootScope","CALENDAR_EVENTS","libs","timezoneSrv","visitorBILogger","$translate","$timeout"],a.prototype.getTitle=function(){return this.visibleDatesRange?this.isCollapsed?this.libs.$.fullCalendar.formatRange(this.visibleDatesRange.start,this.visibleDatesRange.end,this.$translate("visitor.calendar.range-date-format")):this.visibleDatesRange.start.format("MMM YYYY"):void 0},a.prototype.doCalendarNavigatePrev=function(){this.isCollapsed?this.goToPrevWeek():this.goToPrevMonth()},a.prototype.doCalendarNavigateNext=function(){this.isCollapsed?this.goToNextWeek():this.goToNextMonth()},a.prototype.goToNextMonth=function(){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.NEXT_MONTH)},a.prototype.goToPrevMonth=function(){this.isRangeBounderyReached()||this.$rootScope.$broadcast(this.CALENDAR_EVENTS.PREV_MONTH)},a.prototype.goToNextWeek=function(){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.NEXT_WEEK)},a.prototype.goToPrevWeek=function(){this.isRangeBounderyReached()||this.$rootScope.$broadcast(this.CALENDAR_EVENTS.PREV_WEEK)},a.prototype.goToToday=function(){this.visitorBILogger.todayClick(),this.$rootScope.$broadcast(this.CALENDAR_EVENTS.TODAY_REQUESTED)},a.prototype.toggleCollapse=function(a){this.preventScrollDownWhenSpaceKeyClicked(a),this.$rootScope.$broadcast(this.isCollapsed?this.CALENDAR_EVENTS.EXPAND:this.CALENDAR_EVENTS.COLLAPSE),this.isCollapsed=!this.isCollapsed,this.$timeout(function(){$(".fc-content-skeleton .fc-has-event:eq(0)").focus()},401)},a.prototype.preventScrollDownWhenSpaceKeyClicked=function(a){var b=32;b===a.which&&a.preventDefault()},a.prototype.isRangeBounderyReached=function(){return this.visibleDatesRange.start.isSame(this.lowerBound,"day")},a.prototype.getCollapseStateLabel=function(){return this.isCollapsed?this.$translate("calendar.controls.collapse-switch.label.monthly"):this.$translate("calendar.controls.collapse-switch.label.weekly")},a}();angular.module("schedulerAngularClientAppInternal").directive("boostVisitorCalendarControls",function(){return{templateUrl:"modules/calendar-page/calendar-controls/visitor-calendar-controls.preload.html",controller:a,transclude:!0,controllerAs:"vccCtrl",bindToController:!0,restrict:"EA"}})}(b=a.calendar||(a.calendar={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){return a?Object.keys(a).sort().reduce(function(b,c){return b[c]=a[c],b},{}):null},c=function(){function c(a,b,c,d,e,f,g,h){var i=this;this.$scope=a,this.$rootScope=b,this.CALENDAR_EVENTS=c,this.$translate=d,this.libs=e,this.visitorBILogger=f,this.futureBookingSrv=g,this.staffListStateMap={},this.id=+Date.now(),this.onDaySelected=function(){i.selectedSlot=null},this.onSlotSelected=function(a,b){var c=b.getTime().valueOf();i.selectedSlot=i.slots[c]?c:null},this.selectedOffering=h.getSelectedOffering(),this.$scope.$on(this.CALENDAR_EVENTS.SLOT_SELECTED,this.onSlotSelected),this.$scope.$on(this.CALENDAR_EVENTS.DAY_SELECTED,this.onDaySelected)}return c.$inject=["$scope","$rootScope","CALENDAR_EVENTS","$translate","libs","visitorBILogger","futureBookingSrv","appointmentService"],c.prototype.sortedSlots=function(){return b(this.slots)},c.prototype.isSlotDisabled=function(a){if(this.selectedOffering.futureBookingsPolicy){var b=this.selectedOffering.futureBookingsPolicy,c=b.shouldLimit,d=b.limitXMinutesToTheFuture;return!this.futureBookingSrv.isTimeInBookingWindow({shouldLimit:c,limitXMinutesToTheFuture:d,startTime:moment(+a)})}return!1},c.prototype.selectSlot=function(a,b){var c;if(!this.isSlotDisabled(b)){a.preventDefault(),this.selectedSlot=+b;var d=this.slots[this.selectedSlot],e=d.length,f=1===e?d[0]:null;this.staffListStateMap=(c={},c[this.selectedSlot]=e>1,c),this.announceSlotSelection(f)}},c.prototype.selectedStaff=function(a){var b=this.slots[this.selectedSlot].filter(function(b){return b.id===a})[0];this.visitorBILogger.staffMemberSelectedFromTimeSlot(),this.announceSlotSelection(b)},c.prototype.announceSlotSelection=function(b){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.SLOT_SELECTED,new a.TimeSlotOption(this.selectedSlot,this.timezone,b))},c.prototype.getFormattedDate=function(a){return moment.tz(+a,this.timezone).format(this.$translate("visitor.time-format"))},c.prototype.isListEmpty=function(){return!this.slots||0===Object.keys(this.slots).length},c.prototype.getStaff=function(a){return this.slots[a]},c.prototype.staffListClosed=function(){this.staffListStateMap={}},c.prototype.isStaffListOpen=function(a){return this.staffListStateMap[a]},c}();angular.module("schedulerAngularClientAppInternal").directive("boostTimeSlotsList",function(){return{templateUrl:"modules/directives/time-slots-list/time-slots-list.preload.html",controller:c,controllerAs:"tslCtrl",scope:{slots:"=",title:"@slotsListTitle",timezone:"@"},bindToController:!0,restrict:"E"}})}(b=a.calendar||(a.calendar={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},__awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j){var k=this;this.visitorApi=a,this.TimeOfDay=b,this.TimeOfDayBounds=c,this.momentSrv=d,this.libs=e,this.overEditor=f,this.$q=g,this.visitorStaffSrv=h,this.appointmentService=i,this.experimentsEnabler=j,this.visitorStaffSrv.gettingStaffMembers().then(function(a){k.staff=a})}return a.$inject=["visitorApi","TimeOfDay","TimeOfDayBounds","momentSrv","libs","overEditor","$q","visitorStaffSrv","appointmentService","experimentsEnabler"],a.prototype.mergeSlotsForSameDay=function(a,b){var c=this,d=[];return a.forEach(function(a){var e=b.find(function(b){return b.staffId===a.staffId});e?d.push(c.mergeSameStaff(a,e)):d.push(a)}),b.forEach(function(a){var b=d.find(function(b){return b.staffId===a.staffId});b||d.push(a)}),d},a.prototype.mergeSameStaff=function(a,b){return{staffId:a.staffId,slots:a.slots.concat(b.slots)}},a.prototype.mergeSlotsWithCurrentSlots=function(a,b,c,d){if(b[c]){var e=this.mergeSlotsForSameDay(d,b[c]);b[c]=e,a=__assign({},a,b)}else a=__assign({},a,b);return a},a.prototype.getSlotAvailabilityWithPaging=function(a,b,c){return __awaiter(this,void 0,void 0,function(){var d,e,f,g,h,i,j,k,l,m;return __generator(this,function(n){switch(n.label){case 0:d=4,g=!0,j=1,n.label=1;case 1:return(g||f)&&d>=j?(g=!1,[4,this.visitorApi.getAvailableSlotsForIndividualService({range:a,timeZone:b,serviceId:c,nextPageToken:f})]):[3,3];case 2:return k=n.sent(),f=k.nextPageToken,l=k.slots,e=e?this.mergeSlotsWithCurrentSlots(e,l,h,i):l,m=Object.keys(l),h=m[m.length-1],i=l[h],j++,[3,1];case 3:return[2,e]}})})},a.prototype.getSlotsAvailability=function(a,b,c){return __awaiter(this,void 0,void 0,function(){var d,e,f,g;return __generator(this,function(h){switch(h.label){case 0:return this.overEditor.isDummyService(c)?(d=70,[2,this.$q.when(this.overEditor.getSlotsAvailability(a,b,this.staff,d))]):(e=c.id,this.experimentsEnabler.isUoUCalendarPaginationEnabled()?[4,this.getSlotAvailabilityWithPaging(a,b,e)]:[3,2]);case 1:return f=h.sent(),[2,f];case 2:return g=void 0,g=this.visitorApi.getAvailableSlotsForIndividualService({range:a,timeZone:b,serviceId:e}),[2,g.then(function(a){return a.slots})]}})})},a.prototype.getDaysWithAvailableSlots=function(a){return Object.keys(a).filter(function(b){return!!a[b].length})},a.prototype.splitFutureSlotsByPartsOfDay=function(a,b){var c=this,d=this.prepareSlotBlocksForTimesOfDay(),e=function(a,b,e){a.forEach(function(a){if(c.isDateInTheFuture(a)){var f=c.determineTimeOfDay(a,b),g=d[f];g[a]=g[a]||[],g[a].push(e)}})};return a.forEach(function(a){var d=a.slots,f=c.visitorStaffSrv.getStaffListByIds([a.staffId],c.staff)[0];e(d,b,f)}),d},a.prototype.isDateInTheFuture=function(a){var b=moment();return b.isBefore(+a)},a.prototype.prepareSlotBlocksForTimesOfDay=function(){var a=this,b={};return Object.keys(this.TimeOfDay).forEach(function(c){var d=a.TimeOfDay[c];b[d]={}}),b},a.prototype.getDatesWithInstances=function(a,b){var c=[];for(var d in a)if(a[d].length>0){var e=moment.tz(+d,b).startOf("day").valueOf();c.push(e)}return c},a.prototype.determineTimeOfDay=function(a,b){var c=this.momentSrv.timestampToMomentInTimezone(a,b).hour();return c<this.TimeOfDayBounds.MORNING?this.TimeOfDay.MORNING:c<this.TimeOfDayBounds.AFTERNOON?this.TimeOfDay.AFTERNOON:this.TimeOfDay.EVENING},a.prototype.getFirstAvailableSlotForIndividualService=function(a,b){if(this.overEditor.isDummyService(a))return this.$q.when(this.overEditor.getFirstAvailableSlotForService());var c=a.id;return this.getFirstRequiredSlotForIndividual({serviceId:c,timezone:b}).then(function(a){return moment(+a.slot)})},a.prototype.getFirstRequiredSlotForIndividual=function(a){var b=this;return this.visitorApi.getFirstAvailableSlotForIndividualService(a).then(function(a){var c=b.appointmentService.getCurrentBooking();return c?{slot:c.start+""}:a})},a.prototype.getAvailabilityOfStaffMember=function(a,b){var c={};return Object.keys(a).forEach(function(d){c[d]=a[d].filter(function(a){return a.staffId===b})}),c},a.prototype.createUnifiedSlotsList=function(a){return this.createUnifiedSlotsListGroupByStart(a)},a.prototype.getAvailableSlotsForTheDay=function(a,b,c){var d=Object.keys(a).find(function(a){return moment.tz(+a,c).isSame(b,"day")});return a[d]},a.prototype.partitionSlotsIntoPartsOfDay=function(a,b,c){var d=this.getAvailableSlotsForTheDay(a,b,c);return d?this.splitFutureSlotsByPartsOfDay(d,c):null},a.prototype.createUnifiedSlotsListGroupByStart=function(a){var b=[],c={};return a.forEach(function(a){c[a.start]?c[a.start].slots.push(a):c[a.start]={start:a.start,slots:[a]}}),Object.keys(c).sort().forEach(function(a){b.push(c[a])}),b},a}();a.SlotsService=b,angular.module("schedulerAngularClientAppInternal").service("slotsSrv",b)}(b=a.calendar||(a.calendar={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.boostInjectionPersister=a}return a.$inject=["boostInjectionPersister"],a.prototype.getCategoryNameById=function(a){var b=this.boostInjectionPersister.getOfferingsList();return null==b?"":b.categories.find(function(b){return b.id===a}).name},a}();a.CategorySrv=b,angular.module("schedulerAngularClientAppInternal").service("categorySrv",b)}(b=a.services||(a.services={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){angular.module("schedulerAngularClientAppConstants").constant("TimeOfDay",new a.TimeOfDay).constant("TimeOfDayBounds",new a.TimeOfDayBounds).constant("DateDefaults",new a.DateDefaultsConst)}(b=a.constants||(a.constants={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c=a.visitor.booking.PurchasedPricingPlanFactory,d=a.visitor.booking.COUPONS_EVENTS,e=WixBookingsUoUDomain.OfferedAsType,f=function(){function f(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=this;if(this.$rootScope=a,this.appointmentService=b,this.businessInfoSrv=c,this.$translate=d,this.CALENDAR_EVENTS=e,this.$element=f,this.$timeout=g,this.visitorBILogger=h,this.overEditor=i,this.userManagementSrv=j,this.experimentsEnabler=k,this.membershipSrv=l,this.userPurchasedPlanSrv=m,this.trackingSrv=n,this.$scope=o,this.$filter=p,this.appConfig=q,this.modal=r,this.couponsSrv=s,this.flowManagerSrv=t,this.isToShowErrorNotificationMsg=!1,this.participantsVisibility=!0,this.couponApplied=!1,this.isSlotSelected=!1,this.listenersRemoval=new Array,this.hidePrice=!1,this.onSlotSelected=function(a,b){u.isSlotSelected=!0,u.staffMember=b.getStaff(),u.selectedTime=u.selectedDate=b.getTime(),u.duration=b.groupInstance&&b.groupInstance.duration,u.isWaitingListFlow=b.groupInstance&&b.groupInstance.occupancy===GroupInstanceOccupancy.WAITING_LIST_AVAILABLE,u.setAddressInfo()},this.onDateSelected=function(a,b){u.selectedTime=null,u.selectedDate=moment(b),u.staffMember=null,u.setAddressInfo()},this.onCouponChanged=function(){u.coupon=u.couponsSrv.getAppliedCoupon(),u.couponApplied=!!u.coupon},!angular.isNumber(this.numOfStaff))throw"numOfStaff must me a number";this.isResponsiveUOUEnabled=k.isResponsiveUOUEnabled(),this.isOnContactInfoDeeplinkFlow="ContactInfoDeepLinkFlow"===t.getCurrentValidFlowName(),this.initSelectedOffering(),this.checkForPreviouslySelectedSlot(),this.initPurchasedPlan(),this.setAddressInfo(),this.setupListeners()}return f.$inject=["$rootScope","appointmentService","businessInfoSrv","$translate","CALENDAR_EVENTS","$element","$timeout","visitorBILogger","overEditor","userManagementSrv","experimentsEnabler","membershipSrv","userPurchasedPlanSrv","trackingSrv","$scope","$filter","appConfig","modal","couponsSrv","flowManagerSrv"],f.prototype.$onInit=function(){this.onCouponChanged()},Object.defineProperty(f.prototype,"loginDescriptionLabel",{get:function(){return b.loginLabelResolver(this.service,this.$filter)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"quantity",{get:function(){return this.service.numberOfParticipants},enumerable:!0,configurable:!0}),f.prototype.setAddressKey=function(){this.addressKey=this.businessInfo.apartmentNum?"sidebar.address.line1":"sidebar.address.line1-no-apt"},f.prototype.setAddressInfo=function(){var a=this;this.businessInfoSrv.gettingBusinessInfo().then(function(b){a.businessInfo=b,a.setAddressKey(),a.addressInfo={offeringLocation:a.appointmentService.getAppointmentLocation(),offeringLocationText:a.appointmentService.getAppointmentLocationText(),businessLocation:a.businessInfo.businessLocation,businessName:a.businessInfo.name,businessAddress:a.$translate(a.addressKey,a.businessInfo),city:a.getBusinessCity(),formattedAddress:a.businessInfo.formattedAddress}})},f.prototype.initSelectedOffering=function(){this.service=this.appointmentService.getSelectedOffering()},f.prototype.initPurchasedPlan=function(){var a=this;this.service.isPricingPlanOffering()&&(this.experimentsEnabler.isBookingsPackagesEnabled()?this.firstUsablePurchasedPricingPlan?this.$scope.$emit(PricingPlanConst.BOOKING_METHOD_SELECTED,e.PRICING_PLAN):this.bookedAs===e.PRICING_PLAN&&(this.firstUsablePurchasedPricingPlan=this.appointmentService.getPurchasedPricingPlan()):this.membershipSrv.getPricingPlans(this.service.id).then(function(b){a.firstUsablePurchasedPricingPlan=c.fromDto(b[0],a.timezone),b&&a.$scope.$emit(PricingPlanConst.BOOKING_METHOD_SELECTED,e.PRICING_PLAN)}),this.hidePrice=(this.isOnCalendarPage||this.isOnContactInfoDeeplinkFlow)&&this.service.isBothSingleSessionAndPricingPlanOffering())},f.prototype.setParticipantsVisibility=function(a){this.participantsVisibility=a},f.prototype.setupListeners=function(){var b=this;this.listenersRemoval.push(this.$rootScope.$on(this.CALENDAR_EVENTS.DAY_SELECTED,this.onDateSelected)),this.listenersRemoval.push(this.$rootScope.$on(this.CALENDAR_EVENTS.SLOT_SELECTED,this.onSlotSelected)),this.listenersRemoval.push(this.$rootScope.$on(f.EVENTS.SERVICE_UPDATED,function(){return b.onServiceUpdated()})),this.listenersRemoval.push(this.$rootScope.$on("CALENDAR_EVENTS.SLOT_UPDATED",function(a,c){return b.onSlotUpdated(c)})),this.listenersRemoval.push(this.$rootScope.$on(this.CALENDAR_EVENTS.SLOT_WITH_STAFF_SELECTED,function(){b.isResponsiveUOUEnabled&&b.$rootScope.$broadcast(a.boost.visitor.directives.ScrollToMe.SCROLL_EVENT,{toElement:"sidebar"}),b.$timeout(function(){b.$element.find('[data-scroll="sidebar-action"]').focus()})})),this.listenersRemoval.push(this.$rootScope.$on(d.COUPON_UPDATED,function(){return b.onCouponChanged()})),this.$scope.$on("$destroy",function(){b.listenersRemoval.forEach(function(a){a()})})},f.prototype.checkForPreviouslySelectedSlot=function(){var a=this.appointmentService.getSelectedTime();a&&(this.isSlotSelected=!0,this.selectedDate=this.createMomentFromTime(+a.startTime),this.selectedTime=this.createMomentFromTime(+a.startTime),this.isMembershipPlanOffering&&(this.purchasedPricingPlan=c.fromDto(a.purchasedPricingPlan,this.timezone)),this.staffMember=a.staffMember,this.isOnCalendarPage||this.isOnContactInfoDeeplinkFlow||(this.bookedAs=a.bookedAs),this.currentBookedAs=a.bookedAs,this.duration=a.groupInstance&&a.groupInstance.duration,this.isWaitingListFlow=a.groupInstance&&a.groupInstance.occupancy===GroupInstanceOccupancy.WAITING_LIST_AVAILABLE)},f.prototype.onLogInClicked=function(){this.userManagementSrv.loginUser()},f.prototype.createMomentFromTime=function(a){return this.timezone?moment.tz(a,this.timezone):moment(a)},f.prototype.getTitle=function(){return this.service.name},f.prototype.getDuration=function(){return this.service.duration},f.prototype.getDate=function(){return this.selectedDate.format(this.$translate("sidebar.date-format"))},f.prototype.getTime=function(){return this.selectedTime?this.selectedTime.format(this.$translate("visitor.time-format")):""},f.prototype.isShowSlotInfo=function(){return!(this.isMultipleSessionInformationPresented()||!this.selectedDate&&!this.selectedTime)},f.prototype.isLoginRequire=function(){return this.isMembershipPlanOffering&&!this.userManagementSrv.isLoggedIn()&&(this.isOnCalendarPage||this.isOnContactInfoDeeplinkFlow)},f.prototype.isMultipleSessionInformationPresented=function(){return!(!this.service||!this.service.isMultipleSessionOffering())},f.prototype.isShowSlotNumberOfSessions=function(){return this.isMultipleSessionInformationPresented()&&this.service.totalNumberOfSessions>1&&!this.service.isSingleDayOffering()},f.prototype.getBusinessName=function(){return this.businessInfo.name},f.prototype.getBusinessCity=function(){return this.appointmentService.getBusinessCity(this.businessInfo)},f.prototype.getLocation=function(){return this.appointmentService.getAppointmentLocation()},f.prototype.getLocationText=function(){return this.appointmentService.getAppointmentLocationText()},f.prototype.getCancellationPolicy=function(){return this.businessInfo.cancellationPolicy},f.prototype.getTeacher=function(){return this.staffMember&&(this.numOfStaff>1||this.isMultipleSessionInformationPresented())?this.staffMember.fullName:""},f.prototype.getMinCharge=function(){return this.service.minCharge},f.prototype.getSelectedNumberOfParticipants=function(){return this.service.numberOfParticipants||1},f.prototype.getCurrency=function(){return this.service.currency},f.prototype.showPricingPlanSection=function(){return this.bookedAs!==e.ONE_TIME&&this.isMembershipPlanOffering&&this.isSlotSelected&&!this.isWaitingListFlow},f.prototype.shouldShowVideoConference=function(){return this.experimentsEnabler.isBookingsZoomIntegrationEnabled()&&this.service.isOnlineMeetingConnected()},f.prototype.showDetails=function(){return this.isShowSlotInfo()||this.getTeacher()||this.appointmentService.isShowBusinessAddress(this.service,this.selectedTime,this.businessInfo,!1)||this.participantsVisibility||this.sidebarShowUpfront},f.prototype.shouldShowUpfrontPayment=function(){return this.sidebarShowUpfront&&!this.couponApplied},f.prototype.shouldShowCouponsInfo=function(){return this.couponApplied&&(this.isLastStep||this.appConfig.getIsMobile()&&this.shouldShowCoupons)},f.prototype.shouldShowTimezoneNote=function(){return this.appConfig.getIsMobile()},f.prototype.shouldShowCouponsForm=function(){return this.bookedAs!==e.PRICING_PLAN&&this.shouldShowCoupons},f.prototype.onServiceUpdated=function(){this.initSelectedOffering()},f.prototype.checkBeforeProgress=function(){this.blockProgressWithMsg?(this.visitorBILogger.bookedGroupButNotPremium(),this.modal.openNonBookableOfferingSelected(this.blockProgressWithMsg)):(this.isLastStep?this.trackingSrv.trackContactInfoNextClick(this.appointmentService.getSelectedOffering()):this.trackingSrv.trackCalendarNextClick(this.appointmentService.getSelectedOffering()),this.onActionClick())
},f.prototype.onSlotUpdated=function(a){this.service.isPricingPlanOffering()&&(this.purchasedPricingPlan=c.fromDto(a.getPurchasedPricingPlan(),this.timezone))},f.EVENTS={SERVICE_UPDATED:"Sidebar.SERVICE_UPDATED"},f}();b.VisitorSidebar=f,angular.module("schedulerAngularClientAppInternal").component("boostVisitorSidebar",{templateUrl:"modules/sidebar/sidebar.preload.html",controller:f,bindings:{isLastStep:"=",actionLabel:"=",ariaActionLabel:"=",isActionEnabled:"=actionEnabled",isMembershipPlanOffering:"=membershipPlanOffering",isOnCalendarPage:"<",shouldShowCoupons:"<",blockProgressWithMsg:"=",onActionClick:"&actionClick",timezone:"@",actionErrorMessage:"@",sidebarShowUpfront:"=",numOfStaff:"=",firstUsablePurchasedPricingPlan:"<"}})}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c){this.$translate=a,this.$scope=b,this.experimentsEnabler=c}return a.$inject=["$translate","$scope","experimentsEnabler"],a.prototype.$onInit=function(){this.$scope.$emit(PricingPlanConst.BOOKING_METHOD_SELECTED,OfferedAsType.PRICING_PLAN),this.validPurchasedPlan=this.getValidPurchasesPlan()},a.prototype.$onChanges=function(){this.validPurchasedPlan=this.getValidPurchasesPlan()},Object.defineProperty(a.prototype,"planName",{get:function(){return this.validPurchasedPlan.name},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"validUntilLabel",{get:function(){return this.validPurchasedPlan.hasExpirationDate?this.$translate("sidebar.membership.end-date",{endDate:this.formattedEndDate(this.validPurchasedPlan.end)}):this.$translate("sidebar.membership.user-cancel")},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"noPlanMessage",{get:function(){return this.$translate("sidebar.membership.summary-purchase-text")},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"showFutureExpired",{get:function(){return!this.slotPurchasedPlan&&!!this.firstUsablePurchasedPlan},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"futureExpirationMessage",{get:function(){return this.$translate("sidebar.membership.future-expiration")},enumerable:!0,configurable:!0}),a.prototype.showDetails=function(){return!!this.slotPurchasedPlan||!!this.firstUsablePurchasedPlan},a.prototype.formattedEndDate=function(a){return a.format(this.$translate("sidebar.membership.end-date-format"))},Object.defineProperty(a.prototype,"sessionsBalance",{get:function(){if(this.validPurchasedPlan&&"LIMITED"===this.validPurchasedPlan.type){var a=this.pricingPlanInfo?this.pricingPlanInfo.sessions:this.validPurchasedPlan.sessions,b=this.pricingPlanInfo?this.pricingPlanInfo.remains:this.validPurchasedPlan.remains,c=this.pricingPlanInfo?"sidebar.membership.sessions-remaining":"sidebar.membership.sessions-balance";return this.$translate(c)+" "+(b+"/"+a)}return""},enumerable:!0,configurable:!0}),a.prototype.getValidPurchasesPlan=function(){return this.slotPurchasedPlan?this.slotPurchasedPlan:this.firstUsablePurchasedPlan},a}();a.SidebarPricingPlanSection=b,angular.module("schedulerAngularClientAppInternal").component("bksSidebarPricingPlanSection",{templateUrl:"modules/sidebar/sidebar-pricing-plan-section/sidebar-pricing-plan-section.preload.html",bindings:{slotPurchasedPlan:"<",firstUsablePurchasedPlan:"<",pricingPlanInfo:"<"},controller:b})}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){var b=this;this.experimentsEnabler=a,this.showBookMethodSelector=function(){return!b.havePlan()&&b.multipleBookMethod()}}return a.$inject=["experimentsEnabler"],a.prototype.havePlan=function(){return!!this.firstUsablePurchasedPlan||!!this.slotPurchasedPlan},a.prototype.multipleBookMethod=function(){return this.offeredAs.length>1},a}();a.BookMethodController=b,angular.module("schedulerAngularClientAppInternal").component("bksBookMethod",{template:'<bks-sidebar-pricing-plan-section data-hook="pricing-plan-info"\n                                                   ng-if="!$ctrl.showBookMethodSelector()"\n                                                   slot-purchased-plan="$ctrl.slotPurchasedPlan" \n                                                   first-usable-purchased-plan="$ctrl.firstUsablePurchasedPlan"/>\n                 <bks-book-method-selector ng-if="$ctrl.showBookMethodSelector()"\n                                         data-hook="book-method-selector" \n                                         price="$ctrl.price"\n                                         currency="$ctrl.currency"\n                                         booked-as="$ctrl.bookedAs"/>',bindings:{slotPurchasedPlan:"<",firstUsablePurchasedPlan:"<",offeredAs:"<",price:"<",currency:"<",bookedAs:"<"},controller:b})}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c=WixBookingsUoUDomain.OfferedAsType,d=function(){function b(a,b){this.$scope=a,this.$filter=b,this.selectedBookMethod=c.PRICING_PLAN,this.bookedAs&&(this.selectedBookMethod=this.bookedAs),this.$scope.$emit(PricingPlanConst.BOOKING_METHOD_SELECTED,this.selectedBookMethod)}return b.$inject=["$scope","$filter"],b.prototype.selectedBookMethodChange=function(a){this.$scope.$emit(PricingPlanConst.BOOKING_METHOD_SELECTED,a)},b.prototype.getOfferingPrice=function(){return this.$filter("isoCurrency")(this.price,this.currency,a.bookings.visitor.payments.getFractionDigitsForPrice(this.price))},b}();b.BookMethodSelector=d,angular.module("schedulerAngularClientAppInternal").component("bksBookMethodSelector",{template:'\n    <div class="booking-method-selector">\n        <label class="booking-method-selector__control booking-method-selector__control-radio">\n            <label class="booking-method-selector__label" data-hook="booked-as-selection-one-time-text" for="one-time">{{\'sidebar.book-method-selector.on-time\' | translate : {price: $ctrl.getOfferingPrice()} }}</label>\n            <input data-hook="booked-as-selection-one-time"\n                    ng-model="$ctrl.selectedBookMethod"\n                    value="ONE_TIME"\n                    id="one-time"\n                    ng-change=\'$ctrl.selectedBookMethodChange($ctrl.selectedBookMethod)\'\n                    type="radio"/>\n            <div class="booking-method-selector__control_indicator"></div>\n        </label>\n        <label class="booking-method-selector__control booking-method-selector__control-radio">\n            <label class="booking-method-selector__label" data-hook="booked-as-selection-pricing-plan-text" for="pricing-plan">{{\'sidebar.book-method-selector.pricing-plan\' | translate}}</label>\n            <input data-hook="booked-as-selection-pricing-plan"\n                    ng-model="$ctrl.selectedBookMethod"\n                    value="PRICING_PLAN"\n                    id="pricing-plan"\n                    ng-change=\'$ctrl.selectedBookMethodChange($ctrl.selectedBookMethod)\'\n                    type="radio" />\n            <div class="booking-method-selector__control_indicator"></div>\n        </label>\n    </div>\n\n',bindings:{price:"<",currency:"<",bookedAs:"<"},controller:d})}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.visitorBILogger=a,this.isCollapsed=!0}return a.$inject=["visitorBILogger"],a.prototype.toggleCollapse=function(a){this.preventScrollDownWhenSpaceKeyClicked(a),this.visitorBILogger.cancellationPolicy(),this.isCollapsed=!this.isCollapsed},a.prototype.preventScrollDownWhenSpaceKeyClicked=function(a){var b=32;b===a.which&&a.preventDefault()},a}();a.CollapsableSidebarWidget=b,angular.module("schedulerAngularClientAppInternal").directive("boostCollapsableWidget",function(){return{templateUrl:"modules/templates/collapsable-sidebar-widget.preload.html",controller:b,controllerAs:"cswCtrl",scope:{title:"@",content:"@"},bindToController:!0,restrict:"EA"}})}(b=a.directives||(a.directives={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.PAYMENT_PROCESS_RESULT={SUCCEEDED:"PAYMENT_SUCCEEDED",FAILED:"PAYMENT_FAILED",OFFLINE:"PAYMENT_OFFLINE"};var b=function(){function a(){this.PAYMENT_TYPE_ONLINE="ONLINE",this.PAYMENT_TYPE_OFFLINE="OFFLINE",this.PAYMENT_TYPE_TENTATIVE="TENTATIVE",this.PAYMENT_TYPE_ALL="ALL"}return a}();a.PaymentType=b;var c=function(){function a(a,b,c,d,e){this.appointmentService=a,this.visitorApi=b,this.features=d,this.premiumService=e,this.PAYMENT_TYPE_ONLINE=c.PAYMENT_TYPE_ONLINE,this.PAYMENT_TYPE_OFFLINE=c.PAYMENT_TYPE_OFFLINE}return a.$inject=["appointmentService","visitorApi","paymentType","features","premiumService"],a.prototype.handle=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(a){switch(a.label){case 0:return[4,this.setOfflinePayment()];case 1:return[2,a.sent()]}})})},a.prototype.setBusinessInfo=function(a){this.businessInfo=a},a.prototype.isPaidOnline=function(a){var b=this.appointmentService.getPaymentInfo();return!(!b||!a||b.paymentType!==this.PAYMENT_TYPE_ONLINE)},a.prototype.hasUpfrontPayment=function(a){return __awaiter(this,void 0,void 0,function(){var b;return __generator(this,function(c){switch(c.label){case 0:return b=a,b?[4,this.isOnlinePaymentAllowed()]:[3,2];case 1:b=c.sent(),c.label=2;case 2:return[2,!!b]}})})},a.prototype.isOnlinePaymentAllowed=function(){return __awaiter(this,void 0,void 0,function(){var a;return __generator(this,function(b){switch(b.label){case 0:return a=this.isPaymentNeeded(this.appointmentService.getSelectedOffering())&&this.premiumService.isFeatureEnabled(this.features.PAYMENTS),a?[4,this.hasPaymentMethodConnected()]:[3,2];case 1:a=b.sent(),b.label=2;case 2:return[2,a]}})})},a.prototype.isPaymentNeeded=function(a){void 0===a&&(a=this.appointmentService.getSelectedOffering());var b=a.isPricingPlanOffering();return!(a.isFree||this.isOfflinePayment(a)||a.dummy||b&&this.getBookedAs()!==OfferedAsType.ONE_TIME)},a.prototype.getBookedAs=function(){var a=this.appointmentService.getSelectedTime();return a?a.bookedAs:null},a.prototype.isOfflinePayment=function(a){return a.paymentType===this.PAYMENT_TYPE_OFFLINE},a.prototype.hasPaymentMethodConnected=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(a){switch(a.label){case 0:return[4,this.visitorApi.isCashierConnected()];case 1:return[2,a.sent()]}})})},a.prototype.setOfflinePayment=function(){this.appointmentService.setPaymentInfo({paymentType:this.PAYMENT_TYPE_OFFLINE})},a}();a.PaymentService=c,angular.module("schedulerAngularClientAppInternal").constant("paymentType",new b).service("paymentService",c)}(b=a.payments||(a.payments={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(a){a.PAYMENT_DECLINE="PAYMENT_DECLINE",a.CREDIT_CARD_NOT_VALID="CREDIT_CARD_NOT_VALID",a.NEW_ORDER_RECREATED="NEW_ORDER_RECREATED",a.RECREATING_NEW_ORDER="RECREATING_NEW_ORDER",a.BOOKING_ERROR_SLOT_NOT_AVAILABLE="BOOKING_ERROR_SLOT_NOT_AVAILABLE",a.PAY_FOR_ORDER_NOT_IN_CONTEXT="PAY_FOR_ORDER_NOT_IN_CONTEXT"}(c=b.PaymentFailureStatus||(b.PaymentFailureStatus={}));var d=function(){function b(a,b,c,d,e,f,g){this.$q=a,this.appointmentService=b,this.paymentType=c,this.processBookingSrv=d,this.$rootScope=e,this.trackingSrv=f,this.visitorBILogger=g}return b.$inject=["$q","appointmentService","paymentType","processBookingSrv","$rootScope","trackingSrv","visitorBILogger"],b.prototype.setOrderId=function(a){this.orderId=a},b.prototype.pay=function(a){var b=this,d=this.$q.defer();return this.cashierApi.validate().then(function(e){var f=e.isValid;f?(b.trackPaymentInfo(),b.cashierApi.pay().then(function(c){return b.handleWixPaymentResult(c,d,a)})):d.reject(c.CREDIT_CARD_NOT_VALID)}).catch(function(){return d.reject()}),d.promise},b.prototype.trackPaymentInfo=function(){var a=this.cashierApi.getActivePaymentMethod().paymentMethod,b=this.getPaymentTypeFromCashierType(a);this.trackingSrv.trackPaymentInfoAdded(this.appointmentService.getSelectedOffering(),b)},b.prototype.handleWixPaymentResult=function(a,b,d){var e=this;this.orderId!==d?b.reject(c.PAY_FOR_ORDER_NOT_IN_CONTEXT):a.isSuccessOrPending?(this.handlePaymentSuccess(a.paymentMethod),b.resolve()):a.isRetryable?b.reject(c.PAYMENT_DECLINE):(this.$rootScope.$emit(c.RECREATING_NEW_ORDER),this.processBookingSrv.execute().then(function(){return b.reject(c.NEW_ORDER_RECREATED)}).catch(function(a){return e.isSlotNotAvailableError(a)?b.reject(c.BOOKING_ERROR_SLOT_NOT_AVAILABLE):b.reject()}))},b.prototype.isSlotNotAvailableError=function(b){return b===a.bookings.visitor.services.BOOKING_CLIENT_ERRORS.SLOT_NOT_AVAILABLE},b.prototype.setCashierApi=function(a){this.cashierApi=a},b.prototype.getCashierApi=function(){return this.cashierApi},b.prototype.handlePaymentSuccess=function(a){var b=this,c=this.getPaymentTypeFromCashierType(a);this.appointmentService.setPaymentInfo({paymentType:c}),this.visitorBILogger.appointmentCreated(c),this.cashierApi.getAllMandatoryFields().then(function(a){b.visitorBILogger.reportClickNextInPaymentInfo("Payment_Info",a)})},b.prototype.getPaymentTypeFromCashierType=function(a){return"inPerson"===a?this.paymentType.PAYMENT_TYPE_OFFLINE:this.paymentType.PAYMENT_TYPE_ONLINE},b}();b.CashierPaymentSrv=d,angular.module("schedulerAngularClientAppInternal").service("cashierPaymentSrv",d)}(c=b.payment||(b.payment={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var ServiceClassicWithImage=function(){function a(a){this.experimentsEnabler=a,this.hover=!1}return a.$inject=["experimentsEnabler"],a.prototype.isShowOverlay=function(){return this.description},a.prototype.isHideImage=function(){return this.hover&&this.isShowOverlay()},Object.defineProperty(a.prototype,"description",{get:function(){return this.service.description},enumerable:!0,configurable:!0}),a.prototype.mouseenter=function(){this.hover=!0},a.prototype.mouseleave=function(){this.hover=!1},a}();angular.module("schedulerAngularClientAppInternal").component("boostServiceClassicWithImage",{templateUrl:"modules/service-tile/heidi/classic-with-image.preload.html",controller:ServiceClassicWithImage,bindings:{imageUrl:"@",isImageRound:"=",onClick:"&",onShowDetails:"&",onLearnMore:"&",onDescriptionClick:"&",onImageClick:"&",service:"=",serviceDays:"=",fullServiceDays:"=",buttonText:"@",learnMoreSeoUrl:"@"}});var ServiceClassicWithoutImage=function(){function a(){}return Object.defineProperty(a.prototype,"description",{get:function(){return this.service.description},enumerable:!0,configurable:!0}),a}();angular.module("schedulerAngularClientAppInternal").component("boostServiceClassicWithoutImage",{templateUrl:"modules/service-tile/heidi/classic-without-image.preload.html",controller:ServiceClassicWithoutImage,bindings:{onClick:"&",onShowDetails:"&",onLearnMore:"&",onDescriptionClick:"&",service:"=",serviceDays:"=",fullServiceDays:"=",buttonText:"@",learnMoreSeoUrl:"@"}});var __assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.APPROVED="APPROVED",a.APPROVED_WIX_PAYMENT_NOT_AVAILABLE="APPROVED_WIX_PAYMENT_NOT_AVAILABLE",a.PENDING_WIX_PAY="PENDING_WIX_PAY"}(b=a.CreateBookingStatus||(a.CreateBookingStatus={}));var c=function(){function a(a){this.dto=a}return a.prototype.isPaymentRequired=function(){return this.dto.bookingStatus===b.PENDING_WIX_PAY},a.prototype.isWixPaymentDown=function(){return this.dto.bookingStatus===b.APPROVED_WIX_PAYMENT_NOT_AVAILABLE},Object.defineProperty(a.prototype,"bookingId",{get:function(){return this.dto.bookingId},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"externalOrderId",{get:function(){return this.isPaymentRequired()?this.dto.orderId:null},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"bookedLocationInfo",{get:function(){return this.dto.bookingsData.locationInfo},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"bookedPayment",{get:function(){return this.dto.bookingsData.payment},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"bookedVideoConferenceLink",{get:function(){return this.dto.bookingsData.videoConferenceLink},enumerable:!0,configurable:!0}),a}();a.CreateBookingDomain=c;var d=function(){function a(a,b){this.appointmentServiceAdapter=a,this.couponServiceAdapter=b}return a.prototype.generateCreateBookingRequest=function(a){var b=a.isOverEditor,c=void 0===b?!1:b,d=a.isUoUTimezoneValidationEnabled,e=void 0===d?!1:d,f=a.sendSmsReminder,g=void 0===f?!1:f,h=a.fakeTimezone,i=this.appointmentServiceAdapter.getSelectedOffering(),j=this.appointmentServiceAdapter.getSelectedTime(),k=this.appointmentServiceAdapter.getContactInfo(),l=this.generateTimeSlotId(c,j),m=this.appointmentServiceAdapter.getPurchasedPricingPlan(),n=m?{pricingPlanId:m.pricingPlanId}:void 0,o=n?n.pricingPlanId:void 0,p=this.couponServiceAdapter.isCouponApplied()?this.couponServiceAdapter.getAppliedCoupon().appliedCoupon.couponCode:void 0,q=parseInt(j.startTime,10),r=parseInt(j.endTime,10),s=h?h:j.timeZone,t=moment.tz(q,s),u=moment.tz(r,s);return{scheduleInfo:__assign({type:i.type,offeringId:i.id,timeSlot:{id:l,staffMemberId:j.staffMember.id,startTime:q,endTime:r},timeZone:j.timeZone},e?{localDateTime:{startTime:{hourOfDay:t.hour(),dayOfMonth:t.date(),year:t.year(),monthOfYear:t.month()+1,minutesOfHour:t.minute()},endTime:{hourOfDay:u.hour(),dayOfMonth:u.date(),year:u.year(),monthOfYear:u.month()+1,minutesOfHour:u.minute()}}}:{}),contactInfo:{bookingsForm:k.dynamicFormData.form},orderBenefitId:o,couponCode:p,sendSmsReminder:g}},a.prototype.generateTimeSlotId=function(a,b){return a?this.generateTimeSlotIdForDummyData(b):this.generateRealTimeSlotId(b)},a.prototype.generateRealTimeSlotId=function(a){return a.groupInstance?a.groupInstance.id:null},a.prototype.generateTimeSlotIdForDummyData=function(a){return a.groupInstance&&!a.groupInstance.dummy?a.groupInstance.id:null},a}();a.CreateBookingRequestFactory=d}(b=a.domain||(a.domain={}))}(b=a.offering||(a.offering={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c,d=a.bookings.offering.domain.CreateBookingRequestFactory,e=a.visitor.booking.ValidateBookingInfo,f=a.visitor.booking.ValidateBookingType,g=a.visitor.booking.ValidationPaymentType,h=a.bookings.offering.domain.CreateBookingDomain;!function(a){a.SUCCEEDED="PAYMENT_SUCCEEDED",a.FAILED="PAYMENT_FAILED",a.OFFLINE="PAYMENT_OFFLINE",a.TENTATIVE="PAYMENT_TENTATIVE"}(c=b.PAYMENT_PROCESS_RESULT||(b.PAYMENT_PROCESS_RESULT={})),b.BOOKINGS_HTTP_ERROR_CODES={CONFLICT_ERROR:409,GENERAL_ERROR:500},b.BOOKINGS_SERVER_RESPONSE_ERROR_CODES={SLOT_NOT_AVAILABLE:"SLOT_NOT_AVAILABLE",SERVICE_NOT_AVAILABLE:"SERVICE_NOT_AVAILABLE"},b.BOOKING_CLIENT_ERRORS={SLOT_NOT_AVAILABLE:"SLOT_NOT_AVAILABLE",SERVICE_NOT_AVAILABLE:"SERVICE_NOT_AVAILABLE",GENERAL_ERROR:"BOOKING_GENERAL_ERROR"};var i=function(){function a(a,d,e,f,g,h,i,j,k,l,m){var n=this;this.appointmentService=a,this.paymentType=d,this.visitorBILogger=e,this.overEditor=f,this.bookingApiSrv=g,this.validateBookingDataSrv=h,this.experimentsEnabler=i,this.$wix=j,this.navigationMonitoring=k,this.bookingDataSrv=l,this.couponsSrv=m,this.handleBookingError=function(a){if(n.logBookingTransactionEnd(),n.isConflictServerError(a)){if(n.isServiceNotAvailable(a.data))throw b.BOOKING_CLIENT_ERRORS.SERVICE_NOT_AVAILABLE;if(n.isSlotNotAvailable(a.data))throw b.BOOKING_CLIENT_ERRORS.SLOT_NOT_AVAILABLE}else if(n.isGeneralError(a))throw b.BOOKING_CLIENT_ERRORS.GENERAL_ERROR;throw a},this.registerPaymentResult=function(a){var b;switch(a){case c.OFFLINE:b=n.paymentType.PAYMENT_TYPE_OFFLINE;break;case c.TENTATIVE:b=n.paymentType.PAYMENT_TYPE_TENTATIVE;break;default:b=n.paymentType.PAYMENT_TYPE_ONLINE}n.appointmentService.setPaymentInfo({paymentType:b});var d=b;if(a!==c.TENTATIVE){if(n.experimentsEnabler.isBookingsPackagesEnabled()){var e=n.appointmentService.getPurchasedPricingPlan();e&&(d="LIMITED"===e.type?"paid_plan_limited":"paid_plan_unlimited")}n.visitorBILogger.appointmentCreated(d)}}}return a.$inject=["appointmentService","paymentType","visitorBILogger","overEditor","bookingApiSrv","validateBookingDataSrv","experimentsEnabler","$wix","navigationMonitoring","bookingDataSrv","couponsSrv"],a.prototype.execute=function(a,b){return void 0===a&&(a=!1),void 0===b&&(b=!1),__awaiter(this,void 0,void 0,function(){return __generator(this,function(){return this.logBookingTransactionStart(),[2,this.processBooking(a,b)]})})},a.prototype.processBooking=function(a,b){return this.isDummy()||this.shouldSkipCreateBookingInServer(a)?(this.registerPaymentResult(c.OFFLINE),this.logBookingTransactionEnd(),void 0):this.processBookingWithServer(b)},a.prototype.shouldSkipCreateBookingInServer=function(a){return this.overEditor.isDemoFlow&&a===!1},a.prototype.processBookingWithServer=function(a){var b=this,c=new d(this.appointmentService,this.couponsSrv),e=this.overEditor.isDemoFlow,f=this.experimentsEnabler.isUoUTimezoneValidationEnabled(),g=this.experimentsEnabler.fakeTimeZone(),i=c.generateCreateBookingRequest({isOverEditor:e,isUoUTimezoneValidationEnabled:f,fakeTimezone:g,sendSmsReminder:a});return this.bookingApiSrv.creatingBooking(i).then(function(a){var c=new h(a);return b.proceedWithCreatedBooking(c,i)}).catch(this.handleBookingError)},a.prototype.proceedWithCreatedBooking=function(a,b){this.logBookingTransactionEnd(),this.experimentsEnabler.isRemoveBookingsDetailsEnabled()&&(this.bookingDataSrv.setLocation(a.bookedLocationInfo),this.bookingDataSrv.setPayment(a.bookedPayment),this.bookingDataSrv.setVideoConferenceLink(a.bookedVideoConferenceLink)),a.isPaymentRequired()?(this.bookingDataSrv.setOrderId(a.externalOrderId),this.bookingDataSrv.setBookingId(a.bookingId),this.registerPaymentResult(c.TENTATIVE)):(a.isWixPaymentDown()&&this.bookingDataSrv.setIsWixPaymentDown(!0),this.registerPaymentResult(c.OFFLINE)),this.validateBookingDataSrv.setBookingInfoForValidation(new e(f.BOOK_NEW,b.scheduleInfo.type,a.bookingId,a.isPaymentRequired()?g.ONLINE:g.OFFLINE,b.scheduleInfo.timeSlot.id))},a.prototype.isConflictServerError=function(a){return a&&a.data&&a.status===b.BOOKINGS_HTTP_ERROR_CODES.CONFLICT_ERROR},a.prototype.isSlotNotAvailable=function(a){return a.errorCode===b.BOOKINGS_SERVER_RESPONSE_ERROR_CODES.SLOT_NOT_AVAILABLE},a.prototype.isServiceNotAvailable=function(a){return a.errorCode===b.BOOKINGS_SERVER_RESPONSE_ERROR_CODES.SERVICE_NOT_AVAILABLE},a.prototype.isGeneralError=function(a){return a&&a.status===b.BOOKINGS_HTTP_ERROR_CODES.GENERAL_ERROR},a.prototype.isDummy=function(){return this.appointmentService.getSelectedOffering().dummy},a.prototype.logBookingTransactionStart=function(){this.navigationMonitoring.logStart("create-booking")},a.prototype.logBookingTransactionEnd=function(){this.navigationMonitoring.logEnd()},a}();b.ProcessBookingSrv=i,angular.module("schedulerAngularClientAppInternal").service("processBookingSrv",i)}(c=b.services||(b.services={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.bookings.visitor.payments.PaymentFactory,d=function(){function a(a,b,c,d,e,f,g,h){this.cacheSrv=a,this.bookingApiSrv=b,this.validateBookingDataSrv=c,this.overEditor=d,this.$q=e,this.experimentsEnabler=f,this.appointmentService=g,this.businessInfoSrv=h}return a.$inject=["cacheSrv","bookingApiSrv","validateBookingDataSrv","overEditor","$q","experimentsEnabler","appointmentService","businessInfoSrv"],a.prototype.setOrderId=function(a){this.cacheSrv.setToCache("orderId",a)},a.prototype.setLocation=function(a){this.cacheSrv.setToCache("location",a)},a.prototype.setPayment=function(a){this.cacheSrv.setToCache("payment",a)},a.prototype.getOrderId=function(){return this.cacheSrv.getFromCache("orderId")},a.prototype.setBookingId=function(a){this.cacheSrv.setToCache("bookingId",a)},a.prototype.getBookingId=function(){return this.cacheSrv.getFromCache("bookingId")},a.prototype.getLocation=function(){return this.cacheSrv.getFromCache("location")},a.prototype.getPayment=function(){return this.cacheSrv.getFromCache("payment")},a.prototype.getVideoConferenceLink=function(){return this.cacheSrv.getFromCache("videoConferenceLink")},a.prototype.setVideoConferenceLink=function(a){return this.cacheSrv.setToCache("videoConferenceLink",a)},a.prototype.clearBookingIdKey=function(){this.cacheSrv.clearKey("bookingId")},a.prototype.setIsWixPaymentDown=function(a){this.cacheSrv.setToCache("wixPaymentDown",a)},a.prototype.getIsWixPaymentDown=function(){return this.cacheSrv.getFromCache("wixPaymentDown")},a.prototype.clearWixPaymentDownKey=function(){this.cacheSrv.clearKey("wixPaymentDown")},a.prototype.getBookedLocation=function(){var a=this;try{if(this.overEditor.isDemoFlow)return this.businessInfoSrv.gettingBusinessInfo().then(function(a){return a.formattedAddress});if(this.experimentsEnabler.isRemoveBookingsDetailsEnabled())return this.$q.when(this.getLocation());var b=this.validateBookingDataSrv.getBookingInfoForValidation();return this.bookingApiSrv.gettingBookingDetails(b).then(function(a){var b=a.locationInfo;return b}).catch(function(){return a.$q.when("")})}catch(c){return this.$q.when("")}},a.prototype.getBookedPayment=function(){var a=this;try{if(this.overEditor.isDemoFlow){var b=this.createFakeBookedPaymentAccordingToFlow();return this.$q.when(b)}if(this.experimentsEnabler.isRemoveBookingsDetailsEnabled()){var d=this.getPayment();return this.$q.when(c.fromDto(this.overEditor.enrichBookingPaymentIfOverEditor(d)))}var e=this.validateBookingDataSrv.getBookingInfoForValidation();return this.bookingApiSrv.gettingBookingDetails(e).then(function(b){var d=b.payment;return c.fromDto(a.overEditor.enrichBookingPaymentIfOverEditor(d))}).catch(function(){return a.getBookedPaymentNotExistsInServerResult()})}catch(f){return this.$q.when(this.getBookedPaymentNotExistsInServerResult())}},a.prototype.getBookedVideoConferenceLink=function(){return this.experimentsEnabler.isRemoveBookingsDetailsEnabled()?this.getVideoConferenceLink():""},a.prototype.getBookedPaymentNotExistsInServerResult=function(){return c.fromDto(this.overEditor.enrichBookingPaymentIfOverEditor(void 0))},a.prototype.createFakeBookedPaymentAccordingToFlow=function(){var a=this.appointmentService.getSelectedOffering(),b=a.isFree?{priceText:"Free",type:"customPayment"}:{currency:a.currency,paid:0,price:a.price,priceAfterDiscount:a.price,type:"paymentWithDiscountAllow"};return c.fromDto(this.overEditor.enrichBookingPaymentIfOverEditor(b))},a}();b.BookingDataSrv=d,angular.module("schedulerAngularClientAppInternal").service("bookingDataSrv",d)}(c=b.services||(b.services={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e){this.$q=a,this.boostInjectionPersister=b,this.appointmentService=c,this.offeringDetailsGetterSrv=d,this.offeringsListGetterSrv=e}return a.$inject=["$q","boostInjectionPersister","appointmentService","offeringDetailsGetterSrv","offeringsListGetterSrv"],a.prototype.selected=function(){return this.$q.all([this.findInjected(),this.findSelected()]).then(function(a){var b=a[0],c=a[1];return c||b})},a.prototype.find=function(a){return this.offeringsListGetterSrv.getBy(a).then(function(a){return null!==a?SelectedOfferingDomain.fromDto(a.toLegacyService()):null})},a.prototype.findSelected=function(){return this.appointmentService.getSelectedOffering()},a.prototype.findInjectedDeepLink=function(){var a=this.boostInjectionPersister.getOfferingId(),b=!1;return a?this.offeringDetailsGetterSrv.gettingSelectedOfferingById(a,b):this.findInjected()},a.prototype.findInjected=function(){var a=this.boostInjectionPersister.getOfferingId();return this.find(a)},a}();a.OfferingLocator=b,angular.module("schedulerAngularClientAppInternal").service("offeringFinder",b)}(b=a.offering||(a.offering={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a,b,c,d,e,f,g){this.offeringsApi=a,this.visitorStaffSrv=b,this.accountManagementApiSrv=c,this.$q=d,this.experimentsEnabler=e,this.overEditor=f,this.membershipSrv=g}return b.$inject=["offeringsApi","visitorStaffSrv","accountManagementApiSrv","$q","experimentsEnabler","overEditor","membershipSrv"],b.prototype.gettingById=function(b,c){var d=this;return c?this.$q.when(a.OfferingFactory.fromDto(this.overEditor.enrichOfferingDetailsIfOverEditor(null))):this.offeringsApi.gettingOfferingDetailsById(b).then(function(b){return d.membershipSrv.isPricingPlanInstalled().then(function(c){return a.OfferingFactory.fromDto(d.overEditor.enrichOfferingDetailsIfOverEditor(b),c)
})})},b.prototype.gettingSelectedOfferingById=function(b,c){var d=this;return this.$q.all([this.gettingById(b,c),this.visitorStaffSrv.gettingStaffMembers()]).then(function(b){var c=b[0],e=b[1];if(c&&d.experimentsEnabler.isUseGetAvailabilityForCourseEnabled()){var f=c.schedule.scheduleIds[0];if(c.type===OfferingType.COURSE)return d.offeringsApi.getOfferingAvailabilityByScheduleId(f).then(function(b){var d=b.available;return a.SelectedOfferingDomain.fromOfferingDomain(c,e,d)})}return a.SelectedOfferingDomain.fromOfferingDomain(c,e)})},b}();a.OfferingDetailsGetterSrv=b,angular.module("schedulerAngularClientAppInternal").service("offeringDetailsGetterSrv",b)}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e){this.businessInfoSrv=a,this.$translate=b,this.DateDefaults=c,this.$q=d,this.appConfig=e}return a.$inject=["businessInfoSrv","$translate","DateDefaults","$q","appConfig"],a.prototype.formatOpeningDateForBooking=function(a){var b=this;return this.businessInfoSrv.gettingBusinessInfo().then(function(a){return a.timeZone}).then(function(c){return b.formatDateForBooking(a,c)})},a.prototype.formatDateForBooking=function(a,b){if(a.offeringDetails.type===OfferingType.COURSE){var c=moment.tz(a.start,b);return this.formatOpeningDateForCourse(c)}return this.formatOpeningDateForNonCourse(a,b)},a.prototype.formatOpeningDateForCourse=function(a){var b=moment().startOf("day"),c=b.format("YYYY")===a.format("YYYY"),d=a.isBefore(b)?".passed":"",e=this.$translate(c?"offering-schedule-summary.course"+d+".same-year":"offering-schedule-summary.course"+d+".different-year");return a.format(e)},a.prototype.formatOpeningDateForNonCourse=function(a,b){var c=this.appConfig.getIsMobile()?"account-management.bookings.time-format-mobile":"account-management.bookings.time-format";return moment.tz(a.start,b).format(this.$translate(c))},a}();a.OfferingTimeFormatterSrv=b,angular.module("schedulerAngularClientAppInternal").service("offeringTimeFormatterSrv",b)}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.premiumService=a,this.overEditor=b}return a.$inject=["premiumService","overEditor"],a.prototype.isOfferingAllowedForSelectionByPremium=function(a){return this.premiumService.isOfferingTypeFeatureEnabled(a)||this.overEditor.isDemoFlow},a.prototype.isOfferingConnectedToPricingPlan=function(a){return!!a.pricingPlanInfo.pricingPlans.length},a.prototype.isOfferingOfferedAsPricingPlan=function(a){return a.offeredAs.indexOf(OfferedAsType.PRICING_PLAN)>-1},a.prototype.isCalendarDeepLinkAllowed=function(a){return!!a},a.prototype.isOfferingBookableTroughCalendar=function(a){return this.isOfferingExpired(a)?!1:this.isOfferingAllowedForSelectionByPremium(a.type)?a.uouHidden?!1:!0:!1},a.prototype.isOfferingExpired=function(a){var b=new Date,c=a.type===OfferingType.COURSE?a.startDate:a.endDate;return c?new Date(c).getTime()<b.getTime():!1},a}();a.OfferingValidationsSrv=b,angular.module("schedulerAngularClientAppInternal").service("offeringValidationsSrv",b)}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.DUMMY_SITE_URL="www.someUrl.com/book-online";var b=function(){function b(a,b){this.$wix=a,this.$q=b}return b.$inject=["$wix","$q"],b.prototype.getUrl=function(){var b=this.$q.defer();return"site"===this.$wix.Utils.getViewMode()?this.$wix.Settings.getSiteInfo(function(a){var c=a.url;return b.resolve(c)}):b.resolve(a.DUMMY_SITE_URL),b.promise},b.prototype.replaceUrl=function(a){this.$wix.isOverEditor()||this.$wix.replaceState(a)},b.prototype.setCalendarPrefix=function(a){this.replaceUrl(a+"/book")},b.prototype.resetUrl=function(){this.replaceUrl(" ")},b}();a.SiteUrlManagerSrv=b,angular.module("schedulerAngularClientAppInternal").service("siteUrlManagerSrv",b)}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.FREE="FREE",a.WAITING_LIST_AVAILABLE="WAITING_LIST_AVAILABLE",a.FULL="FULL"}(b=a.GroupInstanceOccupancy||(a.GroupInstanceOccupancy={}));var c;!function(a){a.IDLE="IDLE",a.SUGGESTING="SUGGESTING",a.OPEN_TO_ALL="OPEN_TO_ALL"}(c=a.WaitingListStatus||(a.WaitingListStatus={}))}(b=a.groups||(a.groups={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.boost.visitor.groups.GroupInstanceOccupancy,d=function(){function a(a,b,c,d,e,f,g,h,i){this.visitorApi=a,this.$translate=b,this.$q=c,this.overEditor=d,this.visitorStaffSrv=e,this.experimentsEnabler=f,this.$timeout=g,this.businessInfoSrv=h,this.appointmentService=i}return a.$inject=["visitorApi","$translate","$q","overEditor","visitorStaffSrv","experimentsEnabler","$timeout","businessInfoSrv","appointmentService"],a.prototype.notifyingNonPremiumEnrollmentAttempt=function(){return this.visitorApi.notifyingNonPremiumEnrollmentAttempt()},a.prototype.gettingGroupsInstances=function(a,b){var c,d=this;if(this.isOnDemoMode(a))c=this.$q.when(this.$timeout(function(){return d.visitorStaffSrv.gettingStaffMembers().then(function(a){return d.overEditor.getClassesInstancesIfOverEditor(b,a)})}));else{var e=this.createRangeWithTimeZoneCompensation(b);c=this.visitorApi.gettingGroupsInstances({id:a,dateRange:e}).then(function(a){return d.filterClassInstanceByDatRange(a,b)})}return c.then(function(a){return d.markGroupInstancesAvailability(a)})},a.prototype.gettingFutureGroupInstances=function(a,b){var c=moment().valueOf();return this.gettingGroupsInstances(a,b).then(function(a){return a.classesInstances=a.classesInstances.filter(function(a){return a.start>c}),a})},a.prototype.isOnDemoMode=function(a){return!a},a.prototype.createRangeWithTimeZoneCompensation=function(a){return{start:a.start.clone().subtract(1,"days"),end:a.end.clone().add(1,"days")}},a.prototype.filterClassInstanceByDatRange=function(a,b){var c=Object.assign({},a);return c.classesInstances=a.classesInstances.filter(function(a){return moment(a.start).isBetween(b.start,b.end,null,"[)")}),c},a.prototype.convertInstancesToAvailableTimeSlots=function(a,b,c){for(var d,e=["mon","tue","wed","thu","fri","sat","sun"],f={},g=0;g<e.length;g++)f[e[g]]=[];for(var h=this.visitorStaffSrv.createId2StaffMemberMap(c),i=this.groupInstancesByTime(a),g=0;g<i.length;g++){d=moment.tz(i[g][0].start,b).isoWeekday()-1;var j=i[g],k=this.createGroupInstancesTimeSlot(j,h);f[e[d]].push(k)}return this.sortTimeSlots(e,f),f},a.prototype.createGroupInstancesTimeSlot=function(a,b){return{instances:a,availableStaff:this.visitorStaffSrv.getStaffListByStaffMap(a.map(function(a){return a.staffMemberId}),b),staffStatus:a.reduce(function(a,b){return a.set(b.staffMemberId,{occupancy:b.occupancy}),a},new Map)}},a.prototype.sortTimeSlots=function(a,b){for(var c=0;c<a.length;c++)b[a[c]].sort(function(a,b){var c=a.instances[0],d=b.instances[0];return c.start-d.start})},a.prototype.getDatesWithInstances=function(a,b){var c=[];return a.forEach(function(a){var d=moment.tz(a.start,b).startOf("day").valueOf();-1===c.indexOf(d)&&c.push(d)}),c},a.prototype.getFutureInstancesWithVacancyOnGivenDay=function(a,b){var c=this,d=moment();return a.filter(function(a){var e=moment(a.start);return b.isSame(e,"day")&&e.isAfter(d)&&c.isInstanceAvailable(a)})},a.prototype.getAvailableInstances=function(a){var b=this,c=moment();return a.filter(function(a){return moment(a.start).isAfter(c)&&b.isInstanceAvailable(a)})},a.prototype.getInstanceById=function(a,b){return a.filter(function(a){return a.id===b})[0]},a.prototype.isInstanceAvailable=function(a){return a.occupancy!==c.FULL},a.prototype.getFirstAvailableSlotForPrototype=function(a){if(!a||!a.id||a.dummy)return this.$q.when(this.overEditor.getFirstAvailableSlotForService());var b=a.id;return this.$q.all([this.businessInfoSrv.gettingBusinessInfo(),this.getFirstRequiredSlotForGroup({groupProtoId:b})]).then(function(a){var b=a[0],c=a[1];return moment.tz(+c.slot,b.timeZone)})},a.prototype.getFirstRequiredSlotForGroup=function(a){var b=this.appointmentService.getCurrentBooking();return b?this.$q.when({slot:b.start}):this.visitorApi.getFirstAvailableSlotForGroupPrototype(a)},a.prototype.groupInstancesByTime=function(a){var b=[],c={};return a.forEach(function(a){c[a.start]||(c[a.start]=[]),c[a.start].push(a)}),Object.keys(c).forEach(function(a){b.push(c[a])}),b},a.prototype.getGroupOccupancy=function(a,d){var e=(a.registered||0)+d<=a.capacity,f=this.experimentsEnabler.isWaitListWithDoubleBookingEnabled()&&a.waitingListStatus===b.WaitingListStatus.SUGGESTING,g=this.experimentsEnabler.isViewerWaitlistModalEnabled()?a.waitingListSpots&&a.waitingListSpots>0:!1;return e&&!f?c.FREE:g?c.WAITING_LIST_AVAILABLE:c.FULL},a.prototype.markGroupInstancesAvailability=function(a){var b=this,c=this.appointmentService.getCurrentBooking(),d=c&&c.numOfParticipants||1,e=a.classesInstances.map(function(a){var c=b.getGroupOccupancy(a,d);return __assign({},a,{occupancy:c})});return __assign({},a,{classesInstances:e})},a}();b.GroupsService=d,angular.module("schedulerGroupAppInternal").service("groupsSrv",d)}(c=b.groups||(b.groups={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.visitor.preview.ModalTypes,d=a.boost.visitor.groups.GroupInstanceOccupancy,e=a.boost.common.constants.Timezones,f=a.bookings.common.domain.DefaultTimezoneOptions,g=function(){function b(a,b,d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I){this.libs=a,this.$translate=b,this.groupsSrv=d,this.appointmentService=f,this.DateDefaults=h,this.$scope=i,this.$rootScope=j,this.CALENDAR_EVENTS=k,this.visitorBILogger=l,this.visitorStaffSrv=m,this.$filter=n,this.flowManagerSrv=o,this.$timeout=p,this.$element=q,this.offeringValidationsSrv=r,this.boostInjectionPersister=s,this.experimentsEnabler=t,this.pricingPlanTPANavigator=u,this.nextLabelSrv=v,this.userPurchasedPlanSrv=w,this.overEditor=x,this.premiumService=y,this.previewModalSrv=z,this.bookingProcess=A,this.membershipSrv=B,this.bookingsLocalizationSrv=C,this.siteUrlManagerSrv=D,this.visitorTimezoneSrv=E,this.routeManager=F,this.clientPages=G,this.$routeParams=H,this.futureBookingSrv=I,this.isActionComplete=!1,this.displayFutureBookingMessage=!1,this.pickerOpened=!1,this.blockProgressWithMsg="",this.sideBarErrorMessage="",this.firstUsablePurchasedPricingPlan=null,this.shouldShowCalendarErrorMessage=!1,this.isTimezoneIndicationImprovementEnabled=t.isBookingsTimezoneIndicatorImprovementEnabled(),this.isUoUCTAEnabled=t.isUoUCTAEnabled(),this.businessInfo=g.current.locals.businessInfo,this.isTimezoneNoteOnly=!this.businessInfo.timezoneProperties.clientCanChooseTimezone,this.isTimezoneIndicationImprovementEnabled?(this.currentTimezone=this.determineInitialTimezone(H.timezone),this.visitorBILogger.logTimezone()):this.currentTimezone=e.BUSINESS,this.selectedOffering=this.appointmentService.getSelectedOffering(),this.siteUrlManagerSrv.setCalendarPrefix(this.selectedOffering.urlName),this.firstAvailableDate=g.current.locals.firstAvailableDate,this.staff=g.current.locals.staff,this.populateValidStaffMembers(),this.updateSelectedWeekPerSelectedDate(this.firstAvailableDate),this.registerEventListeners(),this.libs.$(".aria-page-title").html(""),this.libs.$(".aria-page-title").attr("aria-hidden",!1),this.offeringValidationsSrv.isOfferingBookableTroughCalendar(this.selectedOffering)||(this.blockProgressWithMsg="offering-list.premium-not-enabled.message"),this.overEditor.isOverEditor&&!this.premiumService.isOfferingTypeFeatureEnabled(this.selectedOffering.type)&&this.previewModalSrv.openModal(c.PREVIEW_PREMIUM_MODAL),this.datePickerOptions={isRTL:this.bookingsLocalizationSrv.isRTL(),showWeeks:!1,showButtonBar:!1,startingDay:this.bookingsLocalizationSrv.getFirstDayOfWeek(),maxMode:"day"},this.daysOrder=this.bookingsLocalizationSrv.getBookingsWeekdays()}return b.$inject=["libs","$translate","groupsSrv","appointmentService","$route","DateDefaults","$scope","$rootScope","CALENDAR_EVENTS","visitorBILogger","visitorStaffSrv","$filter","flowManagerSrv","$timeout","$element","offeringValidationsSrv","boostInjectionPersister","experimentsEnabler","pricingPlanTPANavigator","nextLabelSrv","userPurchasedPlanSrv","overEditor","premiumService","previewModalSrv","bookingProcess","membershipSrv","bookingsLocalizationSrv","siteUrlManagerSrv","visitorTimezoneSrv","routeManager","clientPages","$routeParams","futureBookingSrv"],Object.defineProperty(b.prototype,"actionLabel",{get:function(){return this.isWaitingListSlotSelected()?this.nextLabelSrv.getJoinWaitingListLabel():this.showMultipleOfferedAsLabel()?this.nextLabelSrv.getMultipleOfferedAsLabel():this.isPricingPlanOffering()&&this.slot&&!this.hasValidPlan()?this.nextLabelSrv.getGroupViewPricingPlanLabel():this.nextLabelSrv.getLabel({isLastStep:!1,onlinePaymentLabel:"",offlinePaymentLabel:""})},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"ariaActionLabel",{get:function(){return this.nextLabelSrv.getAriaLabel({isLastStep:!1,onlinePaymentLabel:"",offlinePaymentLabel:"",isNextStepDisabled:this.isActionComplete,isWaitingListFlow:this.isWaitingListSlotSelected()})},enumerable:!0,configurable:!0}),b.prototype.$onInit=function(){var b=this;this.$timeout(function(){b.libs.$(".aria-page-title").html(b.ariaLabelPageAlert())},1500),this.$timeout(function(){b.libs.$(".aria-page-title").html("")},2e3),this.$timeout(function(){b.libs.$(".user-login__action").focus()},5e3),this.firstAvailableDate&&this.experimentsEnabler.isBookingsPackagesEnabled()&&this.selectedOffering.isPricingPlanOffering()&&this.membershipSrv.getAvailablePricingPlan(this.firstAvailableDate.valueOf(),this.selectedOffering.id).then(function(c){b.firstUsablePurchasedPricingPlan=a.visitor.booking.PurchasedPricingPlanFactory.fromDto(c,b.businessInfo.timeZone)})},b.prototype.determineInitialTimezone=function(a){var b=this.appointmentService.getSelectedTime();return angular.isDefined(a)?+a:b?this.businessTimezone&&b.timeZone===this.businessTimezone.name?e.BUSINESS:e.USER:this.businessInfo.timezoneProperties.defaultTimezone===f.BUSINESS?e.BUSINESS:e.USER},b.prototype.ariaLabelPageAlert=function(){return this.$translate("visitor.groups.calendar.accessibility.alert-title",{serviceName:this.selectedOffering.name})},b.prototype.populateValidStaffMembers=function(){this.availableStaffMembers=this.visitorStaffSrv.getCapableStaffForCalendarSlotsByStaff(this.staff).map(function(a){return{value:a.id,label:a.fullName}}),this.availableStaffMembers=this.$filter(OrderByLowerCase.FILTER_NAME)(this.availableStaffMembers,"label")},b.prototype.updateSelectedWeekPerSelectedDate=function(a){var b=this;this.splitInstances={},a=a||moment();var c=this.bookingsLocalizationSrv.getStartOfWeekForLocale(a.clone()),d=this.bookingsLocalizationSrv.getEndOfWeekForLocale(a.clone());this.currentWeek={start:c,end:d};var e=this.selectedOffering.dummy?null:this.selectedOffering.id;this.groupsSrv.gettingFutureGroupInstances(e,this.currentWeek).then(function(a){b.classInstances=a.classesInstances,b.updateInstancesModel()}).catch(function(){b.shouldShowCalendarErrorMessage=b.experimentsEnabler.isCalendarFailedErrorMessageUOUEnabled()})},b.prototype.updateInstancesModel=function(){var a=this,b=this.selectedStaffMemberId?this.classInstances.filter(function(b){return b.staffMemberId===a.selectedStaffMemberId}):this.classInstances;this.splitInstances=this.groupsSrv.convertInstancesToAvailableTimeSlots(b,this.currentTimezoneString(),this.staff),this.$rootScope.$broadcast(this.CALENDAR_EVENTS.GROUPS_DATA_FETCHED),this.displayFutureBookingMessage=this.selectedOffering.futureBookingsPolicy&&this.isWeekHaveUnavailableSlots()},b.prototype.isWeekHaveUnavailableSlots=function(){var a=this.selectedOffering.futureBookingsPolicy,b=a.shouldLimit,c=a.limitXMinutesToTheFuture,d=this.splitInstances,e=d.sun,f=d.mon,g=d.tue,h=d.wed,i=d.thu,j=d.fri,k=d.sat;return this.isDayHaveUnavailableSlots(e,b,c)||this.isDayHaveUnavailableSlots(f,b,c)||this.isDayHaveUnavailableSlots(g,b,c)||this.isDayHaveUnavailableSlots(h,b,c)||this.isDayHaveUnavailableSlots(i,b,c)||this.isDayHaveUnavailableSlots(j,b,c)||this.isDayHaveUnavailableSlots(k,b,c)},b.prototype.isDayHaveUnavailableSlots=function(a,b,c){return!this.futureBookingSrv.isTimeStampsInBookingWindow({shouldLimit:b,limitXMinutesToTheFuture:c,timeStamps:a.map(function(a){return a.instances[0].start})})},b.prototype.showMultipleOfferedAsLabel=function(){return!!this.bookedAs},b.prototype.getFormattedDateRange=function(){return this.getFormattedDateRangeByDelimiter()},b.prototype.getFormattedDateRangeAria=function(){return this.getFormattedDateRangeByDelimiter(this.$translate("visitor.calendar.range-aria-delimiter"))},b.prototype.getFormattedDateRangeByDelimiter=function(a){return this.libs.$.fullCalendar.formatRange(this.currentWeek.start,this.currentWeek.end,this.$translate("visitor.calendar.range-date-format"),a)},b.prototype.goToNextWeek=function(){this.promoteWeekByAmount(1)},b.prototype.goToPrevWeek=function(){this.promoteWeekByAmount(-1)},b.prototype.goToToday=function(){this.visitorBILogger.todayClick(),this.updateSelectedWeekPerSelectedDate(moment.tz(this.businessInfo.timeZone))},b.prototype.goBack=function(){this.visitorBILogger.backButtonPressed("groups_calendar","GROUP"),this.flowManagerSrv.prev()},b.prototype.showBackButton=function(){return!this.overEditor.isPreviewMode()},b.prototype.goToNextPage=function(){this.isWaitingListSlotSelected()?(this.visitorBILogger.logJoinWaitingListCtaClicked(),this.previewModalSrv.openModal(c.WAITLIST_MODAL)):this.isUoUCTAEnabled&&!this.isActionComplete?(this.sideBarErrorMessage="sidebar.next.calendar.error-message",this.visitorBILogger.sendNextFailed({referralInfo:"calendar",errorReason:this.slot?"missing-staff":"missing-slot"})):(this.storeSlotData(),this.visitorBILogger.sendNext({referralInfo:"date&time"}),this.isBookedByPricingPlan()&&!this.hasValidPlan()?this.pricingPlanTPANavigator.navigate(this.selectedOffering.pricingPlanInfo.pricingPlans):this.flowManagerSrv.next())},b.prototype.isBookedByPricingPlan=function(){return this.bookedAs===OfferedAsType.PRICING_PLAN},b.prototype.currentTimezoneString=function(){return this.currentTimezone===e.BUSINESS?this.businessTimezone.name:this.userTimezone.name},b.prototype.getDayByIndex=function(a){return this.currentWeek.start.clone().add(a,"day").format(this.DateDefaults.DATE_FORMAT)},b.prototype.triggerDatePicker=function(a){this.pickerOpened?this.pickerOpened=!1:(a.preventDefault(),a.stopPropagation(),this.pickerOpened=!0)},b.prototype.disabled=function(a,b){var c=new Date;return"day"===b&&c>a},b.prototype.onStaffMemberFilterSelected=function(a){this.selectedStaffMemberId!==a&&(this.selectedStaffMemberId=a,this.updateInstancesModel())},b.prototype.promoteWeekByAmount=function(a){var b=this.currentWeek.start.clone().add(a,"week");this.updateSelectedWeekPerSelectedDate(b)},b.prototype.focusOnDateRangePicker=function(){this.$element.find('[data-hook="groups-calendar-date-range"]').focus()},b.prototype.isPricingPlanOffering=function(){return this.selectedOffering.isPricingPlanOffering()},b.prototype.durationInMinutes=function(){return this.selectedOffering.futureBookingsPolicy.limitXMinutesToTheFuture},b.prototype.closeFutureBookingPolicyMessage=function(){this.displayFutureBookingMessage=!1},b.prototype.registerEventListeners=function(){var a=this;this.$scope.$on(this.CALENDAR_EVENTS.SLOT_SELECTED,function(b,c){a.isActionComplete=!!c.getStaff(),a.visitorBILogger.selectSlot(),a.slot=c,a.isPricingPlanOffering()&&a.handlePlanWhenSlotChanged(),a.isActionComplete&&(a.sideBarErrorMessage="",a.$rootScope.$broadcast(a.CALENDAR_EVENTS.SLOT_WITH_STAFF_SELECTED))}),this.$scope.$watch(function(){return a.selectedDate},function(b){b&&(a.pickerOpened=!1,a.updateSelectedWeekPerSelectedDate(moment.tz(b,a.currentTimezoneString())),a.focusOnDateRangePicker())}),this.$scope.$on(PricingPlanConst.BOOKING_METHOD_SELECTED,function(b,c){return a.handleBookedAsChange(c)})},b.prototype.handleBookedAsChange=function(a){this.bookedAs=a},b.prototype.getBookedAs=function(){return this.bookingProcess.calculateBookingMethod(this.selectedOffering,this.bookedAs)},b.prototype.storeSlotData=function(){var a={startTime:""+this.slot.groupInstance.start,endTime:""+this.slot.groupInstance.end,timeZone:this.slot.timezone,staffMember:this.slot.getStaff(),groupInstance:this.slot.groupInstance,purchasedPricingPlan:this.slot.getPurchasedPricingPlan(),bookedAs:this.getBookedAs()};this.appointmentService.setSelectedTime(a)},b.prototype.handlePlanWhenSlotChanged=function(){var a=this;return this.userPurchasedPlanSrv.bookableSelected(this.slot.getTime().valueOf()).then(function(b){return a.slot.setPurchasedPricingPlan(b),a.$rootScope.$emit("CALENDAR_EVENTS.SLOT_UPDATED",a.slot),b})},b.prototype.hasValidPlan=function(){return!!this.slot.getPurchasedPricingPlan()},b.prototype.isWaitingListSlotSelected=function(){return this.slot&&this.slot.groupInstance&&this.slot.groupInstance.occupancy===d.WAITING_LIST_AVAILABLE},Object.defineProperty(b.prototype,"numOfStaff",{get:function(){return this.staff?this.staff.staff.length:0},enumerable:!0,configurable:!0}),b.prototype.allowTimezoneSwitch=function(){return this.isTimezoneIndicationImprovementEnabled&&!this.visitorTimezoneSrv.isBusinessTimezoneEqualToVisitorTimezone(this.businessTimezone,this.userTimezone)},b.prototype.onTimezoneSwitch=function(a){var b=this.selectedOffering.type,c="calendar";this.visitorBILogger.timezoneSwitched({timezone:a,type:b,referralInfo:c}),this.routeManager.gotoPage(this.clientPages.VISITOR_GROUPS_CALENDAR+"/"+a)},b}();b.GroupsCalendar=g,angular.module("schedulerAngularClientAppInternal").directive("boostGroupsCalendar",function(){return{templateUrl:"modules/visitor/groups/groups-calendar.preload.html",controller:g,controllerAs:"groupsCalendar",bindToController:!0,restrict:"E",scope:{businessTimezone:"=",userTimezone:"="}}})}(c=b.groups||(b.groups={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(){var b=a.boost.visitor.calendar.TimeSlotOption,c=function(){function a(a,b,c,d,e,f,g,h,i){this.appointmentService=a,this.CALENDAR_EVENTS=b,this.$rootScope=d,this.DateDefaults=e,this.groupsSrv=f,this.$timeout=g,this.futureBookingSrv=h,this.bookingsLocalizationSrv=i,this.todayDate=new Date,this.selectedOffering=a.getSelectedOffering(),this.timeFormat=c("visitor.time-format"),this.fullSlotLabel=c("visitor.groups.calendar.full"),this.dayOfMonthFormat=c("visitor.calendar-header-day-of-month-format"),this.dayOfWeekFormat=c("visitor.short-day-of-week-format"),this.registerDateSelectionChanges(),this.initialize()}return a.$inject=["appointmentService","CALENDAR_EVENTS","$translate","$rootScope","DateDefaults","groupsSrv","$timeout","futureBookingSrv","bookingsLocalizationSrv"],a.prototype.initialize=function(){this.isRepresentingToday=moment.tz(this.calendarDayTimezone).format(this.DateDefaults.DATE_FORMAT)===this.calendarDay,this.calendarDayMoment=moment.tz(this.calendarDay,this.calendarDayTimezone)},a.prototype.hasSlotsThisDay=function(){return this.calendarDayList&&this.calendarDayList.length>0},a.prototype.isSingleGroupFull=function(a){var b=this,c=!0;return a.instances.forEach(function(a){c=c&&!b.groupsSrv.isInstanceAvailable(a)}),c},a.prototype.isInstancePassedDue=function(a){return a.instances[0].start<this.todayDate.getTime()},a.prototype.isSlotBookingWindow=function(a){if(this.selectedOffering.futureBookingsPolicy){var b=this.selectedOffering.futureBookingsPolicy,c=b.shouldLimit,d=b.limitXMinutesToTheFuture;return this.futureBookingSrv.isTimeInBookingWindow({shouldLimit:c,limitXMinutesToTheFuture:d,startTime:moment(a.instances[0].start)})}return!0},a.prototype.isSingleGroupUnavailable=function(a){return this.isSingleGroupFull(a)||this.isInstancePassedDue(a)||!this.isSlotBookingWindow(a)},a.prototype.getSingleGroupLabel=function(a){return moment.tz(a.instances[0].start,this.calendarDayTimezone).format(this.timeFormat)},a.prototype.closeGroupInstanceTooltip=function(a){a.isOpen=!1},a.prototype.getSingleGroupAriaLabel=function(a){return moment.tz(a.instances[0].start,this.calendarDayTimezone).format("MMMM D "+this.timeFormat+" ")+(this.isSingleGroupFull(a)?this.fullSlotLabel:"")},a.prototype.slotSelected=function(a){var b=this;this.isSingleGroupUnavailable(a)||(this.selectedInstance=a,a.instances.length>1?(this.$timeout(function(){b.selectedInstance.isOpen=!0}),this.deselectPrevSlot(),this.notifySlotSelected(a.instances[0],null)):this.selectGroupInstance(a.instances[0]))},a.prototype.deselectPrevSlot=function(){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.SLOT_DESELECTED)},a.prototype.isGroupSlotSelected=function(a){return a===this.selectedInstance},a.prototype.selectStaffMemberInSlot=function(a){var b=this;this.selectedInstance.instances.forEach(function(c){c.staffMemberId===a&&b.selectGroupInstance(c)})},a.prototype.isDayLeftmost=function(){var a=this.bookingsLocalizationSrv.isRTL(),b=this.bookingsLocalizationSrv.getFirstDayOfWeek();return a?(6+b)%7===this.calendarDayMoment.day():b===this.calendarDayMoment.day()},a.prototype.getDayOffset=function(){return this.isDayLeftmost()&&"left"||"none"},a.prototype.getDayNumber=function(a){return void 0===a&&(a=!1),this.calendarDayMoment.day()},a.prototype.accessibilityLabel=function(){return this.calendarDayMoment.format("dddd MM/DD/YYYY")},a.prototype.elementIdFor=function(a){return"instance-label-"+this.getDayNumber()+"-"+a},a.prototype.tabIndexFor=function(){return+this.calendarDayMoment.format("D")},a.prototype.selectGroupInstance=function(a){var b=this.getStaffById(a.staffMemberId);this.notifySlotSelected(a,b)},a.prototype.notifySlotSelected=function(a,c){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.SLOT_SELECTED,new b(a.start,this.calendarDayTimezone,c,a))},a.prototype.getStaffById=function(a){return this.staff.staff.filter(function(b){return b.id===a})[0]},a.prototype.registerDateSelectionChanges=function(){var a=this;this.$rootScope.$on(this.CALENDAR_EVENTS.SLOT_SELECTED,function(b,c){a.calendarDay!==c.getTime().format(a.DateDefaults.DATE_FORMAT)&&(a.selectedInstance=void 0)}),this.$rootScope.$on(this.CALENDAR_EVENTS.GROUPS_DATA_FETCHED,function(){a.initialize()})},Object.defineProperty(a.prototype,"dayOfWeek",{get:function(){return this.calendarDayMoment.format("ddd").toLowerCase()},enumerable:!0,configurable:!0}),a}();angular.module("schedulerAngularClientAppInternal").directive("boostGroupsCalendarDay",function(){return{templateUrl:"modules/visitor/groups/groups-calendar-day.preload.html",controller:c,controllerAs:"groupsCalendarDay",bindToController:!0,restrict:"E",scope:{calendarDay:"=",calendarDayList:"=",calendarDayTimezone:"=",staff:"="}}})}(c=b.groups||(b.groups={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(){var a=function(){function a(a,b){var c=this;this.showTimezoneNote=!1,b.gettingUserTimezoneNote(a.boostTimezoneNote).then(function(a){c.formattedMessage=a,c.showTimezoneNote=!!a})}return a.$inject=["$attrs","visitorTimezoneSrv"],a}();angular.module("schedulerAngularClientAppInternal").directive("boostTimezoneNote",function(){return{template:'<div class="timezone-note" data-hook="timezone-note" ng-if="timezoneNoteCtrl.showTimezoneNote">{{timezoneNoteCtrl.formattedMessage}}</div>',controller:a,controllerAs:"timezoneNoteCtrl",bindToController:!0,restrict:"A"}})}(b=a.common||(a.common={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(){var a=function(){function a(a){this.$scope=a}return a.$inject=["$scope"],Object.defineProperty(a.prototype,"address",{get:function(){return this.resolveBksAddress()},enumerable:!0,configurable:!0}),a.prototype.resolveBksAddress=function(){return this.isServiceGivenRemotely()||this.isServiceGivenAtCustomerPlace()?this.serviceLocationText:this.isServiceGivenAtBusinessLocation()?this.isRemoteBusiness()?this.businessName:this.businessAddress:void 0},a.prototype.isRemoteBusiness=function(){return"ON_THE_GO"===this.businessLocationType},a.prototype.isServiceGivenAtBusinessLocation=function(){return"BUSINESS"===this.serviceLocationType},a.prototype.isServiceGivenRemotely=function(){return"OTHER"===this.serviceLocationType},a.prototype.isServiceGivenAtCustomerPlace=function(){return"CUSTOMER"===this.serviceLocationType},a}();angular.module("schedulerAngularClientAppInternal").component("bksAddress",{template:'<span data-hook="service-address">{{$ctrl.address}}</span><div data-hook="service-city">{{$ctrl.city}}</div>',controller:a,bindings:{serviceLocationText:"@",serviceLocationType:"@",businessLocationType:"@",businessName:"@",businessAddress:"@",city:"@"}})}(b=a.components||(a.components={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(){var a=function(){function a(){}return Object.defineProperty(a.prototype,"offeringLocation",{get:function(){return this.addressInfo.offeringLocation},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"offeringLocationText",{get:function(){return this.addressInfo.offeringLocationText},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"businessLocation",{get:function(){return this.addressInfo.businessLocation},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"businessName",{get:function(){return this.addressInfo.businessName},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"businessAddress",{get:function(){return this.addressInfo.formattedAddress||this.addressInfo.businessAddress},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"city",{get:function(){return this.addressInfo.formattedAddress?"":this.addressInfo.city},enumerable:!0,configurable:!0}),a}();angular.module("schedulerAngularClientAppInternal").component("bksOfferingAddress",{template:'<bks-address data-hook="fielded-address" \n                            service-location-type="{{$ctrl.offeringLocation}}" \n                            service-location-text="{{$ctrl.offeringLocationText}}" \n                            business-location-type="{{$ctrl.businessLocation}}" \n                            business-name="{{$ctrl.businessName}}" \n                            business-address="{{$ctrl.businessAddress}}" \n                            city="{{$ctrl.city}}"/>',controller:a,bindings:{addressInfo:"<"}})}(b=a.components||(a.components={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;
switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){this.routeManager=a,this.$route=b,this.postLoginNavigationSrv=c,this.widgetDeepLinkNavigationSrv=d,this.fallbackNavigationSrv=e,this.offeringPageNavigationSrv=f,this.bookIntentNavigationSrv=g,this.contactFormNavigationSrv=h,this.memberAreaBookAnotherDeepLinkNavigationSrv=i,this.memberAreaRescheduleDeepLinkNavigationSrv=j,this.postPricingPlanPurchasedDeepLinkNavigationSrv=k,this.overEditorNavigationSrv=l,this.navigationMonitoring=m,this.splitBookingsOverEditorNavigationSrv=n}return a.$inject=["routeManager","$route","postLoginNavigationSrv","widgetDeepLinkNavigationSrv","fallbackNavigationSrv","offeringPageNavigationSrv","bookIntentNavigationSrv","contactFormNavigationSrv","memberAreaBookAnotherDeepLinkNavigationSrv","memberAreaRescheduleDeepLinkNavigationSrv","postPricingPlanPurchasedDeepLinkNavigationSrv","overEditorNavigationSrv","navigationMonitoring","splitBookingsOverEditorNavigationSrv"],a.prototype.registerNavigationServices=function(){this.navigationServices=[this.postPricingPlanPurchasedDeepLinkNavigationSrv,this.postLoginNavigationSrv,this.contactFormNavigationSrv,this.bookIntentNavigationSrv,this.offeringPageNavigationSrv,this.widgetDeepLinkNavigationSrv,this.memberAreaBookAnotherDeepLinkNavigationSrv,this.memberAreaRescheduleDeepLinkNavigationSrv,this.overEditorNavigationSrv,this.splitBookingsOverEditorNavigationSrv,this.fallbackNavigationSrv]},a.prototype.getNavigationServiceToUse=function(){return __awaiter(this,void 0,void 0,function(){var a,b;return __generator(this,function(c){switch(c.label){case 0:a=0,c.label=1;case 1:return a<this.navigationServices.length?(b=this.navigationServices[a],[4,b.isRedirectRequired()]):[3,4];case 2:if(c.sent())return[2,b];c.label=3;case 3:return a++,[3,1];case 4:return[2,null]}})})},a.prototype.redirect=function(){return __awaiter(this,void 0,void 0,function(){var a,b;return __generator(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),this.routeManager.suspendFocus=!0,[4,this.getNavigationServiceToUse()];case 1:return a=c.sent(),a?[2,this.doServiceNavigation(a)]:[3,3];case 2:throw b=c.sent(),console.error("failed to initiate booking navigation: ",b),b;case 3:return[2]}})})},a.prototype.doServiceNavigation=function(a){var b=a.getName();return b&&this.navigationMonitoring.startInteraction(b),a.doRedirect(),b},a}();a.EntryPointNavigation=b,angular.module("schedulerAngularClientAppInternal").service("entryPointNavigationSrv",b)}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c,d=a.boost.common.constants.Timezones,e=a.visitor.booking.mapValidationResult2Status,f=a.visitor.booking.mapValidateBookingType2Transaction,g=a.visitor.booking.mapValidationSubResult2SubCategory,h=WixBookingsUoUDomain.OfferedAsType,i=a.visitor.booking.COUPONS_STATUS,j=WixBookingsUoUDomain.OfferingType;!function(a){a.WIDGET="widget"}(c=b.NavFromWidgetIntent||(b.NavFromWidgetIntent={}));var k=function(b){function c(a,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=b.call(this,a,e)||this;return p.appointmentService=c,p.commonServices=d,p.timezoneSrv=f,p.businessInfoSrv=g,p.$q=h,p.routeManager=i,p.dynamicFormSrv=j,p.userManagementSrv=k,p.overEditor=l,p.$wix=m,p.flowManagerSrv=n,p.couponsSrv=o,p}return __extends(c,b),c.$inject=["wixBiLogger","appointmentService","commonServices","$rootScope","timezoneSrv","businessInfoSrv","$q","routeManager","dynamicFormSrv","userManagementSrv","overEditor","$wix","flowManagerSrv","couponsSrv"],c.prototype.init=function(){var b=this;this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.CONTACT_INFO_SAVE_SUCCESS,function(a,c){return b.saveSuccessContactInfo(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.APPOINTMENT_BOOKED,function(a,c){return b.appointmentCreated(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.CANCELLATION_POLICY,function(){return b.cancellationPolicy()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.CHOOSE_TIME_SLOT,function(){return b.selectSlot()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.BOOK_ANOTHER,function(){return b.bookAnother()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.GOOGLE_EXPORT,function(){return b.googleCalendar()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.BOOKIT,function(a,c){return b.bookIt(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.BOOKED_GROUP_BUT_NOT_PREMUIM,function(){return b.bookedGroupButNotPremium()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.CAL_TODAY,function(){return b.todayClick()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.NEXT,function(a,c){return b.sendNext(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.NEXT_FAILED,function(a,c){return b.sendNextFailed(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.SERVICE_TYPE_WELCOME_PAGE,function(a,c){return b.selectServiceType(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.CAL_MOVE,function(){return b.monthChangeClick()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.SERVICES_PAGE_OPENED,function(a,c){return b.servicesPageOpened(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.CHOOSE_STAFF_MEMBER_POPUP_OPENED,function(){return b.staffMemberPopupOpenedFromTimeSlot()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.CHOOSE_STAFF_MEMBER,function(){return b.staffMemberSelectedFromTimeSlot()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.CHANGE_STAFF_MEMBER_SELECTION,function(){return b.staffMemberSelectionChangedFromCalendar()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.LOG_TIMEZONE,function(){return b.logTimezone()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.PARTICIPANTS_AMOUNT_CHANGE,function(a,c){return b.logParticipantsAmountChanged(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.POPUP_CLOSED,function(a,c){return b.popupClosed(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.TIMEZONE_SWITCH,function(a,c){return b.timezoneSwitched(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.TIMEZONE_POPUP_OPENED,function(){return b.timezonePopupOpened()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.DEEP_LINK_CALENDAR_OPEN,function(a,c){return b.logDeepLinkCalendarOpened(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.LOGIN_CLICKED,function(){return b.logLoginClicked()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.GO_TO_ACCOUNT_MANAGEMENT,function(){return b.logGoToAccountManagement()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.LOGIN_COMPLETE,function(a,c){return b.logLoginComplete(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.POST_LOGIN_COMPLETE,function(a,c){return b.logPostLoginComplete(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.BOOKING_RESCHEDULE,function(a,c){return b.logBookingReschedule(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.BOOKING_RESCHEDULE_SUCCESS,function(a,c){return b.logBookingRescheduleSuccess(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.BOOKING_CANCEL,function(a,c){return b.logBookingCancel(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.ACCOUNT_MANAGEMENT_SECTION_SELECTION,function(a,c){return b.logAccountManagementSectionSelected(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.ACCOUNT_MANAGEMENT_SEE_SERVICES,function(a,c){return b.logAccountManagementHeaderBack(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.USER_INFO_SAVED,function(a,c){return b.logUserInfoSaved(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.SIGNOUT_CLICKED,function(){return b.logSignoutClicked()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.USER_INFO_EDIT_CLICKED,function(){return b.logEditUserInfoClicked()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.SHOW_SERVICE_DETAILS,function(a,c){return b.logShowMoreDetails(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.APPOINTMENT_BOOKED_VALIDATION,function(a,c){return b.appointmentBookedValidation(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.PRICING_PLAN_VIEW,function(a,c){return b.viewPricingPlan(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.DEEP_LINK_PRICING_PLAN,function(){return b.logDeepLinkPricingPlan()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.CHOOSE_DAY,function(){return b.selectDay()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.BACK,function(a,c){return b.logBackButtonPressed(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.ENTER_COUPON_CLICKED,function(){return b.logEnterCouponClicked()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.APPLY_COUPON_CLICKED,function(a,c){return b.logApplyCouponClicked(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.DELETE_COUPON_CLICKED,function(){return b.logDeleteCouponClicked()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.NAVIGATION_FROM_WIDGET,function(a,c){return b.logNavigationFromWidget(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.LOAD_MORE_HOURS,function(){return b.logLoadMoreHoursClicked()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.EXPERIMENT_EXPOSURE,function(a,c){return b.logExperimentExposure(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.JOIN_WAITING_LIST_CLICKED,function(){return b.logJoinWaitingList()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.DOUBLE_BOOKING_HAPPENED,function(a,c){return b.logDoubleBooking(c)})},c.prototype.logBackButtonPressed=function(a){this.log(this.wixBiLogger.events.BACK,{referal_info:a.referralInfo,type:a.type})},c.prototype.todayClick=function(){this.logWithServiceType(this.wixBiLogger.events.CAL_TODAY,{})},c.prototype.bookIt=function(a){this.log(this.wixBiLogger.events.BOOKIT,__assign({},a,{logged:this.userManagementSrv.isLoggedIn()}))},c.prototype.googleCalendar=function(){this.logWithServiceType(this.wixBiLogger.events.GOOGLE_EXPORT,{})},c.prototype.bookAnother=function(){this.logWithServiceType(this.wixBiLogger.events.BOOK_ANOTHER,{})},c.prototype.selectSlot=function(){var a=this.flowManagerSrv.isRescheduleFlow();this.logWithServiceType(this.wixBiLogger.events.CHOOSE_TIME_SLOT,{reschedule:a})},c.prototype.selectDay=function(){var a=this.flowManagerSrv.isRescheduleFlow();this.logWithServiceType(this.wixBiLogger.events.CHOOSE_DAY,{reschedule:a})},c.prototype.logEnterCouponClicked=function(){this.logWithServiceType(this.wixBiLogger.events.ENTER_COUPON_CLICKED,{})},c.prototype.logApplyCouponClicked=function(a){var b,c=a.couponStatus;b=c===i.VALID?"ok":c===i.EXPIRED?"expired":"invalid",this.logWithServiceType(this.wixBiLogger.events.APPLY_COUPON_CLICKED,{valid_value:b})},c.prototype.logDeleteCouponClicked=function(){this.logWithServiceType(this.wixBiLogger.events.DELETE_COUPON_CLICKED,{})},c.prototype.cancellationPolicy=function(){this.logWithServiceType(this.wixBiLogger.events.CANCELLATION_POLICY,{})},c.prototype.appointmentCreated=function(a){var b=this.userManagementSrv.isLoggedIn(),c=Object.assign({is_membership:this.isOfferingPaidWithMembership(),logged:b},this.getCouponDetailsForBi());this.logWithServiceType(this.wixBiLogger.events.APPOINTMENT_BOOKED,Object.assign(c,this.getAppointmentDetailsForBi({messageEmptyNeeded:!1,paymentInfo:!0,paymentMethod:a})))},c.prototype.viewPricingPlan=function(a){this.log(this.wixBiLogger.events.PRICING_PLAN_VIEW,{number_of_plans:a})},c.prototype.logDeepLinkPricingPlan=function(){this.log(this.wixBiLogger.events.DEEP_LINK_PRICING_PLAN,{})},c.prototype.saveSuccessContactInfo=function(a){var b=a.dynamicForm,c=this.dynamicFormSrv.countRequiredFields(b);this.logWithServiceType(this.wixBiLogger.events.CONTACT_INFO_SAVE_SUCCESS,this.getAppointmentDetailsForBi({numberOfRequiredFields:c,messageEmptyNeeded:!0,paymentInfo:!1,paymentMethod:null}))},c.prototype.bookedGroupButNotPremium=function(){this.log(this.wixBiLogger.events.BOOKED_GROUP_BUT_NOT_PREMUIM)},c.prototype.sendNextFailed=function(a){var b=a.referralInfo,c=a.errorReason,d=this.getSelectedOffering(),e={serviceId:d.id,referralInfo:b,errorReason:c};this.logWithServiceType(this.wixBiLogger.events.NEXT_FAILED,e)},c.prototype.sendNext=function(a){var b=a.referralInfo,c=a.dynamicForm,d=a.mandatoryFieldsList,e=a.isCouponEntered,f=a.hasCoupons,g=a.errorOnStaff,h=a.smsNotificationRequest,i=void 0===h?!1:h,j=this.getSelectedOffering(),k=this.flowManagerSrv.isRescheduleFlow(),l=this.appointmentService.getSelectedTime(),m={price_selection:this.getFreeLabel(j),referal_info:b,price:this.commonServices.decorateServicePriceForBi(j),depositAmount:this.commonServices.decorateServiceMinChargeForBi(j),currency:j.currency,catId:j.categoryId,serviceId:j.id,is_membership:null,reschedule:k,offered_as:this.getOfferedAsLabel(j.offeredAs),booked_as:this.getBookedAsLabel(l),is_coupon:null,errorOnStaff:g||!1,smsNotificationRequest:i};c&&(m.numberOfRequiredFields=this.dynamicFormSrv.countRequiredFields(c),f&&(m.is_coupon=!!e)),d&&(m.mandatoryFieldsList=d),this.logWithServiceType(this.wixBiLogger.events.NEXT,m)},c.prototype.logJoinWaitingList=function(){var a=this.getSelectedOffering();this.log(this.wixBiLogger.events.JOIN_WAITLIST_CTA,{referal_info:"group_calendar",type:j.GROUP,service_id:a.id,status:"JOIN",additionalInfo:"waitlist_flow_download_oa"})},c.prototype.selectServiceType=function(a){this.log(this.wixBiLogger.events.SERVICE_TYPE_WELCOME_PAGE,{type:a})},c.prototype.monthChangeClick=function(){this.logWithServiceType(this.wixBiLogger.events.CAL_MOVE,{})},c.prototype.staffMemberPopupOpenedFromTimeSlot=function(){this.log(this.wixBiLogger.events.CHOOSE_STAFF_MEMBER_POPUP_OPENED)},c.prototype.staffMemberSelectedFromTimeSlot=function(){this.log(this.wixBiLogger.events.CHOOSE_STAFF_MEMBER)},c.prototype.staffMemberSelectionChangedFromCalendar=function(){this.log(this.wixBiLogger.events.CHANGE_STAFF_MEMBER_SELECTION)},c.prototype.logExperimentExposure=function(a){var b=a.testName,c=a.experimentValue,d=a.triggerName,e=a.offeringType,f=e?e+"-"+d:d;this.log(this.wixBiLogger.events.EXPERIMENT_EXPOSURE,{testName:b,is_eligible:c,triggerName:f})},c.prototype.logLoadMoreHoursClicked=function(){var a=this.flowManagerSrv.isRescheduleFlow();this.logWithServiceType(this.wixBiLogger.events.LOAD_MORE_HOURS,{reschedule:a})},c.prototype.logNavigationFromWidget=function(a){this.log(this.wixBiLogger.events.NAVIGATION_FROM_WIDGET,{referralInfo:a.referralInfo,service_id:a.serviceId,type:a.type,booking_intent:a.bookingIntent,accept_online_bookings:a.acceptOnlineBookings})},c.prototype.logParticipantsAmountChanged=function(a){this.log(this.wixBiLogger.events.PARTICIPANTS_AMOUNT_CHANGE,{numParticipants:a})},c.prototype.getFreeLabel=function(a){return a&&a.isFree?"price_free":"price_paid"},c.prototype.getOfferedAsLabel=function(a){var b="";return 1===a.length&&a[0]===h.ONE_TIME?b="single":1===a.length&&a[0]===h.PRICING_PLAN?b="pricing plan":2===a.length&&a.indexOf(h.ONE_TIME)>=0&&a.indexOf(h.PRICING_PLAN)>=0&&(b="both"),b},c.prototype.getBookedAsLabel=function(a){return a&&a.bookedAs===h.PRICING_PLAN&&a.purchasedPricingPlan?"LIMITED"===a.purchasedPricingPlan.type?"pricing plan limited":"pricing plan unlimited":"single"},c.prototype.getAppointmentDetailsForBi=function(a){var b=this,c=a.messageEmptyNeeded,d=void 0===c?!0:c,e=a.paymentInfo,f=void 0===e?!1:e,g=a.depositAmountNeeded,h=void 0===g?!0:g,i=a.numberOfRequiredFields,j=void 0===i?void 0:i,k=a.paymentMethod,l=this.getSelectedOffering(),m=this.getContactInfo(),n={catId:l.categoryId,currency:l.currency,price:this.commonServices.decorateServicePriceForBi(l),price_selection:this.getFreeLabel(l),serviceId:l.id,type:l.type,isPendingApproval:!!l.isPendingApprovalFlow,numParticipants:l.numberOfParticipants||1};return d&&(n.message_empty=function(){return b.isEmpatyString(m)}),h&&(n.depositAmount=this.commonServices.decorateServiceMinChargeForBi(l)),f&&(n.paymentMethod=k),"undefined"!=typeof j&&(n.numberOfRequiredFields=j),n},c.prototype.getCouponDetailsForBi=function(){var a=this.isCouponApplied(),b=this.getSelectedOffering(),c=a?this.commonServices.decoratePrice(this.couponsSrv.getAppliedCoupon().priceAfterDiscount):(b.numberOfParticipants||1)*this.commonServices.decorateServicePriceForBi(b),d=a?this.commonServices.decoratePrice(this.couponsSrv.getAppliedCoupon().deposit):(b.numberOfParticipants||1)*this.commonServices.decorateServiceMinChargeForBi(b),e=a?this.couponsSrv.getAppliedCoupon().appliedCoupon.couponId:void 0;return{is_coupon:a,couponId:e,totalPrice:c,amountPaid:d}},c.prototype.getServiceType=function(){return this.getSelectedOffering().type},c.prototype.getSelectedOffering=function(){return this.appointmentService.getSelectedOffering()||{}},c.prototype.getContactInfo=function(){return this.appointmentService.getContactInfo()||{}},c.prototype.logWithServiceType=function(a,b){b.type=this.getServiceType(),this.log(a,b)},c.prototype.servicesPageOpened=function(a){var b={type:a};this.$wix.isInPreviewMode()||this.log(this.wixBiLogger.events.SERVICES_PAGE_OPENED,b)},c.prototype.logTimezone=function(){var a=this;this.$q.all([this.timezoneSrv.gettingUserTimezone(),this.businessInfoSrv.gettingBusinessInfo()]).then(function(b){var c={ownerTimeZone:b[1].timeZone,ownerOffset:b[1].timeZoneOffset,visitorTimeZone:b[0].name,visitorOffset:b[0].offset};a.log(a.wixBiLogger.events.LOG_TIMEZONE,c)})},c.prototype.popupClosed=function(a){this.log(this.wixBiLogger.events.SYS_MSG_CLOSE,{referal_info:a})},c.prototype.timezoneSwitched=function(a){var b=a.timezone,c=a.type,e=void 0===c?"":c,f=a.referralInfo,g=void 0===f?"":f,h=b===d.BUSINESS?"business time zone":"local";this.log(this.wixBiLogger.events.TIMEZONE_SWITCH,{changeTo:h,type:e,referralInfo:g})},c.prototype.timezonePopupOpened=function(){this.log(this.wixBiLogger.events.TIMEZONE_POPUP_OPENED)},c.prototype.logDeepLinkCalendarOpened=function(a){this.log(this.wixBiLogger.events.DEEP_LINK_CALENDAR_OPEN,a)},c.prototype.logLoginClicked=function(){var a={pageName:this.routeManager.getCurrentPagePartialPath()};this.log(this.wixBiLogger.events.LOGIN_CLICKED,a)},c.prototype.logLoginComplete=function(a){var b={pageName:this.routeManager.getCurrentPagePartialPath()};this.log(this.wixBiLogger.events.LOGIN_COMPLETE,Object.assign(b,a))},c.prototype.logPostLoginComplete=function(a){this.log(this.wixBiLogger.events.POST_LOGIN_COMPLETE,a)},c.prototype.logGoToAccountManagement=function(){var a={pageName:this.routeManager.getCurrentPagePartialPath()};this.log(this.wixBiLogger.events.GO_TO_ACCOUNT_MANAGEMENT,a)},c.prototype.logBookingReschedule=function(a){this.logRescheduleBookingBase(a,this.wixBiLogger.events.BOOKING_RESCHEDULE)},c.prototype.logBookingRescheduleSuccess=function(a){this.logRescheduleBookingBase(a,this.wixBiLogger.events.BOOKING_RESCHEDULE_SUCCESS)},c.prototype.logRescheduleBookingBase=function(a,b){var c={appointmentId:a.bookingId,serviceId:a.offeringDetails.id};this.log(b,c)},c.prototype.logBookingCancel=function(a){var b={appointmentId:a.booking.bookingId,serviceId:a.booking.offeringDetails.id,confirmation:a.confirmation};this.log(this.wixBiLogger.events.BOOKING_CANCEL,b)},c.prototype.logAccountManagementSectionSelected=function(a){this.log(this.wixBiLogger.events.ACCOUNT_MANAGEMENT_SECTION_SELECTION,a)},c.prototype.logAccountManagementHeaderBack=function(a){this.log(this.wixBiLogger.events.ACCOUNT_MANAGEMENT_SEE_SERVICES,a)},c.prototype.logUserInfoSaved=function(a){var b=a.newUserInfo,c=a.currentUserInfo;this.log(this.wixBiLogger.events.USER_INFO_SAVED,{phoneChanged:b.phoneNumber!==c.phoneNumber,nameChanged:b.fullName!==c.fullName})},c.prototype.isOfferingPaidWithMembership=function(){return!!this.appointmentService.getPurchasedPricingPlan()},c.prototype.isCouponApplied=function(){return this.couponsSrv.isCouponApplied()},c.prototype.logSignoutClicked=function(){var a={pageName:this.routeManager.getCurrentPagePartialPath()};this.log(this.wixBiLogger.events.SIGNOUT_CLICKED,a)},c.prototype.logEditUserInfoClicked=function(){this.log(this.wixBiLogger.events.USER_INFO_EDIT_CLICKED)},c.prototype.logShowMoreDetails=function(a){var b=a.referralInfo,c=a.accept_online_bookings;this.log(this.wixBiLogger.events.SHOW_SERVICE_DETAILS,{referralInfo:b,accept_online_bookings:c})},c.prototype.appointmentBookedValidation=function(a){var b=a.bookingId,c=a.offeringType,d=a.status,h=a.subStatus,i=a.validateBookingType;this.log(this.wixBiLogger.events.APPOINTMENT_BOOKED_VALIDATION,{bookingId:b,service:c,status:e(d),sub_category:g(h),transaction:f(i)})},c.prototype.logDoubleBooking=function(a){var b=a.referralInfo,c=a.serviceType,d=a.bookingId;this.log(this.wixBiLogger.events.MODAL_OPENED,{referral_info:b,type:c,bookingId:d})},c.prototype.log=function(a,b){var c=this;void 0===b&&(b={});var d=function(){try{return c.$wix.getPermissions()}catch(a){return""}},e={is_over_editor:this.$wix.isOverEditor(),is_preview:this.$wix.isInPreviewMode(),ownerId:this.$wix.getSiteOwnerId(),roles:d(),bookingsPlatform:"new_bookings_server"};this.wixBiLogger.log(a,__assign({},b,e))},c}(BILogger);b.VisitorBiListenerSrv=k,angular.module("schedulerAngularClientAppInternal").service("visitorBiListener",k)}(c=b.bi||(b.bi={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},UpfrontPaymentController=function(){function a(a,b,c,d){this.$filter=a,this.$translate=b,this.paymentService=c,this.$scope=d,this.init()}return a.$inject=["$filter","$translate","paymentService","$scope"],a.prototype.init=function(){return __awaiter(this,void 0,void 0,function(){var a,b,c=this;return __generator(this,function(d){switch(d.label){case 0:return this.quantity=angular.isDefined(this.quantity)?this.quantity:1,a=this,this.isConfirmation?(b=this.paymentService.isPaidOnline(this.minCharge),[3,3]):[3,1];case 1:return[4,this.paymentService.hasUpfrontPayment(this.minCharge)];case 2:b=d.sent(),d.label=3;case 3:return a.isUpfrontPaymentPresent=b,this.isUpfrontPaymentPresent&&(this.populateDisplayText(),this.$scope.$watch(function(){return c.quantity},function(){return c.populateDisplayText()})),[2]}})})},a.prototype.populateDisplayText=function(){var a=this.minCharge*this.quantity,b=this.$filter("isoCurrency")(a,this.currency,wix.bookings.visitor.payments.getFractionDigitsForPrice(a));if(this.showOnlyPrice)this.displayText=b;else{var c=this.isConfirmation?"visitor.congratulations.upfront-payment-text":"sidebar.upfront-payment-text-secondary";this.displayText=this.$translate(c,{minCharge:b})}},a.prototype.getText=function(){return this.displayText},a}();angular.module("schedulerAngularClientAppInternal").component("boostUpfrontPayment",{templateUrl:"modules/common/components/upfront-payment.preload.html",controller:UpfrontPaymentController,controllerAs:"upCtrl",bindings:{minCharge:"=",currency:"=",isConfirmation:"=",quantity:"=?",showOnlyPrice:"="}});var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(){function b(a,b,c,d,e,f,g,h,i,j){this.appointmentService=a,this.userManagementSrv=b,this.visitorBILogger=c,this.$rootScope=d,this.offeringSettingKeysGetterSrv=e,this.experimentsEnabler=f,this.modal=g,this.wixSdkUtil=h,this.dynamicFormSrv=i,this.$q=j}return b.$inject=["appointmentService","userManagementSrv","visitorBILogger","$rootScope","offeringSettingKeysGetterSrv","experimentsEnabler","modal","wixSdkUtil","dynamicFormSrv","$q"],b.prototype.getSelectedOffering=function(){return this.initObj(this.appointmentService.getSelectedOffering())},b.prototype.getContactInfo=function(){return this.initObj(this.appointmentService.getContactInfo())},b.prototype.setContactInfo=function(a,b){this.setDynamicFormData(a,b),this.dynamicFormSrv.enrichContactInfoWithFormData(a,b),this.appointmentService.setContactInfo(a)},b.prototype.getLoggedInUser=function(){return this.initObj(this.userManagementSrv.getCurrentSiteMember())},b.prototype.setDynamicFormData=function(a,b){a.dynamicFormData=b},b.prototype.updatingLoggedUserDetails=function(a){if(this.userManagementSrv.isSiteOwner())return this.modal.openOwnerIsLoggedIn(),this.$q.reject({});var b=this.getLoggedInUser();return this.isLoggedUserNeedsToBeUpdated(b,a)?(b.fullName=a.name,b.phoneNumber=a.phone,this.userManagementSrv.updatingSiteMember(b)):this.$q.when({})},b.prototype.updateNumberOfParticipants=function(a,b,c){return this.updateGroupWithQuantity(a,b),this.visitorBILogger.logParticipantsAmountChanged(a),this.notifyQuantityUpdated(b,c)},b.prototype.gettingBookingsDynamicForm=function(){var a=this.appointmentService.getSelectedOffering(),b=this.appointmentService.getSelectedTime(),c={offeringType:a.type,offeringId:a.id,isDummyOffering:!!a.dummy,bookedAs:b.bookedAs};a.isMultiParticipantsOffering()&&(c.offeringInstanceId=b.groupInstance.id,c.isDummyOffering=c.isDummyOffering||!!b.groupInstance.dummy),this.populateLegacyLabels(c);var d=this.getContactInfo(),e=this.getLoggedInUser();return this.dynamicFormSrv.gettingBookingsDynamicForm(c,d,e)},b.prototype.populateLegacyLabels=function(a){var b=this.offeringSettingKeysGetterSrv.getKeys().contactInfo.text;a.legacyLabels={onlinePayment:this.wixSdkUtil.getTextForModel(b.onlinePaymentLabel),offlinePayment:this.wixSdkUtil.getTextForModel(b.offlinePaymentLabel),message:this.wixSdkUtil.getTextForModel(b.message)}},b.prototype.updateGroupWithQuantity=function(a,b){Object.assign(b,{numberOfParticipants:a}),this.appointmentService.setSelectedOffering(b)},b.prototype.notifyQuantityUpdated=function(b,c){return c&&this.$rootScope.$broadcast(a.boost.visitor.VisitorSidebar.EVENTS.SERVICE_UPDATED,b),this.$q.resolve()},b.prototype.isLoggedUserNeedsToBeUpdated=function(a,b){return a.email&&(a.fullName!==b.name||a.phoneNumber!==b.phone)},b.prototype.initObj=function(a){return a?a:{}},b}();b.ContactInfoSrv=c,angular.module("schedulerAngularClientAppInternal").service("contactInfoSrv",c)}(c=b.contact||(b.contact={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(){angular.module("schedulerAngularClientAppInternal").factory("bksDebouncePromise",["$timeout","$q",function(a,b){return function(c,d,e){void 0===d&&(d=0),void 0===e&&(e=!1);var f,g=b.defer();return function(){var h=this,i=arguments,j=function(){f=null,e||(g.resolve(c.apply(h,i)),g=b.defer())},k=e&&!f;return f&&a.cancel(f),f=a(j,d),k&&(g.resolve(c.apply(h,i)),g=b.defer()),g.promise}}}])}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.bookings.form.DynamicFormFieldTypes,d=function(){function a(){}return a.prototype.onChangeNumOfParticipants=function(a){this.onParticipantsAmountChanged({numOfParticipants:a})},a.prototype.onAttributeChanged=function(a){a.fieldType===c.NUM_OF_PARTICIPANTS&&this.onChangeNumOfParticipants(a.value)},a}();b.ContactInfoFormComponent=d,angular.module("schedulerAngularClientAppInternal").component("bksContactInfoForm",{templateUrl:"modules/desktop/contact-info-form/contact-info-form.preload.html",controller:d,bindings:{dynamicFormData:"=",onParticipantsAmountChanged:"&",businessInfo:"<"},transclude:!0})}(c=b.contact||(b.contact={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.visitor.preview.ModalTypes,d=a.visitor.booking.COUPONS_EVENTS,e=a.bookings.form.DynamicFormAttribute,f=a.bookings.form.DynamicFormFieldTypes,g=a.bookings.form.DynamicFormValueTypes,h=function(){function a(){}return a.INDIVIDUAL="INDIVIDUAL",a.GROUP="GROUP",a}();b.BiOfferingTypes=h;var i=function(){function b(a,b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A){var B=this;this.contactInfoSrv=a,this.$route=b,this.wixSdkUtil=c,this.visitorBILogger=e,this.$scope=f,this.appointmentService=g,this.processBookingSrv=h,this.paymentService=i,this.flowManagerSrv=j,this.fedopsLogger=k,this.$translate=l,this.$rootScope=m,this.experimentsEnabler=n,this.smsRemindersSrv=o,this.groupsSrv=p,this.offeringValidationsSrv=q,this.boostInjectionPersister=r,this.appConfig=s,this.previewModalSrv=t,this.premiumService=u,this.modal=v,this.couponsSrv=w,this.dynamicFormSrv=x,this.slotNotAvailableModalSrv=y,this.pricingPlanTPANavigator=z,this.nextLabelSrv=A,this.isPossessing=!1,this.submittedInvalid=!1,this.contactDataIsValid=!0,this.onCouponChanged=function(){B.coupon=B.couponsSrv.getAppliedCoupon(),B.couponApplied=!!B.coupon,B.showError=!1
};var C=this.$rootScope.$on(d.COUPON_UPDATED,function(){return B.onCouponChanged()});this.isUoUCTAEnabled=n.isUoUCTAEnabled(),this.$scope.$on("$destroy",function(){C()}),this.experimentsEnabler.isGenericFormDeeplinkEnabled()&&this.$scope.$on(PricingPlanConst.BOOKING_METHOD_SELECTED,function(a,b){return B.handleBookedAsChange(b)})}return b.$inject=["contactInfoSrv","$route","wixSdkUtil","visitorBILogger","$scope","appointmentService","processBookingSrv","paymentService","flowManagerSrv","fedopsLogger","$translate","$rootScope","experimentsEnabler","smsRemindersSrv","groupsSrv","offeringValidationsSrv","boostInjectionPersister","appConfig","previewModalSrv","premiumService","modal","couponsSrv","dynamicFormSrv","slotNotAvailableModalSrv","pricingPlanTPANavigator","nextLabelSrv"],b.prototype.handleBookedAsChange=function(a){this.bookedAs=a},b.prototype.doBack=function(){this.visitorBILogger.backButtonPressed("contact_info",this.getBiOfferingType()),this.flowManagerSrv.prev()},b.prototype.goToNextFlowStep=function(){this.selectedOffering.isOnlinePayment&&!this.premiumService.isFeatureEnabled((new a.boost.Features).PAYMENTS)&&this.previewModalSrv.openModal(c.PREVIEW_PREMIUM_PAYMENT_MODAL),this.flowManagerSrv.next()},b.prototype.getBiOfferingType=function(){return this.selectedOffering.type},b.prototype.doNext=function(a){return __awaiter(this,void 0,void 0,function(){var b,c=this;return __generator(this,function(){return this.fedopsLogger.interactionStarted("submit-contact-info-form"),this.offeringValidationsSrv.isOfferingAllowedForSelectionByPremium(this.selectedOffering.type)?(this.savedOnNext=!1,this.submittedInvalid=a.$invalid,this.wixSdkUtil.resetHeight(),b=this.shouldSendSmsReminder(),this.isUoUCTAEnabled||this.visitorBILogger.sendNext({referralInfo:"contact_info",dynamicForm:this.dynamicFormData,hasCoupons:this.hasCoupons,isCouponEntered:this.couponApplied,smsNotificationRequest:b}),a.$invalid||this.showError||this.showSlotNotAvailableModal?(this.isUoUCTAEnabled&&(this.dynamicFormData.form.fields.forEach(function(a){a.userConstraints.dirty=a.userConstraints.required}),this.visitorBILogger.sendNextFailed({referralInfo:"contact_info",errorReason:a.$$controls.filter(function(a){return a.$invalid}).map(function(a){return c.dynamicFormSrv.getTypeById(c.dynamicFormData,a.$name)}).join(",")})),this.shouldShowNextStepErrorMessage=!0):(this.isUoUCTAEnabled&&this.visitorBILogger.sendNext({referralInfo:"contact_info",dynamicForm:this.dynamicFormData,hasCoupons:this.hasCoupons,isCouponEntered:this.couponApplied,smsNotificationRequest:b}),this.contactInfoSrv.setContactInfo(this.contactInfo,this.dynamicFormData),this.appointmentService.setSelectedOffering(this.selectedOffering),this.savedOnNext=!0,this.visitorBILogger.saveSuccessContactInfo(this.dynamicFormData),this.proceed())):(this.modal.openNonBookableOfferingSelected("offering-list.premium-not-enabled.message"),this.groupsSrv.notifyingNonPremiumEnrollmentAttempt()),[2,!a.$invalid]})})},b.prototype.getNextStepErrorMessage=function(a){return this.shouldShowNextStepErrorMessage&&a.$invalid?"sidebar.next.form.error-message":""},b.prototype.hasValidPlan=function(){var a=this.appointmentService.getSelectedTime().purchasedPricingPlan;return!!a},b.prototype.proceed=function(){return __awaiter(this,void 0,void 0,function(){var a,b;return __generator(this,function(c){switch(c.label){case 0:return this.preventConsecutiveBooking(),this.experimentsEnabler.isGenericFormDeeplinkEnabled()?(this.appointmentService.updateBookedAs(this.bookedAs),this.bookedAs!==OfferedAsType.PRICING_PLAN||this.hasValidPlan()?[3,2]:[4,this.pricingPlanTPANavigator.navigate(this.selectedOffering.pricingPlanInfo.pricingPlans)]):[3,2];case 1:c.sent(),c.label=2;case 2:return c.trys.push([2,6,,7]),[4,this.contactInfoSrv.updatingLoggedUserDetails(this.contactInfo)];case 3:return c.sent(),this.fedopsLogger.interactionEnded("submit-contact-info-form"),a=this.shouldSendSmsReminder(),[4,this.processBookingSrv.execute(this.dynamicFormData.form.actions.shouldPay,a)];case 4:return c.sent(),[4,this.goToNextFlowStep()];case 5:return c.sent(),[3,7];case 6:return b=c.sent(),this.errorCallback(b),[3,7];case 7:return[2]}})})},Object.defineProperty(b.prototype,"couponCode",{get:function(){return this.coupon&&this.coupon.appliedCoupon.couponCode},enumerable:!0,configurable:!0}),b.prototype.isNextActionAllowed=function(a){return this.isUoUCTAEnabled?!this.showError&&!this.isPossessing&&!this.showSlotNotAvailableModal:a.$valid&&!this.isPossessing&&!this.showError&&!this.showSlotNotAvailableModal},b.prototype.getTimezone=function(){return this.timezone},Object.defineProperty(b.prototype,"numOfStaff",{get:function(){return this.staff?this.staff.staff.length:0},enumerable:!0,configurable:!0}),b.prototype.onParticipantsAmountChanged=function(a,b){var c=this;this.preventConsecutiveBooking(),this.contactInfoSrv.updateNumberOfParticipants(a,this.selectedOffering,b).then(function(){c.isPossessing=!1})},b.prototype.$onInit=function(){this.dynamicFormData=this.$route.current.locals.dynamicFormData,this.paymentService.setBusinessInfo(this.businessInfo),this.saveContactOnPageChange(),this.preventConsecutiveBooking(),this.isPossessing=!1,this.selectedOffering=this.contactInfoSrv.getSelectedOffering(),this.baseServicePrice=this.selectedOffering.price,this.contactInfo=this.contactInfoSrv.getContactInfo(),this.staff=this.$route.current.locals.staff,this.timezone=this.$route.current.locals.timezone,this.contactDataIsValid=!0,this.showSMSReminderField=this.smsRemindersSrv.isEnabled(this.businessInfo),this.initSmsReminder(),this.phoneField=this.dynamicFormData.form.fields.find(function(a){return a.fieldType===f.PHONE}),this.isPhoneRequired=this.phoneField.userConstraints.required,this.removeInvalidPrefilledPhone()},b.prototype.getTitle=function(){return this.dynamicFormData.form.header.title?this.dynamicFormData.form.header.title:this.$translate("visitor.contact-info.title")},b.prototype.getDescription=function(){return this.dynamicFormData.form.header.isDescriptionHidden?void 0:this.dynamicFormData.form.header.description},b.prototype.errorCallback=function(b){this.isPossessing=!1,this.showErrorKey=null,b===a.bookings.visitor.services.BOOKING_CLIENT_ERRORS.SLOT_NOT_AVAILABLE&&this.shouldOpenSlotNotAvailableModal()?(this.showSlotNotAvailableModal=!0,this.slotNotAvailableModalSrv.openModal(a.visitor.modals.ReferralInfo.DOUBLE_BOOKING_FORM_PAGE)):b===a.bookings.visitor.services.BOOKING_CLIENT_ERRORS.SLOT_NOT_AVAILABLE?this.showErrorKey="visitor.confirmation.error.session-not-available":b===a.bookings.visitor.services.BOOKING_CLIENT_ERRORS.SERVICE_NOT_AVAILABLE?this.showErrorKey="visitor.confirmation.error.service-not-available":b===a.bookings.visitor.services.BOOKING_CLIENT_ERRORS.GENERAL_ERROR&&(this.showErrorKey="visitor.confirmation.error.general"),this.showError=null!==this.showErrorKey},b.prototype.initSmsReminder=function(){this.showSMSReminderField&&(this.smsReminderField=new e({fieldType:f.SMS_REMINDER,valueType:g.CHECKBOX,label:this.$translate("visitor.contact-info.form.sms-reminder"),displayType:"Full",isReadOnly:!1,value:!1}))},b.prototype.onSmsReminderChanged=function(){var a=this.shouldSendSmsReminder(),b=this.getFieldByFieldType(f.PHONE);b.userConstraints.required=this.isPhoneRequired||a,b.userConstraints.dirty=a},b.prototype.shouldSendSmsReminder=function(){return this.smsReminderField&&"true"===this.smsReminderField.value},b.prototype.removeInvalidPrefilledPhone=function(){this.showSMSReminderField&&!this.isInternationalPhoneNumber()&&(this.phoneField.value="")},b.prototype.isInternationalPhoneNumber=function(){return this.phoneField.value&&"+"===this.phoneField.value.charAt(0)},b.prototype.getFieldByFieldType=function(a){return this.dynamicFormData.form.fields.find(function(b){return b.fieldType===a})},b.prototype.shouldOpenSlotNotAvailableModal=function(){return this.selectedOffering.type!==OfferingType.COURSE&&this.experimentsEnabler.isPreventDoubleBookingEnabled()||this.selectedOffering.type===OfferingType.COURSE&&this.experimentsEnabler.isPreventDoubleBookingForCourseEnabled()},b.prototype.saveContactOnPageChange=function(){var b=this;this.$rootScope.$on(a.bookings.user.UserManagementSrv.MY_ACCOUNT_USER_INFO_CHANGED,function(){b.contactDataIsValid=!1}),this.$scope.$on("$destroy",function(){!b.savedOnNext&&b.contactDataIsValid&&b.contactInfoSrv.setContactInfo(b.contactInfo,b.dynamicFormData)})},Object.defineProperty(b.prototype,"actionLabel",{get:function(){var a=this.dynamicFormData.form.actions,b=a.actionLabel,c=a.shouldPay;return c?this.$translate("visitor.confirmation.next"):b},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"isCouponsRequire",{get:function(){return this.hasCoupons&&(!this.selectedOffering.isPricingPlanOffering()||this.selectedOffering.isBothSingleSessionAndPricingPlanOffering())&&!this.selectedOffering.isFree},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"ariaActionLabel",{get:function(){return this.dynamicFormData.form.actions.actionLabel},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"countryCode",{get:function(){return this.businessInfo.countryCode},enumerable:!0,configurable:!0}),b.prototype.preventConsecutiveBooking=function(){this.isPossessing=!0},b.prototype.isPricingPlanOffering=function(){return this.selectedOffering.isPricingPlanOffering()},b}();b.ContactInfoPage=i,angular.module("schedulerAngularClientAppInternal").component("bksContactInfoPage",{templateUrl:"modules/desktop/contact-info-form/contact-info-page.preload.html",controller:i,bindings:{hasCoupons:"=",businessInfo:"<"}})}(c=b.contact||(b.contact={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var focusOn=wix.bookings.accessibility.focusOn,GroupInstanceOccupancy=wix.boost.visitor.groups.GroupInstanceOccupancy,StaffPickerComponent=function(){function a(a,b,c,d,e){this.$scope=a,this.visitorBILogger=b,this.$element=c,this.$timeout=d,this.$rootScope=e,this.staffStatus=this.staffStatus||new Map,this.resetSelectedIndexIfDataSourceChanges(),this.visitorBILogger.staffMemberPopupOpenedFromTimeSlot(),this.staffMemberNameSelector='[data-hook="staff-member-name"]',this.registerCloseEvent()}return a.$inject=["$scope","visitorBILogger","$element","$timeout","$rootScope"],a.prototype.registerCloseEvent=function(){var a=this,b=function(c){a.isEscapeKey(c)&&(a.close(),$("body").unbind("keyup",b))};$("body").bind("keyup",b)},a.prototype.isEscapeKey=function(a){return 27===a.which},a.prototype.$postLink=function(){var a=this;this.$timeout(function(){return focusOn(a.$element.find(a.staffMemberNameSelector).first())})},a.prototype.selectStaffMember=function(a,b,c){if(a.preventDefault(),!this.isFull(c)){this.selectedStaffIndex=b;var d=c.id;this.onStaffSelected({staffMemberId:d}),this.notifyStaffSelected(),this.close()}},a.prototype.notifyStaffSelected=function(){this.$rootScope.$broadcast(a.STAFF_SELECTED)},a.prototype.close=function(){this.$timeout(function(){return $("body").click()})},a.prototype.isFull=function(a){var b=this.staffStatus.get(a.id);return b&&b.occupancy===GroupInstanceOccupancy.FULL},a.prototype.resetSelectedIndexIfDataSourceChanges=function(){var a=this;this.$scope.$watch(function(){return a.staff},function(){a.selectedStaffIndex=-1})},a.STAFF_SELECTED="STAFF_SELECTED",a}();angular.module("schedulerAngularClientAppInternal").component("boostStaffPicker",{templateUrl:"modules/components/staff-picker/staff-picker.preload.html",controller:StaffPickerComponent,bindings:{staff:"=",staffStatus:"=?",onStaffSelected:"&"}});var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.$element=a,this.$timeout=b}return a.$inject=["$element","$timeout"],a.prototype.$onInit=function(){this.items=this.itemsInput.slice(),this.setDefaultAndNotify()},a.prototype.setDefaultAndNotify=function(){var a=!this.defaultOptionLabel&&!this.selectedItem&&this.items.length;this.initDefaultOption(),!this.selectedItem&&this.items.length&&(this.selectedItem=this.items[0]),a&&this.selectItem(this.selectedItem)},a.prototype.initDefaultOption=function(){if(this.defaultOptionLabel){var a={value:"",label:this.defaultOptionLabel};this.items.unshift(a)}},a.prototype.onSelect=function(a){this.selectItem(a),this.$element.find('[data-hook="dropdown_button"]').focus()},a.prototype.selectItem=function(a){this.selectedItem=a,this.onSelectCallback({value:a.value})},a.prototype.onToggle=function(a){var b=this;this.isOpen=a,this.onToggleCallBack({open:a}),a&&this.$timeout(function(){return b.$element.find(".dropdown-menu__item").first().focus()})},a.prototype.onKeyPress=function(a,b){var c=a.which,d=13,e=32;(c===d||c===e)&&(this.onSelect(b),c===e&&this.onToggle(!1))},a}();a.Dropdown=b,angular.module("schedulerAngularClientAppInternal").component("boostDropdown",{template:'\n        <div class="dropdown" ng-class="$ctrl.customClass" dropdown dropdown-append-to-body on-toggle="$ctrl.onToggle(open)" data-hook="dropdown" is-open="$ctrl.isOpen">\n            <button type="button" class="button btn btn-default dropdown__button" ng-class="{\'dropdown__button--open\': $ctrl.isOpen}" dropdown-toggle ng-disabled="disabled" role="button" data-hook="dropdown_button" tabindex="0">\n              <span class="dropdown__label" data-hook="dropdown-select-label" data-value="{{$ctrl.selectedItem.value}}" aria-label="{{\'dropdown.accessibility.selected\' | translate: {item: $ctrl.selectedItem.label} }}">{{$ctrl.selectedItem.label}}</span>\n              <span class="dropdown__caret scheduler-svg-font-icons-arrow-dropdown" aria-hidden="true"></span>\n            </button>\n             <div class="dropdown-menu">\n                <div data-hook="dropdown-menu-scroller" class="dropdown-menu__scroller" boost-scrollbar="{{$ctrl.scrollbarType || \'dark-3\'}}"  boost-scrollbar-amount="25" boost-scrollbar-inertia="600" role="presentation" tabindex="-1">\n                  <ul class="dropdown-menu__content" role="menu"> \n                      <li class="dropdown-menu__item" ng-repeat="item in $ctrl.items" id="ddl-{{$index}}" data-hook="dropdown-item" data-value="{{item.value}}" ng-click="$ctrl.onSelect(item)" aria-label="{{item.label}}" with-vertical-navigation ng-keydown="$ctrl.onKeyPress($event, item)" role="menuitem" tabindex="-1">{{item.label}}</li>\n                  </ul>\n               </div>\n             </div>\n        </div>\n         ',controller:b,bindings:{itemsInput:"=items",onSelectCallback:"&onSelect",defaultOptionLabel:"@",onToggleCallBack:"&onToggle",scrollbarType:"@?",customClass:"@",selectedItem:"=?"}})}(b=a.components||(a.components={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var VisitorStaffSrv=function(){function a(a,b,c,d,e){this.visitorApi=a,this.appointmentService=b,this.$q=c,this.boostInjectionPersister=d,this.overEditor=e}return a.$inject=["visitorApi","appointmentService","$q","boostInjectionPersister","overEditor"],a.prototype.gettingStaffMembers=function(){var a=this;return this.gettingRealStaffMembers().then(function(b){return a.overEditor.enrichStaffIfOverEditor(b),b})},a.prototype.gettingRealStaffMembers=function(){var a=this.boostInjectionPersister.getStaff();return a?this.$q.when(a):this.visitorApi.gettingStaffMembers()},a.prototype.getStaffListByIds=function(a,b){var c=[];return a&&b.staff&&b.staff.length&&(c=this.getStaffListByStaffMap(a,this.createId2StaffMemberMap(b))),c},a.prototype.createId2StaffMemberMap=function(a){var b={};return a.staff.forEach(function(a){b[a.id]=a}),b},a.prototype.getStaffListByStaffMap=function(a,b){var c=[];return a.forEach(function(a){c.push(b[a])}),c},a.prototype.getCapableStaffForCalendarSlots=function(){var a=this;return this.gettingStaffMembers().then(function(b){return a.getCapableStaffForCalendarSlotsByStaff(b)})},a.prototype.getCapableStaffForCalendarSlotsByStaff=function(a){var b,c=this.appointmentService.getSelectedOffering();return b=c?c.dummy?a.staff.map(function(a){return a.id}):this.getValidStaffIdsForService(c):[],this.getStaffListByIds(b,a)},a.prototype.getValidStaffIdsForService=function(a){return a.type===WixBookingsUoUDomain.OfferingType.GROUP?this.getStaffIdsForGroup(a):this.getStaffIdsForIndividualService(a)},a.prototype.getStaffIdsForGroup=function(a){for(var b=["mon","tue","wed","thu","fri","sat","sun"],c={},d=0;d<b.length;d++)a.classHours&&a.classHours[b[d]]&&a.classHours[b[d]].workingHours.forEach(function(a){a.staffId&&(c[a.staffId]=!0)});return Object.keys(c)},a.prototype.getStaffIdsForIndividualService=function(a){return a.staffMembers||[]},a}();angular.module("schedulerAngularClientAppInternal").service("visitorStaffSrv",VisitorStaffSrv),function(){function a(a){var b=a.$parent.$parent.$parent,c=b.staff,d=b.staffStatus,e=b.onStaffSelected;a.staff=c,a.staffStatus=d,a.onStaffSelected=function(a){return e({staffMemberId:a})}}function b(){return{restrict:"EA",replace:!0,controller:a,controllerAs:"staffPickerTooltipPopupCtrl",scope:{title:"@",content:"@",placement:"@",animation:"&"},template:'<div class="staff-member-popover popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }" data-hook="staff-member-popover">\n         <div class="popover-inner" boost-scrollbar="default" boost-scrollbar-amount="25" boost-scrollbar-inertia="600" ><boost-staff-picker staff="staff" on-staff-selected="onStaffSelected(staffMemberId)" staff-status="staffStatus"></boost-staff-picker></div>\n         </div>'}}a.$inject=["$scope"],angular.module("schedulerAngularClientAppInternal").directive("boostStaffPickerTooltipPopup",b).directive("boostStaffPickerTooltip",["$tooltip","$timeout",function(a,b){var c=a("boostStaffPickerTooltip","boostStaffPickerTooltip","staff-member-selection.open");c.scope={staff:"=",staffStatus:"=?",onStaffSelected:"&",onTooltipClose:"&",staffMemberSelectionOpen:"="};var d=c.compile();return{restrict:"A",scope:c.scope,link:function(a,c,e){function f(d,e){void 0===e&&(e=!1),b(function(){c.trigger(d),e&&a.onTooltipClose()})}function g(){i.off("click",g),f("staff-member-selection.close",!0)}function h(){i.click(g)}d.call(null,a,c,e);var i=angular.element("body");a.$watch("staffMemberSelectionOpen",function(a){angular.isDefined(a)&&(a?(f("staff-member-selection.open"),b(h)):g())})}}}])}();var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.visitor.booking.PurchasedPricingPlanFactory,d=a.bookings.account.bookings.PaymentTypes,e=function(){function b(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){this.$window=b,this.$q=c,this.appointmentService=d,this.routeManager=e,this.visitorBILogger=f,this.$route=g,this.cacheSrv=h,this.$translate=i,this.paymentService=j,this.experimentsEnabler=k,this.categorySrv=o,this.bookingDataSrv=p,this.$sce=q,this.appConfig=r,this.bookingProcess=s,this.$filter=t,this.participantsVisibility=!1,this.pricingPlanInfo=null,this.requireAddress=a.bookings.visitor.RequireAddressFactory.construct(n),this.init(),this.bookAnotherPage=l.VISITOR_SERVICES;var u=m.getKeys().congratulations;this.type=u.design.offeringType,this.bookAnotherKeys={translate:u.textTranslationKeys.bookAnother,settings:u.text.bookAnother},this.googleKeys={translate:u.textTranslationKeys.google,settings:u.text.google},this.serviceInfo&&this.serviceInfo.isPendingApprovalFlow?(this.messageKeys={translate:u.textTranslationKeys.pendingMessage,settings:u.text.pendingMessage},this.instructionsKeys={translate:u.textTranslationKeys.pendingInstructions,settings:u.text.pendingInstructions}):(this.messageKeys={translate:u.textTranslationKeys.message,settings:u.text.message},this.instructionsKeys={translate:u.textTranslationKeys.instructions,settings:u.text.instructions}),this.isWixPaymentDown=this.bookingDataSrv.getIsWixPaymentDown(),this.bookingDataSrv.clearWixPaymentDownKey(),this.appConfig.getIsMobile()&&(this.mobileNotificationText=this.$sce.trustAsHtml(this.$translate("visitor.congratulations.payment.not.processed.mobile")))}return b.$inject=["$window","$q","appointmentService","routeManager","visitorBILogger","$route","cacheSrv","$translate","paymentService","experimentsEnabler","clientPages","offeringSettingKeysGetterSrv","serviceConst","categorySrv","bookingDataSrv","$sce","appConfig","bookingProcess","$filter"],b.prototype.showMoreDetails=function(){this.shouldShowMoreDetails=!0},Object.defineProperty(b.prototype,"appointmentLocationText",{get:function(){return this.concatenateAddressString(this.address)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"appointmentLocation",{get:function(){return this.appointmentService.getAppointmentLocation(this.serviceInfo,this.appointmentTime)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"dayOfMonth",{get:function(){return this.momentOfStartTime.format("ja"===moment.locale()?"Do":"D")},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"month",{get:function(){return this.momentOfStartTime.format("ja"===moment.locale()?"MMM":"MMMM")},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"bookedDateAria",{get:function(){return this.momentOfStartTime.format("MMMM D")},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"dayOfWeek",{get:function(){return this.momentOfStartTime.format("ddd")},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"fullDayOfWeek",{get:function(){return this.momentOfStartTime.format("dddd")},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"time",{get:function(){return this.momentOfStartTime.format(this.$translate("visitor.time-format"))},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"momentOfStartTime",{get:function(){var a=this.appointmentTime,b=a.startTime,c=a.timeZone;return this.momentOfTime(b,c)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"slotDuration",{get:function(){var a=this.appointmentTime.groupInstance;return a&&a.duration},enumerable:!0,configurable:!0}),b.prototype.momentOfTime=function(a,b){return this.appointmentTime?b?moment.tz(+a,b):moment(+a):moment()},Object.defineProperty(b.prototype,"staffName",{get:function(){return this.shouldPresentStaffMemberNames()?this.shouldPresentStaffFromAppointment()?this.appointmentTime.staffMember.fullName:this.shouldPresentStaffNamesFromSelectedService()?this.serviceInfo.staffMemberNames.join(", "):"":""},enumerable:!0,configurable:!0}),b.prototype.shouldPresentStaffMemberNames=function(){return this.staff&&this.staff.staff.length>0},b.prototype.shouldPresentStaffFromAppointment=function(){return this.appointmentTime&&this.appointmentTime.staffMember&&this.appointmentTime.staffMember.fullName},b.prototype.shouldPresentStaffNamesFromSelectedService=function(){return this.serviceInfo.staffMemberNames},b.prototype.getMinCharge=function(){return this.serviceInfo.minCharge},b.prototype.getSelectedNumberOfParticipants=function(){return this.serviceInfo.numberOfParticipants||1},b.prototype.isMultipleParticipants=function(){return!1},b.prototype.getCurrency=function(){return this.serviceInfo.currency},b.prototype.init=function(){if(this.businessInfo=this.$route.current.locals.businessInfo,this.staff=this.$route.current.locals.staff,this.serviceInfo=this.appointmentService.getSelectedOffering(),this.shouldShowMoreDetails=this.hasShortDetails(),this.addressKey=this.businessInfo.apartmentNum?"sidebar.address.line1":"sidebar.address.line1-no-apt",this.appointmentTime=this.appointmentService.getSelectedTime()||this.appointmentService.getLastSelectedTime(),this.appointmentTime&&this.appointmentService.setLastSelectedTime(this.appointmentTime),this.purchasedPricingPlan=c.fromDto(this.appointmentService.getPurchasedPricingPlan()),this.experimentsEnabler.isBookingsPackagesEnabled()&&this.paymentData&&this.paymentData.type===d.PRICING_PLAN){var a=this.paymentData;this.pricingPlanInfo={type:a.planType,sessions:a.planTotal,remains:a.planRemaining}}this.address=this.getAppointmentLocation(this.serviceInfo),this.setAddressInfo(),this.appointmentService.clearBookingFlow(),this.bookedAs=this.bookingProcess.calculateBookingMethod(this.serviceInfo,this.appointmentTime.bookedAs)},b.prototype.setAddressInfo=function(){this.addressInfo={offeringLocation:this.appointmentLocation,offeringLocationText:this.appointmentLocationText,businessLocation:this.businessInfo.businessLocation,businessName:this.businessInfo.name,businessAddress:this.$translate(this.addressKey,this.businessInfo),city:this.getCity(),formattedAddress:this.businessInfo.formattedAddress}},b.prototype.setParticipantsVisibility=function(a){this.participantsVisibility=a,this.cacheSrv.clearKey("appointmentDateTime")},b.prototype.showPricingPlanSection=function(){return this.serviceInfo.isPricingPlanOffering()&&this.bookedAs===OfferedAsType.PRICING_PLAN},b.prototype.isShowConferenceProvider=function(){return this.experimentsEnabler.isBookingsZoomIntegrationEnabled()&&this.serviceInfo.isOnlineMeetingConnected()},b.prototype.formatDate=function(a){return moment(parseInt(a,10)).toDate().toISOString().replace(/-|:|\.\d+/g,"")},b.prototype.createGoogleCalendarUrlForAppointment=function(a){var b=this.formatDate(a.time.startTime),c=this.formatDate(a.time.endTime),d=encodeURI(["https://www.google.com/calendar/render","?action=TEMPLATE","&text="+(a.title||""),"&dates="+(b||""),"/"+(c||""),"&location="+(a.location||""),"&sprop=&sprop=name:"].join(""));return d},b.prototype.concatenateAddressString=function(a,b){return void 0===b&&(b=!1),a.formattedAddress?a.formattedAddress:Object.keys(a).filter(function(a){return"formattedAddress"!==a&&("city"!==a||!b&&"city"===a)}).map(function(b){return a[b]}).join(", ")},b.prototype.handleLocationTextGiven=function(a){return{text:a}},b.prototype.getBusinessAddress=function(){return{street:this.businessInfo.address,city:this.businessInfo.city,apartmentNum:this.businessInfo.apartmentNum,formattedAddress:this.businessInfo.formattedAddress}},b.prototype.getAppointmentLocation=function(a){var b=this.requireAddress(a),c=a.locationText;return b?this.appointmentService.getContactInfo().address:c?this.handleLocationTextGiven(c):this.getBusinessAddress()},b.prototype.redirectToGoogleCalendar=function(){this.visitorBILogger.googleCalendar();var a={title:this.getServiceName(),time:this.appointmentTime,details:this.videoConferenceLink};return a.location=this.bookedLocation,this.$window.open(this.createGoogleCalendarUrlForAppointment(a),"GoogleCalendar"),a},b.prototype.getServiceName=function(){var a=this.serviceInfo.name;return this.serviceInfo.isPendingApprovalFlow?this.$translate("visitor.congratulations.pending-title",{serviceName:a}):a},b.prototype.doAddAnother=function(){this.visitorBILogger.bookAnother(),this.routeManager.gotoPage(this.bookAnotherPage)},b.getTemplateUrl=function(a){return a?"modules/congratulations-page/congratulations-old.preload.html":"modules/congratulations-page/congratulations.preload.html"},b.prototype.isShowLocation=function(){return this.appointmentService.isShowBusinessAddress(this.serviceInfo,this.appointmentTime,this.businessInfo,!0)},b.prototype.canAddToGoogleCalendar=function(){return!this.serviceInfo.isMultipleSessionOffering()},b.prototype.getCity=function(){return"CUSTOMER"===this.serviceInfo.location?this.address.city:this.appointmentService.getBusinessCity(this.businessInfo,this.serviceInfo,this.appointmentTime)},b.prototype.hasShortDetails=function(){return this.serviceInfo.isMultipleSessionOffering()&&this.serviceInfo.isSingleDayOffering()},b}();b.CongratulationsPage=e,angular.module("schedulerAngularClientAppInternal").component("bksCongratulationsPage",{templateUrl:["appConfig",function(a){return e.getTemplateUrl(a.getIsMobile())}],controller:e,bindings:{paymentData:"=",bookedLocation:"@",videoConferenceLink:"@"}})}(c=b.congrats||(b.congrats={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.bookings.account.bookings.PaymentTypes,d=function(){function a(a){this.$filter=a,this.priceFormatter=this.$filter("isoCurrency")}return a.$inject=["$filter"],Object.defineProperty(a.prototype,"paid",{get:function(){return this.bookedOffering.minCharge?this.payment.paid:0},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"priceText",{get:function(){return this.payment.type===c.PRICING_PLAN?this.bookedOffering.pricingPlanInfo.displayText:this.payment.getFormattedPrice(this.priceFormatter)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"currency",{get:function(){return this.payment.currency},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isDurationRequired",{get:function(){return!!this.bookedOffering.duration},enumerable:!0,configurable:!0}),a}();b.CongratulationsDurationPrice=d,angular.module("schedulerAngularClientAppInternal").component("bksCongratulationsDurationPrice",{templateUrl:"modules/congratulations-page/congratulations-duration-price/congratulations-duration-price.preload.html",controller:d,bindings:{payment:"=",bookedOffering:"=",slotDuration:"=",staffName:"@"}})}(c=b.congrats||(b.congrats={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(){function c(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){this.flowManagerSrv=a,this.appointmentService=b,this.$translate=c,this.cashierPaymentSrv=d,this.$wix=e,this.$rootScope=f,this.bookingDataSrv=g,this.$scope=h,this.modal=i,this.$timeout=j,this.trackingSrv=k,this.loadingEvents=l,this.visitorBILogger=m,this.bookingApiSrv=n,this.experimentsEnabler=o,this.slotNotAvailableModalSrv=p,this.showCashierWidget=!0}return c.$inject=["flowManagerSrv","appointmentService","$translate","cashierPaymentSrv","$wix","$rootScope","bookingDataSrv","$scope","modal","$timeout","trackingSrv","loadingEvents","visitorBILogger","bookingApiSrv","experimentsEnabler","slotNotAvailableModalSrv"],c.prototype.$onInit=function(){this.selectedOffering=this.appointmentService.getSelectedOffering(),this.numOfStaff=this.staff?this.staff.staff.length:0,this.handleListeners(),this.enableNextForFakeMode(),this.setOrderId(),this.setBookingId(),this.trackingSrv.trackPaymentStartEvent(this.selectedOffering),this.actionLabel=this.dynamicFormData.form.actions.actionLabel,this.isPreventDoubleBookingEnabled=this.shouldPreventDoubleBooking(),this.handleAvailabilityCheck()},c.prototype.shouldPreventDoubleBooking=function(){return this.selectedOffering.type!==OfferingType.COURSE&&this.experimentsEnabler.isPreventDoubleBookingEnabled()||this.selectedOffering.type===OfferingType.COURSE&&this.experimentsEnabler.isPreventDoubleBookingForCourseEnabled()},c.prototype.handleAvailabilityCheck=function(){this.isPreventDoubleBookingEnabled&&!this.isInFakeMode&&this.bookingId&&this.checkBookingAvailability()},c.prototype.checkBookingAvailability=function(){var a=this;this.bookingApiSrv.isBookingAvailable(this.bookingId).then(function(b){b.available?(a.destroyAvailabilityTimeout(),a.availabilityCheckTimout=setTimeout(function(){return a.checkBookingAvailability()},3e3)):a.isDoubleBooking=!0})},c.prototype.getBiOfferingType=function(){return this.selectedOffering.type},c.prototype.setOrderId=function(){this.orderId=this.bookingDataSrv.getOrderId(),this.cashierPaymentSrv.setOrderId(this.orderId)},c.prototype.setBookingId=function(){this.bookingId=this.bookingDataSrv.getBookingId()},c.prototype.handleListeners=function(){var a=this,c=this.$rootScope.$on(b.PaymentFailureStatus.RECREATING_NEW_ORDER,function(){a.showCashierWidget=!1,a.isNewTabOpen=!1});this.$scope.$on("$destroy",function(){return c()})},c.prototype.next=function(){this.isInFakeMode?this.handleFakePayment():this.handleRealPayment()},c.prototype.back=function(){this.visitorBILogger.backButtonPressed("payment",this.getBiOfferingType()),this.destroyAvailabilityTimeout(),this.flowManagerSrv.prev()},c.prototype.setCashierApi=function(a){var b=this;
this.cashierPaymentSrv.setCashierApi(a),a.on("payment:popup:open",function(){return b.handleNewTabOpened()}),this.isPayEnabled=!0},c.prototype.handleNewTabOpened=function(){if(!this.isNewTabOpen){this.removeLoader(),this.isNewTabOpen=!0;var a=this.cashierPaymentSrv.getCashierApi().getActivePaymentMethod().name;this.notificationTitle=this.$translate("payment-page.wallet.payment.notification.title",{paymentMethod:a}),this.notificationMessage=this.$translate("payment-page.wallet.payment.notification.message",{paymentMethod:a})}},Object.defineProperty(c.prototype,"shouldShowWixPayment",{get:function(){return!this.isInEditorMode&&this.showCashierWidget},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isInFakeMode",{get:function(){return this.$wix.isOverEditor()},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isInEditorMode",{get:function(){return this.$wix.isInEditingMode()},enumerable:!0,configurable:!0}),c.prototype.enableNextForFakeMode=function(){this.isInFakeMode&&(this.isPayEnabled=!0)},c.prototype.handleFakePayment=function(){this.flowManagerSrv.next()},c.prototype.handlePaymentFailure=function(c){switch(this.$rootScope.$broadcast(a.boost.visitor.directives.ScrollToMe.SCROLL_EVENT,{toElement:"scroll-to-cashier"}),c){case b.PaymentFailureStatus.NEW_ORDER_RECREATED:this.setBookingId(),this.showCashierWidget=!0;break;case b.PaymentFailureStatus.BOOKING_ERROR_SLOT_NOT_AVAILABLE:this.isPreventDoubleBookingEnabled&&(this.slotNotAvailableModalSrv.openModal(a.visitor.modals.ReferralInfo.DOUBLE_BOOKING_PAYMENT_PAGE_BOOK_CALL),this.destroyAvailabilityTimeout());break;case b.PaymentFailureStatus.PAYMENT_DECLINE:this.isNewTabOpen=!1,this.isPayEnabled=!0;break;case b.PaymentFailureStatus.CREDIT_CARD_NOT_VALID:this.isPayEnabled=!0}},c.prototype.handleRealPayment=function(){var b=this;this.isPayEnabled=!1,this.errorMessageKey="",this.isDoubleBooking?this.slotNotAvailableModalSrv.openModal(a.visitor.modals.ReferralInfo.DOUBLE_BOOKING_PAYMENT_PAGE):(this.showLoader(),this.cashierPaymentSrv.pay(this.orderId).then(function(){return b.handlePaymentSuccess()}).catch(function(a){return b.handlePaymentFailure(a)}).finally(function(){return b.removeLoader()}))},c.prototype.showLoader=function(){this.$rootScope.$broadcast(this.loadingEvents.LOADING_INDICATION_START)},c.prototype.removeLoader=function(){this.$rootScope.$broadcast(this.loadingEvents.LOADING_INDICATION_END)},c.prototype.handlePaymentSuccess=function(){this.isNewTabOpen=!1,this.flowManagerSrv.next()},c.prototype.onPaymentMethodChanged=function(a){this.actionLabel="inPerson"===a?this.dynamicFormData.form.actions.offlinePaymentLabel:this.dynamicFormData.form.actions.actionLabel},c.prototype.$onDestroy=function(){console.log("$onDestroy availabilityCheckTimout:",this.availabilityCheckTimout),this.destroyAvailabilityTimeout()},c.prototype.destroyAvailabilityTimeout=function(){this.availabilityCheckTimout&&clearTimeout(this.availabilityCheckTimout)},c}();b.PaymentPage=c,angular.module("schedulerAngularClientAppInternal").component("bksPaymentPage",{bindings:{timezone:"<",staff:"<",dynamicFormData:"<"},template:'<div class="payment-desktop-page" boost-scroll-to-me="scroll-to-cashier">\n              <div class=\'visitor-header\'>\n                <div class="visitor-header--back">\n                  <div class="header__back-btn" data-hook="back-button" ng-click="$ctrl.back()" role="button" tabindex="0">\n                      <div aria-hidden="true" class="back-btn-icon scheduler-svg-font-icons-arrow-left"></div>\n                      <div class="back-btn-text">{{\'visitor.navigate.back\'|translate}}</div>\n                  </div>\n                </div>\n                <div class="error-container" ng-if="$ctrl.errorMessageKey">\n                  <div class="error-message" data-hook="error-message">{{$ctrl.errorMessageKey | translate}}</div>\n                </div>\n                <div class="visitor-header--titles">\n                  <div class="page-title" data-hook="page-title">{{\'payment-page.title\' | wixSdkTranslate: \'paymentPageTitleText\'}}</div>\n                </div>\n              </div>\n              <div class="sectioned-page">\n                  <div class="sectioned-page__main">\n                      <div ng-if="$ctrl.shouldShowWixPayment" data-hook="wix-payment" class="payment-desktop-page__payment-container">\n                          <bks-cashier-payment on-cashier-api-ready="$ctrl.setCashierApi(api)" \n                                               on-payment-method-changed="$ctrl.onPaymentMethodChanged(selectedPaymentMethod)"\n                                               submit-button-text="{{$ctrl.actionLabel}}" dynamic-form-data="$ctrl.dynamicFormData"/>\n                          <div ng-if="$ctrl.isNewTabOpen" data-hook="wallet-payment-notification-modal">\n                            <bks-wallet-payment-notification-modal notification-title="{{$ctrl.notificationTitle}}" notification-message="{{$ctrl.notificationMessage}}"/>\n                          </div>\n                      </div>\n                      <bks-fake-wix-payment ng-if="$ctrl.isInEditorMode" data-hook="wix-fake-payment"/>\n                      <div class="payment-desktop-page__space"></div>\n                  </div>\n                  <boost-visitor-sidebar action-click="$ctrl.next()"\n                                         action-enabled="$ctrl.isPayEnabled"\n                                         action-label="$ctrl.actionLabel"\n                                         aria-action-label="$ctrl.actionLabel"\n                                         data-hook="payment-sidebar"\n                                         is-last-step="true"\n                                         sidebar-show-upfront="true"\n                                         num-of-staff="$ctrl.numOfStaff"\n                                         timezone="{{$ctrl.timezone}}">\n                  </boost-visitor-sidebar>\n              </div>\n          </div>',controller:c})}(c=b.payment||(b.payment={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.$scope=a,this.showPopover=!0}return a.$inject=["$scope"],a.prototype.$onInit=function(){var a=angular.element("body");this.closePopover=this.closePopover.bind(this),a.click(this.closePopover)},a.prototype.closePopover=function(){var a=angular.element("body");this.showPopover=!1,this.$scope.$apply(),a.off("click",this.closePopover)},a}();a.FakeWixPayment=b,angular.module("schedulerAngularClientAppInternal").component("bksFakeWixPayment",{template:'\n        <div class="fake-wix-payment">\n          <div ng-if="$ctrl.showPopover" class="fake-wix-payment__popover" data-hook="fake-wix-payment-popover">\n              <div class="fake-wix-payment__icon scheduler-svg-font-icons-info"></div>\n              <div class="fake-wix-payment__text">{{\'fake-payment.info-text\' | translate}}</div>\n          </div>\n        </div>',controller:b})}(b=a.payment||(a.payment={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j){this.appointmentService=a,this.bookingDataSrv=b,this.$wix=c,this.$locale=d,this.$element=e,this.$rootScope=f,this.$scope=g,this.experimentsEnabler=h,this.dynamicFormSrv=i,this.fedopsLogger=j}return a.$inject=["appointmentService","bookingDataSrv","$wix","$locale","$element","$rootScope","$scope","experimentsEnabler","dynamicFormSrv","fedopsLogger"],a.prototype.$onInit=function(){this.initCashierComponentsProps()},a.prototype.initCashierComponentsProps=function(){var a=this;this.props={configuration:this.getConfiguration(),externalSubmitButton:!0,walletPaymentInNewTab:!0,submitButtonText:this.submitButtonText,paymentMethodChanged:function(b){return a.onPaymentMethodChanged({selectedPaymentMethod:b})},onPaymentComplete:function(b,c){c&&"FAILED"===c.status?(a.fedopsLogger.interactionStarted("failed-payment-transaction"),a.fedopsLogger.interactionEnded("failed-payment-transaction")):c&&"DECLINED"===c.status&&(a.fedopsLogger.interactionStarted("declined-payment-transaction"),a.fedopsLogger.interactionEnded("declined-payment-transaction"))},ref:function(b){return a.receiveCashierApi(b)}};var b=this.appointmentService.getSelectedOffering().paymentType;"ALL"===b&&(this.experimentsEnabler.isCashierAllowManualPaymentExperimentEnabled()?this.props.allowInPersonPayment=!0:this.props.includePaymentMethods=["inPerson"]),this.props.shouldApplySiteStyles=!0,this.props.allowManualPayment=this.experimentsEnabler.isCashierAllowManualPaymentExperimentEnabled(),this.props.creditCardPaymentInNewTab=this.experimentsEnabler.isCreditCardInNewTabExperimentEnabled();try{this.props.mandatoryFieldsPrefilled=this.dynamicFormSrv.mapDynamicFormToCashierMandatoryFields(this.dynamicFormData)}catch(c){console.log(c,"failed to set mandatory fields")}},a.prototype.receiveCashierApi=function(a){var b=this;a&&(a.getApi().then(function(a){return b.onCashierApiReady({api:a})}),this.setIntervalToHandleCashierHeightChanges())},a.prototype.setIntervalToHandleCashierHeightChanges=function(){var a=this,b=setInterval(function(){return a.handleCashierHeightChanges()},1e3);this.clearCashierHeightInterval(b)},a.prototype.handleCashierHeightChanges=function(){var a=this.$element.find('[data-hook="cashier-component-container"]').outerHeight();this.cashierHeight!==a&&(this.$rootScope.$digest(),this.cashierHeight=a)},a.prototype.clearCashierHeightInterval=function(a){this.$scope.$on("$destroy",function(){return clearInterval(a)})},a.prototype.getConfiguration=function(){return{appInstanceId:this.instanceId(),snapshotId:this.orderId(),locale:this.$locale.id.slice(0,2),appId:"13d21c63-b5ec-5912-8397-c3a5ddb27a97",visitorId:this.visitorId()}},a.prototype.instanceId=function(){return this.$wix.getBusinessId()},a.prototype.visitorId=function(){return this.$wix.getVisitorId()},a.prototype.orderId=function(){return this.bookingDataSrv.getOrderId()},a}();a.CashierPayment=b,angular.module("schedulerAngularClientAppInternal").component("bksCashierPayment",{bindings:{onCashierApiReady:"&",onPaymentMethodChanged:"&",submitButtonText:"@",dynamicFormData:"<"},template:'<div data-hook="cashier-component-container">\n                    <react-component name="CashierPaymentsWrapper" props="$ctrl.props" watch-depth="reference" />\n                 </div>',controller:b}).factory("CashierPaymentsWrapper",function(){return window.CashierPaymentsWrapper.CashierPaymentsWrapper})}(b=a.payment||(a.payment={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var OrderByLowerCase=function(){function a(){}return a.prototype.filter=function(b,c){return b.sort(function(b,d){return a.sortByStringNoCase(b[c],d[c])})},a.sortByStringNoCase=function(a,b){var c=a?a.toLowerCase():"",d=b?b.toLowerCase():"";return c>d?1:d>c?-1:0},a.FILTER_NAME="boostOrderByLowerCase",a}();angular.module("schedulerAngularClientAppInternal").filter(OrderByLowerCase.FILTER_NAME,function(){return(new OrderByLowerCase).filter});var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.$wix=a}return a.$inject=["$wix"],a.prototype.scroll=function(a,b){var c=this;void 0===b&&(b=25),this.$wix.getBoundingRectAndOffsets(function(d){return c.calculateAndScroll(d,b,a)})},a.prototype.calculateAndScroll=function(a,b,c){this.requestScrolling(this.calculateToPosition(a,b,c))},a.prototype.calculateToPosition=function(a,b,c){var d=b+0;return a.offsets.y+$(c).offset().top-d},a.prototype.requestScrolling=function(a){this.$wix.scrollTo(0,a,{scrollAnimation:!0})},a}();a.ScrollToElementSrv=b,angular.module("schedulerAngularClientCommon").service("scrollToElementSrv",b)}(b=a.common||(a.common={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.DEFAULT_WAIT_INTERVALS=40,a.BOOKINGS_MAIN_VIEW_HOOK="bookings-main-content",a.BOOKINGS_MAIN_VIEW_SELECTOR='[data-hook="'+a.BOOKINGS_MAIN_VIEW_HOOK+'"]';var b=function(){function b(a,b,c){this.libs=a,this.$timeout=b,this.$q=c}return b.$inject=["libs","$timeout","$q"],b.prototype.waitForBookingsVisibility=function(b,c){var d=this;void 0===b&&(b=a.DEFAULT_WAIT_INTERVALS),void 0===c&&(c=200);var e=this.libs.$(a.BOOKINGS_MAIN_VIEW_SELECTOR).is(":visible");return e?this.$q.when(!0):b>0?this.$timeout(function(){return d.waitForBookingsVisibility(b-1,c)},c):this.$q.when(!1)},b}();a.WaitForBookingsVisibilitySrv=b,angular.module("schedulerAngularClientCommon").service("waitForBookingsVisibilitySrv",b)}(b=a.ui||(a.ui={}))}(b=a.common||(a.common={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(b,c,d){var e=this;this.scrollToElementSrv=c,this.$attrs=d,b.$on(a.SCROLL_EVENT,function(a,b){var c=b.offset,d=b.toElement;return e.scroll(c,d)})}return a.$inject=["$scope","scrollToElementSrv","$attrs"],a.prototype.scroll=function(a,b){"number"!=typeof a&&(a=0),b===this.$attrs.boostScrollToMe&&this.scrollToElementSrv.scroll('[boost-scroll-to-me="'+b+'"]',a)},a.SCROLL_EVENT="SCROLL_EVENT",a}();a.ScrollToMe=b,angular.module("schedulerAngularClientCommon").directive("boostScrollToMe",function(){return{restrict:"A",controller:b,controllerAs:"$crtl",bindToController:!0}})}(b=a.directives||(a.directives={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(){var b=a.bookings.accessibility.navigateWithHorizontalArrowWhileOnElement;angular.module("schedulerAngularClientAppInternal").directive("withHorizontalNavigation",function(){return{restrict:"A",link:function(a,c){return c.keydown(function(a){var d=a.which;b(d,c)})}}})}(c=b.directives||(b.directives={}))}(c=b.common||(b.common={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(){var b=a.bookings.accessibility.navigateWithVerticalArrowWhileOnElement;angular.module("schedulerAngularClientAppInternal").directive("withVerticalNavigation",function(){return{restrict:"A",link:function(a,c,d){return c.keydown(function(a){var e=d.withVerticalNavigation,f=void 0===e?"":e;b(a.which,c,f)})}}})}(c=b.directives||(b.directives={}))}(c=b.common||(b.common={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var ParticipantsSummaryComponent=function(){function a(a,b,c,d){var e=this;this.appConfig=c,this.$translate=d,this.selectedOffering=a.getSelectedOffering(),this.selectedTime=a.getSelectedTime(),this.currentBooking=a.getCurrentBooking(),this.notifyVisibilityChangeIfRequired(),this.appConfig.getIsMobile()||b.$on(wix.boost.visitor.VisitorSidebar.EVENTS.SERVICE_UPDATED,function(a,b){e.selectedOffering=b})}return a.$inject=["appointmentService","$rootScope","appConfig","$translate"],a.prototype.isNumberOfParticipantsRequired=function(){return!this.appConfig.getIsMobile()&&(this.isMaxParticipantsOverOne()&&this.isOverOneRoomsLeft()||this.isHaveMultipleParticipants())},a.prototype.isHaveMultipleParticipants=function(){return!!this.currentBooking&&this.currentBooking.numOfParticipants>1},a.prototype.isMaxParticipantsOverOne=function(){return this.selectedOffering.maxParticipantsPerOrder>1},a.prototype.isOverOneRoomsLeft=function(){return this.selectedTime&&this.selectedTime.groupInstance?this.selectedTime.groupInstance.capacity-this.selectedTime.groupInstance.registered>1:!1},a.prototype.getTranslateParams=function(){return{numberOfParticipants:this.selectedOffering.numberOfParticipants||1}},a.prototype.getTranslate=function(){return this.$translate("participants-summary.participants",this.getTranslateParams())},a.prototype.getFullTranslate=function(){return this.$translate("participants-summary.accessibility.participants",this.getTranslateParams())},a.prototype.notifyVisibilityChangeIfRequired=function(){this.onVisibilityChanged&&this.onVisibilityChanged({value:this.isNumberOfParticipantsRequired()})},a}();angular.module("schedulerAngularClientAppInternal").component("boostParticipantsSummary",{template:'<div data-hook="participants-summary-container" ng-if="$ctrl.isNumberOfParticipantsRequired()" aria-label="{{$ctrl.getFullTranslate()}}">{{$ctrl.getTranslate()}}</div>',controller:ParticipantsSummaryComponent,bindings:{onVisibilityChanged:"&"}});var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.NAVIGATION_IN_PROGRESS_CLASS="bookings-navigation-in-progress",angular.module("schedulerAngularClientAppInternal").directive("bksEmptyPageNavigation",function(){return{restrict:"A",bindToController:!0,link:function(b,c){b.$on(WixPageNavigation.PAGE_NAVIGATION_STARTED,function(){c.addClass(a.NAVIGATION_IN_PROGRESS_CLASS)}),b.$on(WixPageNavigation.PAGE_NAVIGATION_ENDED,function(){c.removeClass(a.NAVIGATION_IN_PROGRESS_CLASS)})}}})}(b=a.navigation||(a.navigation={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var WixPageNavigation=function(){function a(a,b,c,d,e,f,g,h){this.$wix=a,this.clientPages=b,this.routeManager=c,this.$rootScope=d,this.environmentStorage=e,this.$location=f,this.$window=g,this.entryPointNavigationSrv=h}return a.$inject=["$wix","clientPages","routeManager","$rootScope","environmentStorage","$location","$window","entryPointNavigationSrv"],a.prototype.init=function(){var a=this;this.$wix.getComponentInfo(function(b){a.pageId=b.pageId,a.environmentStorage.setItem(ClientConst.BOOKINGS_PAGE_ID,a.pageId),a.setListener()})},a.prototype.setListener=function(){var b=this;this.$wix.subscribeToExternalEvent(WidgetDeepLinkConst.REFRESH_APP,function(){return b.routeFromStorageData()},!0),this.$wix.addEventListener(this.$wix.Events.PAGE_NAVIGATION_IN,function(a){a.toPage===b.pageId&&!a.wasAppOnPage&&a.isAppOnPage&&b.routeFromStorageData()}),this.$wix.addEventListener(this.$wix.Events.PAGE_NAVIGATION_OUT,function(c){c.wasAppOnPage&&!c.isAppOnPage&&b.$rootScope.$broadcast(a.PAGE_NAVIGATION_STARTED)})},a.prototype.routeFromStorageData=function(){var b=this;this.$rootScope.$applyAsync(function(){b.routeManager.suspendFocus=!0,b.entryPointNavigationSrv.getNavigationServiceToUse().then(function(c){c&&(c.isRefreshNeeded()?b.$window.location.reload():b.entryPointNavigationSrv.doServiceNavigation(c),b.$rootScope.$broadcast(a.PAGE_NAVIGATION_ENDED))})})},a.PAGE_NAVIGATION_STARTED="PAGE_NAVIGATION_STARTED",a.PAGE_NAVIGATION_ENDED="PAGE_NAVIGATION_ENDED",a}();angular.module("schedulerAngularClientAppInternal").service("wixPageNavigation",WixPageNavigation);var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.prototype.isRefreshNeeded=function(){return!1},a}();a.RedirectService=b}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(b){var c;!function(b){var c=a.bookings.visitor.RedirectService,d=function(a){function b(b,c,d,e){var f=a.call(this)||this;return f.userManagementSrv=b,f.$q=c,f.visitorBILogger=d,f.$wix=e,f}return __extends(b,a),b.$inject=["userManagementSrv","$q","visitorBILogger","$wix"],b.prototype.isRedirectRequired=function(){return __awaiter(this,void 0,void 0,function(){var a;return __generator(this,function(){return a=this.$q.defer(),a.resolve(this.userManagementSrv.isUserBackFromLogin()),[2,a.promise]})})},b.prototype.isRefreshNeeded=function(){return!0},b.prototype.doRedirect=function(){this.sendBiForNewLoggedInUser(),this.userManagementSrv.restoreLoginState()},b.prototype.getName=function(){return"redirect-to-post-login"},b.prototype.sendBiForNewLoggedInUser=function(){var a=this.userManagementSrv.getPreviousPageInfo();this.visitorBILogger.logLoginComplete({success:!0,visitorIdAnon:a.visitorIdAnon})},b}(c);b.PostLoginNavigationService=d,angular.module("schedulerAngularClientAppInternal").service("postLoginNavigationSrv",d)}(c=b.user||(b.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(b){var c;!function(b){var c=a.bookings.visitor.RedirectService;b.OVER_EDITOR_REDIRECT_TO_KEY="OVER_EDITOR_REDIRECT_TO_KEY";var d=function(a){function c(b,c,d){var e=a.call(this)||this;return e.$q=b,e.cacheSrv=c,e.routeManager=d,e}return __extends(c,a),c.$inject=["$q","cacheSrv","routeManager"],c.prototype.isRedirectRequired=function(){return __awaiter(this,void 0,void 0,function(){var a;return __generator(this,function(){return a=this.$q.defer(),a.resolve(!!this.getDesiredSettingsRoute()),[2,a.promise]})})},c.prototype.doRedirect=function(){var a=this.getDesiredSettingsRoute();this.cacheSrv.clearKey(b.OVER_EDITOR_REDIRECT_TO_KEY),this.routeManager.replacePage(a)},c.prototype.getName=function(){return"over-editor"},c.prototype.setRedirectRequired=function(a){this.cacheSrv.setToCache(b.OVER_EDITOR_REDIRECT_TO_KEY,a)},c.prototype.getDesiredSettingsRoute=function(){return this.cacheSrv.getFromCache(b.OVER_EDITOR_REDIRECT_TO_KEY)},c}(c);b.OverEditorNavSrv=d,angular.module("schedulerAngularClientAppInternal").service("overEditorNavigationSrv",d)}(c=b.user||(b.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.serviceConst=a}return a.$inject=["serviceConst"],a.prototype.adjustSelectedOfferingForSidebar=function(a,b){return __assign({},a,{location:this.serviceConst.LOCATION_OTHER,locationText:b.locationInfo,numberOfParticipants:b.numOfParticipants,price:this.totalPrice(b.numOfParticipants,a.price)})},a.prototype.totalPrice=function(a,b){return a*b},a}();a.OfferingDtoModifier=b,angular.module("schedulerAngularClientAppInternal").service("offeringDtoModifierSrv",b)}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d){var e=a.call(this)||this;return e.routeManager=b,e.clientPages=c,e.visitorBILogger=d,e}return __extends(b,a),b.$inject=["routeManager","clientPages","visitorBILogger"],b.prototype.isRedirectRequired=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,!0]})})},b.prototype.doRedirect=function(){this.doFallbackRedirect()},b.prototype.getName=function(){return"redirect-to-offering-list"},b.prototype.doFallbackRedirect=function(){this.visitorBILogger.servicesPageOpened("private"),this.routeManager.replacePage(this.clientPages.VISITOR_SERVICES)},b}(a.RedirectService);a.FallbackNavigationService=b,angular.module("schedulerAngularClientAppInternal").service("fallbackNavigationSrv",b)}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(b){var c;!function(b){var c=a.bookings.visitor.RedirectService,d=function(a){function b(b,c,d,e,f,g){var h=a.call(this)||this;return h.routeManager=b,h.clientPages=c,h.flowManagerSrv=d,h.$q=e,h.$wix=f,h.appointmentService=g,h}return __extends(b,a),b.$inject=["routeManager","clientPages","flowManagerSrv","$q","$wix","appointmentService"],b.prototype.isRedirectRequired=function(){return __awaiter(this,void 0,void 0,function(){var a;return __generator(this,function(b){switch(b.label){case 0:return a=this.$wix.isOverEditor(),a?[4,this.$wix.isBookingsSplitted()]:[3,2];case 1:a=b.sent(),b.label=2;case 2:return[2,a&&this.shouldInitBookOfferingPageFlow()]}})})},b.prototype.shouldInitBookOfferingPageFlow=function(){var a=this.appointmentService.getSelectedOffering();return a.dummy},b.prototype.doRedirect=function(){var a=this;this.flowManagerSrv.initOverEditorBookOfferingPage(this.appointmentService.getSelectedOffering()).then(function(){a.routeManager.replacePage(a.clientPages.OFFERING_PAGE)})},b.prototype.getName=function(){return"split-bookings-over-editor-navigation"},b}(c);b.SplitBookingsOverEditorNavigationSrv=d,angular.module("schedulerAngularClientAppInternal").service("splitBookingsOverEditorNavigationSrv",d)}(c=b.user||(b.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)
}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(b){var c;!function(b){var c=function(b){function c(a,c,d,e,f,g,h,i){var j=b.call(this)||this;return j.routeManager=a,j.clientPages=c,j.offeringFinder=d,j.flowManagerSrv=e,j.visitorBILogger=f,j.$q=g,j.environmentStorage=h,j.experimentsEnabler=i,j}return __extends(c,b),c.$inject=["routeManager","clientPages","offeringFinder","flowManagerSrv","visitorBILogger","$q","environmentStorage","experimentsEnabler"],c.prototype.isRefreshNeeded=function(){return!0},c.prototype.isRedirectRequired=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(a){switch(a.label){case 0:return[4,this.environmentStorage.hasItem(WidgetDeepLinkConst.DEEP_LINK)];case 1:return[2,a.sent()]}})})},c.prototype.getName=function(){return"redirect-to-widget-deeplink"},c.prototype.doRedirect=function(){var a=this;this.environmentStorage.popItem(WidgetDeepLinkConst.DEEP_LINK).then(function(b){var c=b[WidgetDeepLinkConst.SERVICE_ID],d=b[WidgetDeepLinkConst.INTENT];a.redirectPerOfferingId(c,d)})},c.prototype.redirectPerOfferingId=function(a,b){var c=this;this.offeringFinder.find(a).then(function(a){return a?(c.logCalendarOpenedNavigation(b,a),c.flowManagerSrv.initiateOfferingWidget(a,b).then(function(){return c.logNavigationFromWidget(a,b)}).then(function(){return c.flowManagerSrv.goToFirstPage()})):(c.showServiceNotAvailable(),void 0)})},c.prototype.showServiceNotAvailable=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_SERVICES)},c.prototype.logCalendarOpenedNavigation=function(a,b){var c=b.id,d=b.type;a===WidgetDeepLinkIntent.BOOK_OFFERING&&this.visitorBILogger.logDeepLinkCalendarOpened({referralInfo:"widget",service_id:c,type:d})},c.prototype.logNavigationFromWidget=function(b,c){this.visitorBILogger.logNavigationFromWidget({type:b.type,referralInfo:a.bookings.visitor.bi.NavFromWidgetIntent.WIDGET,serviceId:b.id,bookingIntent:c,acceptOnlineBookings:b.isPossibleToBook})},c}(b.RedirectService);b.WidgetDeepLinkNavigationService=c,angular.module("schedulerAngularClientAppInternal").service("widgetDeepLinkNavigationSrv",c)}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(b){var c;!function(b){var c=a.bookings.visitor.RedirectService,d=function(a){function b(b,c,d,e,f,g,h,i,j,k,l,m){var n=a.call(this)||this;return n.routeManager=b,n.boostInjectionPersister=c,n.clientPages=d,n.flowManagerSrv=e,n.offeringFinder=f,n.offeringValidationsSrv=g,n.sessionFinderSrv=h,n.pricingPlanFinderSrv=i,n.businessInfoSrv=j,n.visitorStaffSrv=k,n.accountManagementApiSrv=l,n.$q=m,n}return __extends(b,a),b.$inject=["routeManager","boostInjectionPersister","clientPages","flowManagerSrv","offeringFinder","offeringValidationsSrv","sessionFinderSrv","pricingPlanFinderSrv","businessInfoSrv","visitorStaffSrv","accountManagementApiSrv","$q"],b.prototype.isRedirectRequired=function(){return __awaiter(this,void 0,void 0,function(){var a,b,c;return __generator(this,function(d){switch(d.label){case 0:return b=(a=this.$q).resolve,c=this.boostInjectionPersister.isSpecificOfferingRequested()&&this.boostInjectionPersister.isSpecificSessionRequested(),c?[4,this.sessionFinderSrv.findInjectedDeepLink()]:[3,2];case 1:c=!d.sent().isFull,d.label=2;case 2:return[2,b.apply(a,[c])]}})})},b.prototype.doRedirect=function(){var a=this;Promise.all([this.offeringFinder.findInjectedDeepLink(),this.sessionFinderSrv.findInjectedDeepLink(),this.pricingPlanFinderSrv.findInjectedDeepLink(),this.businessInfoSrv.gettingBusinessInfo(),this.visitorStaffSrv.gettingStaffMembers()]).then(function(b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=a.visitorStaffSrv.getStaffListByIds([d.staffMemberId],g)[0];a.flowManagerSrv.initiateBookFromCorvidLink(c,d,e,f.timeZone,h).then(function(){a.flowManagerSrv.goToFirstPage()})})},b.prototype.getName=function(){return"redirect-to-contact-form"},b}(c);b.ContactFormNavigationSrv=d,angular.module("schedulerAngularClientAppInternal").service("contactFormNavigationSrv",d)}(c=b.user||(b.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(b){var c;!function(b){var c,d=a.bookings.visitor.RedirectService;!function(a){a.OFFERING_PAGE_FROM_SINGLE_WIDGET="details-single-widget",a.OFFERING_PAGE_FROM_SERVICE_LIST_WIDGET="details-service-list"}(c=b.OfferingPageIntent||(b.OfferingPageIntent={}));var e=function(a){function b(b,c,d,e,f,g,h,i){var j=a.call(this)||this;return j.routeManager=b,j.boostInjectionPersister=c,j.clientPages=d,j.flowManagerSrv=e,j.offeringFinder=f,j.$q=g,j.$wix=h,j.visitorBILogger=i,j}return __extends(b,a),b.$inject=["routeManager","boostInjectionPersister","clientPages","flowManagerSrv","offeringFinder","$q","$wix","visitorBILogger"],b.prototype.isRedirectRequired=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.$q.resolve(this.boostInjectionPersister.isSpecificOfferingRequested())]})})},b.prototype.doRedirect=function(){var a=this;this.offeringFinder.findInjectedDeepLink().then(function(b){b&&a.logDirectLink(b.isPossibleToBook),a.flowManagerSrv.initiateBookFromOfferPageLink(b).then(function(){a.routeManager.replacePage(a.clientPages.OFFERING_PAGE)})})},b.prototype.getName=function(){return"redirect-to-offering-page"},b.prototype.logDirectLink=function(a){var b=this.$wix.getUrlReferral(),c=b?b:"direct-link";this.visitorBILogger.logShowOfferingDetails(c,a)},b}(d);b.OfferingPageNavigationSrv=e,angular.module("schedulerAngularClientAppInternal").service("offeringPageNavigationSrv",e)}(c=b.user||(b.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.days=["sun","mon","tue","wed","thu","fri","sat"],this.format="HH:mm"}return a.prototype.applyTimezoneOnWorkingHours=function(a,b,c){var d,e=this,f=this,g=f.days,h=f.format;return a&&(d={},g.forEach(function(f){a[f]&&a[f].workingHours.forEach(function(i){var j=i.workingHour,k=j.startTime,l=j.endTime,m=e.applyCurrentTimezone({time:k,day:f,businessTimezone:b,currentTimezone:c}),n=e.applyCurrentTimezone({time:l,day:f,businessTimezone:b,currentTimezone:c}),o={startTime:m.format(h),endTime:n.format(h)},p=__assign({},i,{workingHour:o}),q=g[m.day()];e.createNewClassHoursDay(d,a[f],q),d[q].workingHours.push(p)})})),d},a.prototype.applyCurrentTimezone=function(a){var b=a.time,c=a.day,d=a.businessTimezone,e=a.currentTimezone,f=this.days.indexOf(c);return moment.tz(b,this.format,d).day(f).tz(e)},a.prototype.createNewClassHoursDay=function(a,b,c){a[c]||(a[c]={workingHours:[],enabled:b.enabled})},a}();a.TimezoneUtils=b,angular.module("schedulerAngularClientAppInternal").service("timezoneUtils",b)}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(b){var c;!function(b){var c,d=a.bookings.visitor.RedirectService;!function(a){a.CALENDAR="calendar",a.BOOK="book",a.BOOK_FROM_SINGLE_WIDGET="book-single-widget",a.BOOK_FROM_SERVICE_LIST_WIDGET="book-service-list"}(c=b.BookIntent||(b.BookIntent={}));var e=function(a){function b(b,c,d,e,f,g,h){var i=a.call(this)||this;return i.boostInjectionPersister=b,i.flowManagerSrv=c,i.offeringFinder=d,i.$q=e,i.$wix=f,i.offeringValidationsSrv=g,i.visitorBILogger=h,i}return __extends(b,a),b.$inject=["boostInjectionPersister","flowManagerSrv","offeringFinder","$q","$wix","offeringValidationsSrv","visitorBILogger"],b.prototype.isRedirectRequired=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.$q.resolve(this.boostInjectionPersister.isSpecificOfferingRequested()&&b.bookIntents.indexOf(this.boostInjectionPersister.getFlowStep())>-1)]})})},b.prototype.doRedirect=function(){var a=this;this.offeringFinder.findInjectedDeepLink().then(function(b){b&&a.logDirectLink(b.isPossibleToBook),a.offeringValidationsSrv.isCalendarDeepLinkAllowed(b)?a.flowManagerSrv.initiateBookDeepLink(b).then(function(){a.logCalendarDeepLinkSuccess(b),a.flowManagerSrv.goToFirstPage()}):a.flowManagerSrv.initiateBookFromOfferPageLink(b).then(function(){a.flowManagerSrv.goToFirstPage()})})},b.prototype.logDirectLink=function(a){this.visitorBILogger.logShowOfferingDetails("direct-link-calendar",a)},b.prototype.logCalendarDeepLinkSuccess=function(a){var b=this.$wix.getUrlReferral(),c=b?b:"calendar-deep-link";this.visitorBILogger.logDeepLinkCalendarOpened({service_id:a.id,type:a.type,referralInfo:c})},b.prototype.getName=function(){return"redirect-to-calendar-page"},b.bookIntents=Object.keys(c).map(function(a){return c[a]}),b}(d);b.BookIntentNavigationSrv=e,angular.module("schedulerAngularClientAppInternal").service("bookIntentNavigationSrv",e)}(c=b.user||(b.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g){var h=a.call(this)||this;return h.$q=b,h.$timeout=c,h.$wix=d,h.flowManagerSrv=e,h.experimentsEnabler=f,h.environmentStorage=g,h}return __extends(b,a),b.$inject=["$q","$timeout","$wix","flowManagerSrv","experimentsEnabler","environmentStorage"],b.prototype.isRedirectRequired=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(a){switch(a.label){case 0:return[4,this.environmentStorage.hasItem(MemberAreaDeepLinkConst.BOOK_ANOTHER_DEEP_LINK_NAME)];case 1:return[2,a.sent()]}})})},b.prototype.getName=function(){return"redirect-to-member-area-book-another-deeplink"},b.prototype.doRedirect=function(){var a=this;this.environmentStorage.popItem(MemberAreaDeepLinkConst.BOOK_ANOTHER_DEEP_LINK_NAME).then(function(b){a.redirectToBooking(b[MemberAreaDeepLinkConst.BOOKING])})},b.prototype.redirectToBooking=function(a){var b=this;this.flowManagerSrv.initiateMemberAreaBookAnother(a).then(function(){b.flowManagerSrv.goToFirstPage()})},b}(a.RedirectService);a.MemberAreaBookAnotherDeepLinkNavigationService=b,angular.module("schedulerAngularClientAppInternal").service("memberAreaBookAnotherDeepLinkNavigationSrv",b)}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g,h){var i=a.call(this)||this;return i.$q=b,i.$wix=c,i.flowManagerSrv=d,i.$timeout=e,i.businessInfoSrv=f,i.experimentsEnabler=g,i.environmentStorage=h,i}return __extends(b,a),b.$inject=["$q","$wix","flowManagerSrv","$timeout","businessInfoSrv","experimentsEnabler","environmentStorage"],b.prototype.isRedirectRequired=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(a){switch(a.label){case 0:return[4,this.environmentStorage.hasItem(MemberAreaDeepLinkConst.RESCHEDULE_DEEP_LINK_NAME)];case 1:return[2,a.sent()]}})})},b.prototype.getName=function(){return"redirect-to-member-area-reschedule-deeplink"},b.prototype.doRedirect=function(){return __awaiter(this,void 0,void 0,function(){var a=this;return __generator(this,function(){return this.environmentStorage.popItem(MemberAreaDeepLinkConst.RESCHEDULE_DEEP_LINK_NAME).then(function(b){a.redirectToBooking(b[MemberAreaDeepLinkConst.BOOKING])}),[2]})})},b.prototype.redirectToBooking=function(a){return __awaiter(this,void 0,void 0,function(){var b;return __generator(this,function(c){switch(c.label){case 0:return[4,this.getTimezone()];case 1:return b=c.sent(),[4,this.flowManagerSrv.initiateMemberAreaReschedule(a,b)];case 2:return c.sent(),this.flowManagerSrv.goToFirstPage(),[2]}})})},b.prototype.getTimezone=function(){var a=this.$q.defer();return this.businessInfoSrv.gettingBusinessInfo().then(function(b){return a.resolve(b.timeZone)}),a.promise},b}(a.RedirectService);a.MemberAreaRescheduleDeepLinkNavigationService=b,angular.module("schedulerAngularClientAppInternal").service("memberAreaRescheduleDeepLinkNavigationSrv",b)}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=2&c[0]?f["return"]:c[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[2&c[0],g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i,j,k){var l=a.call(this)||this;return l.userPurchasedPlanSrv=b,l.transactionIdSrv=c,l.appointmentService=d,l.$route=e,l.routeManager=f,l.experimentsEnabler=g,l.userManagementSrv=h,l.$wix=i,l.visitorBILogger=j,l.clientPages=k,l}return __extends(b,a),b.$inject=["userPurchasedPlanSrv","transactionIdSrv","appointmentService","$route","routeManager","experimentsEnabler","userManagementSrv","$wix","visitorBILogger","clientPages"],b.prototype.isRedirectRequired=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.transactionIdSrv.isTransactionIdsEquals()]})})},b.prototype.getName=function(){return"redirect-from-pricing-plan-deeplink"},b.prototype.doRedirect=function(){return __awaiter(this,void 0,void 0,function(){var a=this;return __generator(this,function(){return this.visitorBILogger.logDeepLinkPricingPlan(),this.userPurchasedPlanSrv.bookableSelected(Number(this.appointmentService.getSelectedTime().startTime)).then(function(b){a.appointmentService.setPurchasedPricingPlan(b),b?a.navigateToContactInfo():a.navigateToCalendar(),a.transactionIdSrv.clearTransactionIdFromCache()}).catch(function(b){console.log(b),a.navigateToCalendar()}),[2]})})},b.prototype.navigateToCalendar=function(){var a=this.appointmentService.getSelectedOffering().type;a===OfferingType.INDIVIDUAL?this.routeManager.replacePage(this.clientPages.VISITOR_CALENDAR):a===OfferingType.GROUP&&this.routeManager.replacePage(this.clientPages.VISITOR_GROUPS_CALENDAR)},b.prototype.navigateToContactInfo=function(){this.routeManager.replacePage(this.clientPages.VISITOR_CONTACT_INFO)},b}(a.RedirectService);a.PostPricingPlanPurchasedDeepLinkNavigationService=b,angular.module("schedulerAngularClientAppInternal").service("postPricingPlanPurchasedDeepLinkNavigationSrv",b)}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.clientPagesConst=new ClientPages,a.PERSONAL_INFO=a.clientPagesConst.USER_ACCOUNT_MANAGEMENT_INFO,a.BOOKINGS=a.clientPagesConst.USER_ACCOUNT_MANAGEMENT_APPOINTMENTS,a}();a.AccountManagementSections=b;var c=function(){function a(){}return a.clientPagesConst=new ClientPages,a.PERSONAL_INFO=a.clientPagesConst.USER_ACCOUNT_MANAGEMENT+"/"+a.clientPagesConst.USER_ACCOUNT_MANAGEMENT_INFO,a.BOOKINGS=a.clientPagesConst.USER_ACCOUNT_MANAGEMENT+"/"+a.clientPagesConst.USER_ACCOUNT_MANAGEMENT_APPOINTMENTS,a}();a.AccountManagementPages=c}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(b){var c;!function(b){var c=a.bookings.account.bookings.AccountBooking,d=WixBookingsUoUDomain.OfferingType,e=function(){function b(a,b,c,d,e,f){this.accountManagementApiSrv=a,this.appointmentService=b,this.validateBookingDataSrv=c,this.visitorBILogger=d,this.bookingDataSrv=e,this.experimentsEnabler=f}return b.$inject=["accountManagementApiSrv","appointmentService","validateBookingDataSrv","visitorBILogger","bookingDataSrv","experimentsEnabler"],b.prototype.buildBookingList=function(a){var b=this,c=this.createMapById(a.relatedStaff),d=this.createMapById(a.relatedOfferings);return{bookings:a.bookings.map(function(a){return b.buildBooking(a,c[a.staffId],d[a.offeringId])})}},b.prototype.buildBooking=function(a,b,d){return new c(a,b,d)},b.prototype.cancelingBooking=function(a,b){return this.accountManagementApiSrv.cancelingBooking(a.bookings[b]).then(function(){a.bookings=a.bookings.filter(function(a,c){return b!==c})})},b.prototype.gettingBookings=function(){var a=this;return this.accountManagementApiSrv.gettingBookings().then(function(b){return a.buildBookingList(b)})},b.prototype.reschedulingBooking=function(){var b=this,c=this.appointmentService.getCurrentBooking(),e=this.appointmentService.getSelectedTime(),f=this.experimentsEnabler.fakeTimeZone(),g=f?f:e.timeZone,h=moment.tz(parseInt(e.startTime,10),g),i=moment.tz(parseInt(e.endTime,10),g),j=__assign({staffMemberId:e.staffMember.id,bookingId:c.bookingId,offeringType:c.offeringDetails.type},this.experimentsEnabler.isUoUTimezoneValidationInRescheduleEnabled()?{localDateTime:{startTime:{hourOfDay:h.hour(),dayOfMonth:h.date(),year:h.year(),monthOfYear:h.month()+1,minutesOfHour:h.minute()},endTime:{hourOfDay:i.hour(),dayOfMonth:i.date(),year:i.year(),monthOfYear:i.month()+1,minutesOfHour:i.minute()}}}:{});return Object.assign(j,j.offeringType===d.INDIVIDUAL?{start:e.startTime,end:e.endTime}:{groupInstanceId:e.groupInstance.id,originalGroupInstanceId:c.groupInstanceId}),this.accountManagementApiSrv.rescheduleBooking(j).then(function(f){return b.visitorBILogger.logBookingRescheduleSuccess(c),b.validateBookingDataSrv.setBookingInfoForValidation(new a.visitor.booking.ValidateBookingInfo(a.visitor.booking.ValidateBookingType.RESCHEDULE,j.offeringType,c.bookingId,a.visitor.booking.ValidationPaymentType.NA,j.offeringType===d.GROUP?e.groupInstance.id:null)),b.experimentsEnabler.isRemoveBookingsDetailsEnabled()&&(b.bookingDataSrv.setLocation(f.locationInfo),b.bookingDataSrv.setPayment(f.payment),b.bookingDataSrv.setVideoConferenceLink(f.videoConferenceLink)),f})},b.prototype.createMapById=function(a){return a.reduce(function(a,b){return a[b.id]=b,a},{})},b}();b.BookingHistorySrv=e,angular.module("schedulerAngularClientAppInternal").service("bookingHistorySrv",e)}(c=b.account||(b.account={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=WixBookingsUoUDomain.OfferingType,c=function(){function a(){}return a.FES_PREFIX="_api/bookings-viewer/",a.FES_SITE_MEMBER_PREFIX=a.FES_PREFIX+"site-member/",a.UPDATE_CONTACT="contact",a.CANCEL_BOOKING="booking",a.GET_BOOKINGS="bookings",a.RESCHEDULE_BOOKING="booking",a.GET_PURCHASED_PRICING_PLAN="memberships/offering/",a.PLAN_FOR_SLOT="member/planForSlot/",a}();a.AccountManagementApiConst=c;var d=function(){function a(b,d){var e=this;this.$http=b,this.commonApiBase=d,this.updatingContact=this.commonApiBase.httpWrapper(function(a){return e.$http.put(""+c.FES_SITE_MEMBER_PREFIX+c.UPDATE_CONTACT,a)}),this.cancelingBooking=this.commonApiBase.httpWrapper(function(b){return e.$http.delete(""+c.FES_SITE_MEMBER_PREFIX+c.CANCEL_BOOKING+"/"+b.offeringDetails.type+"/"+b.bookingId+a.getBookingUrlSuffix(b))}),this.gettingBookings=this.commonApiBase.httpWrapper(function(){return e.$http.get(""+c.FES_SITE_MEMBER_PREFIX+c.GET_BOOKINGS)}),this.gettingPurchasedPricingPlans=this.commonApiBase.httpWrapper(function(a){return e.$http.get(""+c.FES_SITE_MEMBER_PREFIX+c.GET_PURCHASED_PRICING_PLAN+a)}),this.gettingUserPricingPlansForSlotCall=this.commonApiBase.httpWrapper(function(a){var b=a.offeringId,d=a.selectedSlotStartTimeStamp;return e.$http.get(""+c.FES_PREFIX+c.PLAN_FOR_SLOT+b+"/"+d)}),this.rescheduleBooking=this.commonApiBase.httpWrapper(function(b){return e.$http.put(""+c.FES_SITE_MEMBER_PREFIX+c.RESCHEDULE_BOOKING+"/"+b.offeringType+"/"+b.bookingId+a.getRescheduleBookingUrlSuffix(b),b)})}return a.$inject=["$http","commonApiBase"],a.prototype.gettingUserPricingPlansForSlot=function(a,b){var c=this;return this.gettingUserPricingPlansForSlotCall({offeringId:a,selectedSlotStartTimeStamp:b}).then(function(a){var b=a.plan;return b?c.mapPlan(b):null})},a.getBookingUrlSuffix=function(a){return a.offeringDetails.type===b.GROUP?"/"+a.groupInstanceId:""},a.getRescheduleBookingUrlSuffix=function(a){return a.offeringType===b.GROUP?"/"+a.originalGroupInstanceId:""},a.prototype.mapPlan=function(a){var b={type:a.type,name:a.name,pricingPlanId:a.id,start:a.validFrom?moment(a.validFrom).valueOf():null,end:a.validUntil?moment(a.validUntil).valueOf():null,expiration:{hasEndDate:!!a.validUntil},sessions:a.totalSessions,remains:a.remainingSessions};return b},a}();a.AccountManagementApiSrv=d,angular.module("schedulerAngularClientAppInternal").service("accountManagementApiSrv",d)
}(b=a.account||(a.account={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){var b={};Object.assign(this,b,a)}return a}(),c=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this;this.$wix=a,this.boostInjectionPersister=b,this.accountManagementApiSrv=c,this.routeManager=d,this.cacheSrv=e,this.clientPages=f,this.visitorBILogger=g,this.$timeout=h,this.$rootScope=i,this.experimentsEnabler=j,this.$translate=k,this.modal=l,this.lazyLoaderSrv=m,this.$q=n,this.wixSdkUtil=o,this.visitorApi=p,this.isInApp="site"===this.$wix.Utils.getViewMode(),this.loginIsInit=n.defer(),this.initCurrentMemberStatus(),a.subscribeToMemberDetailsUpdate(function(a){return q.updateMemberDetails(a)})}return a.$inject=["$wix","boostInjectionPersister","accountManagementApiSrv","routeManager","cacheSrv","clientPages","visitorBILogger","$timeout","$rootScope","experimentsEnabler","$translate","modal","lazyLoaderSrv","$q","wixSdkUtil","visitorApi"],a.prototype.updateMemberDetails=function(b){this.$rootScope.$emit(a.MY_ACCOUNT_USER_INFO_CHANGED),this.currentSiteMember=this.adjustCurrentMemberToSiteContact(b)},a.prototype.adjustCurrentMemberToSiteContact=function(a){var b={fullName:a.attributes.name,imageUrl:a.attributes.imageUrl,email:a.email,phoneNumber:""};return b},a.prototype.getCurrentLogInStatus=function(){var a=this.$q.defer();return this.$wix.currentMember(function(b){a.resolve(!!b)}),a.promise},a.prototype.isLoggedIn=function(){return this.isInApp&&this.isCurrentUserPresent},a.prototype.isSiteOwner=function(){return this.isOwner},a.prototype.logoutUser=function(){this.isInApp&&(this.$rootScope.$emit(a.LOGOUT_INITIATED),this.$wix.logOutCurrentMember())},a.prototype.loginUser=function(){var b=this;if(this.isInApp){var c=this.$wix.getVisitorId(),d=this.routeManager.getFullPageDefinition();this.cacheSrv.setToCache(a.POST_LOGIN_PATH_KEY,{preLoginRoute:d,visitorIdAnon:c}),this.$wix.requestLogin({mode:"login",language:this.$translate.preferredLanguage()})}else this.lazyLoaderSrv.lazyLoadLibs(["bootstrap"]).then(function(){return b.modal.openLoginOutsideSite()})},a.prototype.getCurrentSiteMember=function(){return this.currentSiteMember},a.prototype.buildSiteMember=function(a){return new b(a)},a.prototype.updatingSiteMember=function(a){var b=this;return this.accountManagementApiSrv.updatingContact(a).then(function(){b.setCurrentSiteMember(b.buildSiteMember(a))})},a.prototype.restoreLoginState=function(){var b=this,c=this.getPreviousPageInfo();c&&(this.cacheSrv.clearKey(a.POST_LOGIN_PATH_KEY),this.visitorBILogger.logPostLoginComplete({visitorIdAnon:c.visitorIdAnon}),this.loginIsInit.promise.then(function(){return b.routeManager.gotoFullPage(c.preLoginRoute)}))},a.prototype.getPreviousPageInfo=function(){return this.cacheSrv.getFromCache(a.POST_LOGIN_PATH_KEY)},a.prototype.isPathAllowed=function(a){var b=this,c=this.isPathProtected(a);return c&&this.isSiteOwner()&&this.lazyLoaderSrv.lazyLoadLibs(["bootstrap"]).then(function(){return b.modal.openOwnerIsLoggedIn()}),this.isLoggedIn()&&!this.isSiteOwner()||!c},a.prototype.isUserLoginAllowed=function(){var a=this;return this.experimentsEnabler.isDisableOldMembersAreaEnabled()?this.$q.resolve(!1):this.visitorApi.isMemberAreaInstalled().then(function(b){var c=b.installed;return c?!1:"false"!==a.wixSdkUtil.getTextForModel("showMemberLogin_Checkbox","")}).catch(function(){return!0})},a.prototype.isInitialized=function(){return this.initialized},a.prototype.isPathProtected=function(a){return a&&a.indexOf(this.clientPages.USER_ACCOUNT_MANAGEMENT)>-1},a.prototype.initCurrentMemberStatus=function(){var a=this;this.initialized=!1,this.isCurrentUserPresent=!1,this.currentSiteMember={},this.isInApp?this.$wix.currentMember(function(b){a.$timeout(function(){return a.onCurrentMemberRetrieved(b)})}):this.setInitialized()},a.prototype.onCurrentMemberRetrieved=function(a){var b=this;if(this.isUserLoginAllowed()){if(this.isCurrentUserPresent=!!a,this.isOwner=a&&a.owner,this.isCurrentUserPresent){var c=this.experimentsEnabler.isMemberRetrievesFromSDK()?this.adjustCurrentMemberToSiteContact(a):this.boostInjectionPersister.getCurrentMember();this.setCurrentSiteMember(c||{})}this.isSiteOwner()&&this.lazyLoaderSrv.lazyLoadLibs(["bootstrap"]).then(function(){return b.modal.openOwnerIsLoggedIn()}),this.setInitialized()}},a.prototype.setInitialized=function(){this.loginIsInit.resolve(),this.initialized=!0},a.prototype.setCurrentSiteMember=function(b){this.currentSiteMember=b,this.$rootScope.$emit(a.USER_INFO_CHANGED)},a.prototype.isUserBackFromLogin=function(){var a=this.getPreviousPageInfo(),b=a?a.visitorIdAnon:"",c=this.$wix.getVisitorId();return!(!b||b===c)},a.POST_LOGIN_PATH_KEY="UserManagementSrv.post-login-path-key",a.LOGOUT_INITIATED="UserManagementSrv.logout-initiated",a.USER_INFO_CHANGED="UserManagementSrv.user-info-changed",a.MY_ACCOUNT_USER_INFO_CHANGED="UserManagementSrv.my-account-user-info-changed",a}();a.UserManagementSrv=c,angular.module("schedulerAngularClientAppInternal").service("userManagementSrv",c)}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g){this.userManagementSrv=a,this.experimentsEnabler=b,this.routeManager=c,this.clientPages=d,this.visitorBILogger=e,this.wixSdkUtil=f,this.$timeout=g,this.isUserLoginAllowed=!1,this.initializedIfUserAllowToLogin()}return Object.defineProperty(a.prototype,"userLoginAllowed",{get:function(){return this.userManagementSrv.isInitialized()&&this.isUserLoginAllowed},enumerable:!0,configurable:!0}),a.prototype.initializedIfUserAllowToLogin=function(){var a=this;this.userManagementSrv.isUserLoginAllowed().then(function(b){return a.isUserLoginAllowed=b})},Object.defineProperty(a.prototype,"isUserLoggedIn",{get:function(){return this.userManagementSrv.isLoggedIn()},enumerable:!0,configurable:!0}),a.prototype.login=function(){this.visitorBILogger.logLoginClicked(),this.userManagementSrv.loginUser()},a.prototype.logout=function(){var a=this,b=0;this.visitorBILogger.logSignoutClicked(),this.$timeout(function(){return a.userManagementSrv.logoutUser()},b)},a.prototype.goToUserManagement=function(){this.visitorBILogger.logGoToAccountManagement(),this.routeManager.gotoPage(this.clientPages.USER_ACCOUNT_MANAGEMENT)},Object.defineProperty(a.prototype,"userName",{get:function(){var a=this.userManagementSrv.getCurrentSiteMember().fullName;return a?a.split(" ")[0]:""},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"userImage",{get:function(){return this.userManagementSrv.getCurrentSiteMember().imageUrl},enumerable:!0,configurable:!0}),a}();a.BaseUserLoginComponent=b}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g,h){return a.call(this,b,c,d,e,f,g,h)||this}return __extends(b,a),b.$inject=["userManagementSrv","experimentsEnabler","routeManager","clientPages","visitorBILogger","wixSdkUtil","$timeout"],b.prototype.onLoginKeyPress=function(a){var b=32,c=13;(b===a.which||c===a.which)&&(a.preventDefault(),this.login())},b.prototype.onLoginDetailsKeyPress=function(a){var b=32,c=13;(b===a.which||c===a.which)&&(a.preventDefault(),this.goToUserManagement())},b.prototype.onLogoutKeyPress=function(a){var b=32,c=13;(b===a.which||c===a.which)&&(a.preventDefault(),this.logout())},b}(a.BaseUserLoginComponent);a.UserLoginComponent=b,angular.module("schedulerAngularClientAppInternal").component("bksUserLogin",{templateUrl:"modules/desktop/user-management/user-login/user-login.preload.html",controller:b})}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a,b,c,d){this.routeManager=a,this.clientPages=b,this.experimentsEnabler=c,this.visitorBILogger=d}return b.prototype.$onInit=function(){this.sections=[{key:"account-management.section.bookings",code:a.AccountManagementSections.BOOKINGS},{key:"account-management.section.personal-info",code:a.AccountManagementSections.PERSONAL_INFO}]},b.prototype.gotoServices=function(){this.visitorBILogger.logAccountManagementHeaderBack(this.sectionKey),this.routeManager.gotoPage(this.clientPages.VISITOR_SERVICES)},b.prototype.gotoSection=function(a){this.visitorBILogger.logAccountManagementSectionSelected(a.code),this.routeManager.gotoPage(this.clientPages.USER_ACCOUNT_MANAGEMENT+"/"+a.code)},b.prototype.isSectionSelected=function(a){return a.code===this.sectionKey},b}();a.BaseAccountManagementHeaderController=b}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e){return a.call(this,b,c,d,e)||this}return __extends(b,a),b.$inject=["routeManager","clientPages","experimentsEnabler","visitorBILogger"],b}(a.BaseAccountManagementHeaderController);a.AccountManagementHeaderController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementHeader",{templateUrl:"modules/desktop/account-management/account-management-header/account-management-header.preload.html",controller:b,bindings:{sectionKey:"@section"}})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a,b,c){this.userManagementSrv=a,this.$scope=b,this.visitorBILogger=c,this.initSiteMember(),this.isEditMode=!(this.siteMember.phoneNumber&&this.siteMember.fullName)}return Object.defineProperty(b.prototype,"section",{get:function(){return a.AccountManagementSections.PERSONAL_INFO},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"currentSiteMember",{get:function(){return this.siteMember},enumerable:!0,configurable:!0}),b.prototype.onCancelMemberUpdate=function(){this.initSiteMember(),this.isEditMode=!1,this.focusMyInfoTab()},b.prototype.focusMyInfoTab=function(){$('[data-hook="account-management-section-info"]').focus()},b.prototype.onEditMember=function(){this.visitorBILogger.logEditUserInfoClicked(),this.isEditMode=!0,this.focusMyInfoTab()},b.prototype.onSiteMemberSaved=function(a){var b=this;this.visitorBILogger.logUserInfoSaved(a,this.userManagementSrv.getCurrentSiteMember()),this.userManagementSrv.updatingSiteMember(a).then(function(){b.onSaveSuccess(),b.isEditMode=!1})},b.prototype.initSiteMember=function(){this.siteMember=this.userManagementSrv.buildSiteMember(this.userManagementSrv.getCurrentSiteMember())},b}();a.BaseAccountManagementUserInfoController=b}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.prototype.save=function(a){this.submittedInvalid=a.$invalid,a.$valid&&this.onSave({siteMember:this.siteMember})},a.prototype.cancel=function(){this.onCancel({siteMember:this.siteMember}),this.userInfoForm.$setPristine()},a.prototype.onFormSavedSuccess=function(){this.userInfoForm.$setPristine()},a.bindings={siteMember:"<",onCancel:"&",onSave:"&"},a}();a.BaseAccountManagementUserInfoFormController=b}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.prototype.onEditClick=function(){this.onEdit({siteMember:this.siteMember})},a.bindings={siteMember:"<",onEdit:"&"},a}();a.BaseAccountManagementUserInfoViewController=b}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.boost.common.constants.FedopsInteraction,d=function(){function a(a,b,c,d){this.bookingHistorySrv=a,this.flowManagerSrv=b,this.visitorBILogger=c,this.fedopsLogger=d}return a.prototype.cancelBooking=function(a,b){var d=this;this.visitorBILogger.logBookingCancelConfirm(a),this.bookingHistorySrv.cancelingBooking(this.bookingList,b).then(function(){d.fedopsLogger.interactionEnded(c.CANCEL_BOOKING_CONFIRMED)})},a.prototype.rescheduleBooking=function(a){var b=this;this.flowManagerSrv.initiateReschedule(a,this.timezone).then(function(){b.visitorBILogger.logBookingReschedule(a),b.flowManagerSrv.next()})},a.prototype.bookAnotherBooking=function(a){var b=this;this.flowManagerSrv.initiateBookAnother(a).then(function(){b.visitorBILogger.bookIt(a.offeringDetails.type,a.offeringDetails.id,!1,[],!0,!0),b.flowManagerSrv.next()})},Object.defineProperty(a.prototype,"section",{get:function(){return b.AccountManagementSections.BOOKINGS},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"hasBookings",{get:function(){return!!this.bookingList.bookings.length},enumerable:!0,configurable:!0}),a.bindings={bookingList:"=",timezone:"@"},a}();b.BaseAccountManagementBookingsController=d}(c=b.account||(b.account={}))}(c=b.user||(b.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.boost.common.constants.FedopsInteraction,d=function(){function a(a,b,c,d,e,f){var g=this;this.$translate=a,this.libs=b,this.$scope=c,this.fedopsLogger=d,this.visitorBILogger=e,this.offeringTimeFormatterSrv=f,this.isExpanded=!1,this.cancelConfirm=!1,this.timeFormat=this.$translate("account-management.bookings.time-format"),this.offeringTimeFormatterSrv.formatOpeningDateForBooking(this.booking).then(function(a){return g.date=a})}return a.$inject=["$translate","libs","$scope","fedopsLogger","visitorBILogger","offeringTimeFormatterSrv"],Object.defineProperty(a.prototype,"title",{get:function(){return this.booking.offeringDetails.name},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"staffDetails",{get:function(){return this.$translate("account-management.bookings.staff-format",this.booking.staffMemberDetails)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"location",{get:function(){return this.booking.locationInfo},enumerable:!0,configurable:!0}),a.prototype.isRescheduleAllowed=function(){return this.booking.allowedActions.reschedule},a.prototype.isBookingPassed=function(){return this.booking.start>=Date.now()},a.prototype.isCancelAllowed=function(){return this.booking.allowedActions.cancel},Object.defineProperty(a.prototype,"rescheduleTooltip",{get:function(){return this.$translate("account-management.bookings.action.reschedule"+(this.isRescheduleAllowed()?"":"-not-allowed"))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"rescheduleAccessibilityTooltip",{get:function(){return this.$translate("account-management.bookings.action.accessibility.reschedule"+(this.isRescheduleAllowed()?"":"-not-allowed"))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"cancelTooltip",{get:function(){return this.$translate("account-management.bookings.action.cancel"+(this.isCancelAllowed()?"":"-not-allowed"))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"cancelAccessibilityTooltip",{get:function(){return this.$translate("account-management.bookings.action.accessibility.cancel"+(this.isCancelAllowed()?"":"-not-allowed"))},enumerable:!0,configurable:!0}),a.prototype.isBookAnotherAllowed=function(){return this.booking.allowedActions.bookAnother},a.prototype.onCancelClicked=function(){this.isCancelAllowed()&&(this.visitorBILogger.logBookingCancelClick(this.booking),this.cancelConfirm=!0,this.fedopsLogger.interactionStarted(c.CANCEL_BOOKING),this.fedopsLogger.interactionEnded(c.CANCEL_BOOKING))},a.prototype.onCancelRevert=function(){this.cancelConfirm=!1},a.prototype.onCancelConfirmed=function(){this.cancelConfirm=!1,this.fedopsLogger.interactionStarted(c.CANCEL_BOOKING_CONFIRMED),this.onCancel({booking:this.booking})},a.prototype.onRescheduleClicked=function(){this.isRescheduleAllowed()&&this.onReschedule({booking:this.booking})},a.prototype.onBookAnotherClicked=function(){this.onBookAnother({booking:this.booking})},a.prototype.applyChanges=function(){return this.$scope.$apply()},a.bindings={booking:"<",onCancel:"&",onReschedule:"&",onBookAnother:"&",timezone:"@"},a}();b.BaseAccountManagementBookingItemController=d}(c=b.account||(b.account={}))}(c=b.user||(b.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.prototype.reschedule=function(a,b){this.onReschedule({booking:a,index:b})},a.prototype.cancel=function(a,b){this.onCancel({booking:a,index:b})},a.prototype.bookAnother=function(a,b){this.onBookAnother({booking:a,index:b})},a.bindings={bookings:"<",onReschedule:"&",onBookAnother:"&",onCancel:"&",timezone:"@"},a}();a.BaseAccountManagementBookingsListController=b}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g){var h=a.call(this,b,c,d)||this;return h.$translate=e,h.modal=f,h.$timeout=g,h}return __extends(b,a),b.$inject=["userManagementSrv","$scope","visitorBILogger","$translate","modal","$timeout"],b.prototype.onSaveSuccess=function(){var a=this.modal.openSuccessMessage(this.$translate("account-management.personal-info.form.save-success"));this.$timeout(function(){$('[data-hook="account-management-section-info"]').focus(),a.then(function(a){return a.dismiss("timeout")})},b.MODAL_CLOSE_TIMEOUT)},b.MODAL_CLOSE_TIMEOUT=4e3,b}(a.BaseAccountManagementUserInfoController);a.AccountManagementUserInfoController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementUserInfo",{templateUrl:"modules/desktop/account-management/account-management-user-info/account-management-user-info.preload.html",controller:b})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b}(a.BaseAccountManagementUserInfoFormController);a.AccountManagementUserInfoFormController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementUserInfoForm",{templateUrl:"modules/desktop/account-management/account-management-user-info/account-management-user-info-form/account-management-user-info-form.preload.html",controller:b,bindings:Object.assign({},a.BaseAccountManagementUserInfoFormController.bindings)})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b}(a.BaseAccountManagementUserInfoViewController);a.AccountManagementUserInfoViewController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementUserInfoView",{templateUrl:"modules/desktop/account-management/account-management-user-info/account-management-user-info-view/account-management-user-info-view.preload.html",controller:b,bindings:__assign({},a.BaseAccountManagementUserInfoViewController.bindings)})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e){return a.call(this,b,c,d,e)||this}return __extends(b,a),b.$inject=["bookingHistorySrv","flowManagerSrv","visitorBILogger","fedopsLogger"],b}(a.BaseAccountManagementBookingsController);a.AccountManagementBookingsController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementBookings",{templateUrl:"modules/desktop/account-management/account-management-bookings/account-management-bookings.preload.html",controller:b,bindings:Object.assign({},a.BaseAccountManagementBookingsController.bindings)})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b}(a.BaseAccountManagementBookingsListController);a.AccountManagementBookingsListController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementBookingsList",{templateUrl:"modules/desktop/account-management/account-management-bookings/account-management-bookings-list/account-management-bookings-list.preload.html",controller:b,bindings:Object.assign({},a.BaseAccountManagementBookingsListController.bindings)})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g){return a.call(this,b,c,d,e,f,g)||this}return __extends(b,a),b.$inject=["$translate","libs","$scope","fedopsLogger","visitorBILogger","offeringTimeFormatterSrv"],b}(a.BaseAccountManagementBookingItemController);a.AccountManagementBookingItemController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementBookingItem",{templateUrl:"modules/desktop/account-management/account-management-bookings/account-management-booking-item/account-management-booking-item.preload.html",controller:b,bindings:__assign({},a.BaseAccountManagementBookingItemController.bindings)})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var LoggedInContactInfo=function(){function a(){}return a}();angular.module("schedulerAngularClientAppInternal").component("bksLoggedInContactInfo",{controller:LoggedInContactInfo,templateUrl:"modules/logged-in-contact-info/logged-in-contact-info.preload.html",bindings:{contactInfo:"="}});var wix;!function(a){var b;!function(a){var b;!function(a){a.USATimezone=new Set(["America/Boise","EST","EST5EDT","Etc/GMT+5","America/Cambridge_Bay","America/North_Dakota/Center","America/Chicago","America/Dawson_Creek","America/Dawson","America/Denver","Etc/GMT+7","MST","MST7MDT","America/Detroit","America/Edmonton","America/Hermosillo","CST6CDT","Etc/GMT+6","America/Indiana/Indianapolis","America/Inuvik","America/Iqaluit","America/Indiana/Knox","America/Los_Angeles","America/Kentucky/Louisville","America/Indiana/Marengo","America/Menominee","America/Kentucky/Monticello","America/Montreal","America/North_Dakota/New_Salem","America/New_York","America/Nipigon","America/Pangnirtung","America/Indiana/Petersburg","America/Phoenix","America/Rainy_River","America/Rankin_Inlet","America/Regina","America/Resolute","Etc/GMT+8","PST8PDT","America/Swift_Current","America/Indiana/Tell_City","America/Thunder_Bay","America/Toronto","America/Vancouver","America/Indiana/Vevay","America/Indiana/Vincennes","America/Whitehorse","America/Indiana/Winamac","America/Winnipeg","America/Yellowknife","America/Blanc-Sablon","America/Glace_Bay","America/Goose_Bay","America/Halifax"])}(b=a.timezone||(a.timezone={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={})),angular.module("modalOpenner",["wixAngularLazyLoad"]).factory("openModal",["$q","$injector","$ocLazyLoad","lazyLoaderSrv",function(a,b,c,d){return function(e){var f;try{f=a.when(b.get("$modal"))}catch(g){f=d.lazyLoadLibs(["bookingFlow","bootstrap"]).then(function(){return c.inject("schedulerAngularClientBootstrap")}).then(function(){return b.get("$modal")})}return f.then(function(a){return a.open(e)})}}]);var AppCtrl=function(){function a(){}return a}();angular.module("schedulerAngularClientAppInternal").component("bksApp",{controller:AppCtrl,templateUrl:"modules/main.preload.html"});var wix;!function(a){var b;!function(a){var b;!function(){var a=function(){function a(){}return a}();angular.module("schedulerAngularClientAppInternal").component("boostNextStepLabel",{template:'<span data-hook="next-step-label" aria-label="{{ $ctrl.ariaActionLabel }}">{{ $ctrl.actionLabel}}</span>',controller:a,bindings:{actionLabel:"=",ariaActionLabel:"="}})}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a}(),c=function(){function a(a,b,c,d){this.paymentService=a,this.$location=b,this.$filter=c,this.$translate=d}return a.$inject=["paymentService","$location","$filter","$translate"],a.prototype.getJoinWaitingListLabel=function(){return this.$filter("wixSdkTranslate")("calendar.group.action.waiting-list",null)},a.prototype.getGroupViewPricingPlanLabel=function(){return this.$filter("wixSdkTranslate")("calendar.group.view-pricing","textViewPricingLabelGroups")},a.prototype.getIndividualViewPricingPlanLabel=function(){return this.$filter("wixSdkTranslate")("calendar.individual.view-pricing","textViewPricingLabelIndividual")},a.prototype.getMultipleOfferedAsLabel=function(){return this.$translate("calendar.multiple-offered-as.button")},a.prototype.getAriaLabel=function(a){var c=a.isWaitingListFlow,d=void 0===c?!1:c,e=a.isLastStep,f=a.onlinePaymentLabel,g=a.offlinePaymentLabel,h=a.isNextStepDisabled,i=new b;return this.initLables(i,e,f,g,d),h?this.$translate("next.step.accessibility.error.message"):i.overrideLabel||this.$filter("wixSdkTranslate")(i.ariaLabelKey,i.settingsKey)},a.prototype.getLabel=function(a){var c=a.isWaitingListFlow,d=void 0===c?!1:c,e=a.isLastStep,f=a.onlinePaymentLabel,g=a.offlinePaymentLabel,h=new b;return this.initLables(h,e,f,g,d),h.overrideLabel||this.$filter("wixSdkTranslate")(h.key,h.settingsKey)},a.prototype.defineDefaultLabel=function(a){a.key="calendar.next",a.ariaLabelKey="calendar.accessibility.next",a.settingsKey="textNextStepLabel"},a.prototype.defineWaitlistLabel=function(a){a.key="calendar.group.action.waiting-list",a.ariaLabelKey="calendar.group.accessibility.waiting-list",a.settingsKey=null},a.prototype.defineLabelForLastStep=function(a,b,c){this.isOnlyOneOnlinePaymentOption()?(a.key="visitor.confirmation.wizard.next-payment",a.ariaLabelKey="visitor.confirmation.wizard.accessibility.next-payment",a.overrideLabel=b):(a.key="visitor.confirmation.wizard.next",a.ariaLabelKey="visitor.confirmation.wizard.accessibility.next",a.overrideLabel=c)},a.prototype.enhanceSettingsKey=function(b){b.settingsKey+=this.isGroupsFlow()?a.GROUPS_SUFFIX:""},a.prototype.isOnlyOneOnlinePaymentOption=function(){return this.paymentService.isPaymentNeeded()},a.prototype.isGroupsFlow=function(){return this.$location.path().indexOf("/groups/")>-1},a.prototype.initLables=function(a,b,c,d,e){b?this.defineLabelForLastStep(a,c,d):e?this.defineWaitlistLabel(a):this.defineDefaultLabel(a),this.enhanceSettingsKey(a)},a.prototype.getViewPricingPlanLabel=function(a){return a===OfferingType.GROUP?this.getGroupViewPricingPlanLabel():this.getIndividualViewPricingPlanLabel()},a.GROUPS_SUFFIX="Groups",a}();a.NextLabelSrv=c,angular.module("schedulerAngularClientAppInternal").service("nextLabelSrv",c)}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){function b(a,b){return a.type===OfferingType.GROUP?b("wixSdkTranslate")("calendar.group.login","textLoginLabelGroups"):a.type===OfferingType.INDIVIDUAL?b("wixSdkTranslate")("calendar.individual.login","textLoginLabelIndividual"):void 0}a.loginLabelResolver=b}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={})),angular.module("schedulerAngularClientAppInternal").directive("bksOnTransitionEnd",function(){return{restrict:"A",scope:{bksOnTransitionEnd:"&"},link:function(a,b){return b.on("transitionend",function(){return a.bksOnTransitionEnd()})}}});var wix;!function(a){var b;!function(a){var b;!function(a){a.prefixPath="/scheduler/visitor/";var b=function(){function b(b,c,d){var e,f,g,h,i,j,k,l,m,n=this;this.fedopsLogger=b,this.$rootScope=c,this.clientPages=d,this.startInteraction=function(a){n.fedopsLogger.interactionStarted("end-to-end-bookings-flow"),n.fedopsLogger.interactionStarted(a),n.redirectEvent=a},this.endInteraction=function(){n.fedopsLogger.interactionEnded("end-to-end-bookings-flow")},this.logStart=function(a){n.lastTransition=a,a&&n.fedopsLogger.interactionStarted(a)},this.logEnd=function(){n.lastTransition&&(n.fedopsLogger.interactionEnded(n.lastTransition),n.lastTransition=!n.lastTransition)},this.transitions=(e={},e[a.prefixPath+d.VISITOR_GROUPS]=(f={},f[a.prefixPath+d.VISITOR_GROUPS_CALENDAR]="from-offerings-list-to-calendar",f[a.prefixPath+d.VISITOR_CALENDAR]="from-offerings-list-to-calendar",f[a.prefixPath+d.OFFERING_PAGE]="from-offerings-list-to-offerings-page",f),e[a.prefixPath+d.VISITOR_SERVICES]=(g={},g[a.prefixPath+d.VISITOR_GROUPS_CALENDAR]="from-offerings-list-to-calendar",g[a.prefixPath+d.VISITOR_CALENDAR]="from-offerings-list-to-calendar",g[a.prefixPath+d.OFFERING_PAGE]="from-offerings-list-to-offerings-page",g),e[a.prefixPath+d.OFFERING_PAGE]=(h={},h[a.prefixPath+d.VISITOR_GROUPS_CALENDAR]="from-offerings-page-to-calendar",h[a.prefixPath+d.VISITOR_CALENDAR]="from-offerings-page-to-calendar",h[a.prefixPath+d.VISITOR_CONTACT_INFO]="from-offerings-page-to-contact-info",h[a.prefixPath+d.VISITOR_CONFIRMATION]="from-offering-page-to-confirmation",h),e[a.prefixPath+d.VISITOR_GROUPS_CALENDAR]=(i={},i[a.prefixPath+d.VISITOR_CONTACT_INFO]="from-calendar-to-contact-info",i[a.prefixPath+d.VISITOR_CONFIRMATION]="from-calendar-to-confirmation",i),e[a.prefixPath+d.VISITOR_CALENDAR]=(j={},j[a.prefixPath+d.VISITOR_CONTACT_INFO]="from-calendar-to-contact-info",j[a.prefixPath+d.VISITOR_CONFIRMATION]="from-calendar-to-confirmation",j),e[a.prefixPath+d.VISITOR_CONFIRMATION]=(k={},k[a.prefixPath+d.VISITOR_CONTACT_INFO]="from-confirmation-to-contact-info",k),e[a.prefixPath+d.VISITOR_CONTACT_INFO]=(l={},l[a.prefixPath+d.VISITOR_PAYMENT]="from-contact-info-to-new-payment-info",l[a.prefixPath+d.VISITOR_CONGRATS]="from-contact-info-to-congratulations",l),e[a.prefixPath+d.VISITOR_PAYMENT]=(m={},m[a.prefixPath+d.VISITOR_CONGRATS]="from-new-payment-info-to-congratulations",m),e),c.$on("$locationChangeStart",function(){try{n.redirectEvent&&(n.fedopsLogger.interactionEnded(n.redirectEvent),n.redirectEvent=void 0)
}catch(a){}}),c.$on("$routeChangeStart",function(a,b,c){try{var d=c.$$route.originalPath.split("/:")[0],e=b.$$route.originalPath.split("/:")[0];n.logStart(n.transitions[d][e])}catch(f){}}),c.$on("$viewContentLoaded",this.logEnd)}return b.$inject=["fedopsLogger","$rootScope","clientPages"],b}();a.NavigationMonitoring=b,angular.module("schedulerAngularClientAppInternal").service("navigationMonitoring",b)}(b=a.navigation||(a.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.clientPages=a,this.routeManager=b,this.flowSteps={}}return a.prototype.addStep=function(a,b){this.flowSteps[a]=b},a.prototype.next=function(a){this.getFlowStep(a).next()},a.prototype.isNavigationAllowed=function(a,b){var c=this.getFlowStep(a);return!(!c||!c[b])},a.prototype.getFlowStep=function(a){var b=Object.keys(this.flowSteps).find(function(b){return a.startsWith(b)});return this.flowSteps[b]},a.prototype.goToFirstPage=function(){},a}();a.WizardFlow=b}(b=a.flow||(a.flow={}))}(b=a.navigation||(a.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=WixBookingsUoUDomain.OfferingType,d=a.bookings.user.account.AccountManagementPages,e=a.bookings.visitor.offerings.SelectedOfferingDomain,f=function(a){function b(b,c,d,e,f,g){var h=a.call(this,b,c)||this;return h.appointmentService=d,h.selectedOffering=e,h.isMobile=f,h.$routeParams=g,h}return __extends(b,a),b.prototype.getFlowName=function(){return"BookOfferingFlow"},b.prototype.init=function(a){this.appointmentService.initiate(this.selectedOffering,a)},b.prototype.addSteps=function(){var a=this,b={prev:angular.noop,next:function(){return a.gotoStepAfterServiceSelection()}};this.addStep(this.clientPages.VISITOR_SERVICES,b),this.addStep(this.clientPages.VISITOR_GROUPS,b),this.addStep(this.clientPages.OFFERING_PAGE,{next:function(){return a.gotoStepAfterOfferingPage()}}),this.addStep(this.clientPages.VISITOR_CALENDAR,{next:function(){return a.gotoCalendarNextStep()}}),this.addStep(this.clientPages.VISITOR_GROUPS_CALENDAR,{next:function(){return a.gotoGroupCalendarNextStep()}}),this.addStep(this.clientPages.VISITOR_CONTACT_INFO,{next:function(){return a.gotoContactInfoNextStep()}}),this.addStep(this.clientPages.VISITOR_PAYMENT,{next:function(){return a.gotoPaymentNextStep()}}),this.addStep(this.clientPages.VISITOR_CONFIRMATION,{next:function(){return a.gotoConfirmationNextStep()}})},b.prototype.gotoCalendarNextStep=function(){this.isMobile?this.goToConfirmation():this.goToContactInfo()},b.prototype.gotoContactInfoNextStep=function(){this.goToNextStep()},b.prototype.gotoPaymentNextStep=function(){this.goToCongrats()},b.prototype.gotoConfirmationNextStep=function(){this.isMobile?this.goToContactInfo():this.goToCongrats()},b.prototype.gotoGroupCalendarNextStep=function(){this.isMobile?this.goToConfirmation():this.goToContactInfo()},b.prototype.goToOfferingPage=function(){this.routeManager.gotoPage(this.clientPages.OFFERING_PAGE)},b.prototype.replacePageToOfferingPage=function(){this.routeManager.replacePage(this.clientPages.OFFERING_PAGE)},b.prototype.goToNextStep=function(){this.appointmentService.isInTentativePayment()?this.goToPayment():this.goToCongrats()},b.prototype.goToContactInfo=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_CONTACT_INFO)},b.prototype.goToPayment=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_PAYMENT)},b.prototype.goToCongrats=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_CONGRATS)},b.prototype.goToConfirmation=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_CONFIRMATION)},b.prototype.goToAccountManagementAppointments=function(){this.routeManager.gotoPage(d.BOOKINGS)},b.prototype.gotoStepAfterServiceSelection=function(){this.navigateToSlotSelection()},b.prototype.replacePageToStepAfterServiceSelection=function(){this.replacePageToSlotSelection()},b.prototype.replacePageToSlotSelection=function(){this.selectedOffering.type!==c.COURSE&&this.bookableOffering()?this.replacePageToCalendarByType():this.replacePageToOfferingPage()},b.prototype.navigateToSlotSelection=function(){this.selectedOffering.type!==c.COURSE&&this.bookableOffering()?this.goToCalendarByType():this.goToOfferingPage()},b.prototype.gotoStepAfterOfferingPage=function(){this.selectedOffering.type===c.COURSE?this.goToContactInfo():this.goToCalendarByType()},b.prototype.goToCalendarByType=function(){var a=this.$routeParams.timezone,b=+a?"/"+a:"";this.selectedOffering.type===c.GROUP?this.routeManager.gotoPage(this.clientPages.VISITOR_GROUPS_CALENDAR+b):this.routeManager.gotoPage(this.clientPages.VISITOR_CALENDAR+b)},b.prototype.replacePageToCalendarByType=function(){this.selectedOffering.type===c.GROUP?this.routeManager.replacePage(this.clientPages.VISITOR_GROUPS_CALENDAR):this.routeManager.replacePage(this.clientPages.VISITOR_CALENDAR)},b.prototype.canNavigateToOfferingPage=function(){return this.selectedOffering.description&&0!==this.selectedOffering.description.trim().length&&!this.isMobile},b.prototype.bookableOffering=function(){return e.fromDto(this.selectedOffering).isPossibleToBook},b}(b.WizardFlow);b.BookOfferingFlow=f}(c=b.flow||(b.flow={}))}(c=b.navigation||(b.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,g,h)||this;return i.isMobile=g,i.$routeParams=h,i}return __extends(b,a),b.prototype.getFlowName=function(){return"VisitorOfferingPageFlow"},b.prototype.addSteps=function(){var b=this;a.prototype.addSteps.call(this);var c={prev:angular.noop,next:function(){return b.goToOfferingPage()}};this.addStep(this.clientPages.VISITOR_SERVICES,c),this.addStep(this.clientPages.VISITOR_GROUPS,c),this.addStep(this.clientPages.OFFERING_PAGE,{next:function(){return b.gotoStepAfterOfferingPage()}}),this.addStep(this.clientPages.VISITOR_CALENDAR,{next:function(){return b.gotoCalendarNextStep()}}),this.addStep(this.clientPages.VISITOR_GROUPS_CALENDAR,{next:function(){return b.gotoGroupCalendarNextStep()}})},b.prototype.goToFirstPage=function(){this.replacePageToOfferingPage()},b.prototype.canNavigateToOfferingPage=function(){return!this.isMobile},b}(a.BookOfferingFlow);a.VisitorOfferingPageFlow=b}(b=a.flow||(a.flow={}))}(b=a.navigation||(a.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.bookings.user.account.AccountManagementPages,d=function(a){function b(b,c,d,e,f,g,h){return a.call(this,b,c,d,e,g,h)||this}return __extends(b,a),b.prototype.getFlowName=function(){return"VisitorAddAnotherFlow"},b.prototype.addSteps=function(){var b=this;a.prototype.addSteps.call(this),this.addStep(c.BOOKINGS,{next:function(){return b.gotoStepAfterServiceSelection()}}),this.addStep(this.clientPages.VISITOR_CALENDAR,{next:function(){return b.goToContactInfo()}}),this.addStep(this.clientPages.VISITOR_GROUPS_CALENDAR,{next:function(){return b.goToContactInfo()}})},b}(b.BookOfferingFlow);b.VisitorAddAnotherFlow=d}(c=b.flow||(b.flow={}))}(c=b.navigation||(b.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,g,h)||this;return i.clientPages=b,i.routeManager=c,i.selectedOffering=e,i.$routeParams=h,i}return __extends(b,a),b.prototype.goToFirstPage=function(){this.replacePageToStepAfterServiceSelection()},b.prototype.getFlowName=function(){return"MemberAreaBookAnotherFlow"},b}(a.BookOfferingFlow);a.MemberAreaBookAnotherFlow=b}(b=a.flow||(a.flow={}))}(b=a.navigation||(a.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(b){function c(c,d,e,f,g,h,i,j,k,l,m,n){var o=b.call(this,c,d,e,g,k,l)||this;return o.booking=f,o.bookingHistorySrv=h,o.offeringDtoModifierSrv=i,o.experimentsEnabler=j,o.$routeParams=l,o.slotNotAvailableModalSrv=m,o.generalErrorModalSrv=n,o.handleRescheduleError=function(b){if(o.experimentsEnabler.isPreventDoubleBookingForRescheduleEnabled()&&o.isSlotNotAvailableError(b))o.slotNotAvailableModalSrv.openModal(a.visitor.modals.ReferralInfo.DOUBLE_BOOKING_RESCHEDULE);else{if(!o.isGeneralError(b))throw b;o.generalErrorModalSrv.openModal()}},o}return __extends(c,b),c.prototype.init=function(a){this.selectedOffering=this.offeringDtoModifierSrv.adjustSelectedOfferingForSidebar(this.selectedOffering,this.booking),this.appointmentService.initiate(this.selectedOffering,a),this.appointmentService.setCurrentBooking(this.booking)},c.prototype.addSteps=function(){var a=this;b.prototype.addSteps.call(this),this.addStep(this.clientPages.VISITOR_CALENDAR,{next:function(){return a.bookingHistorySrv.reschedulingBooking().then(function(){return a.goToCongrats()}).catch(a.handleRescheduleError)}}),this.addStep(this.clientPages.VISITOR_GROUPS_CALENDAR,{next:function(){return a.bookingHistorySrv.reschedulingBooking().then(function(){return a.goToCongrats()}).catch(a.handleRescheduleError)}})},c.prototype.goToFirstPage=function(){this.replacePageToStepAfterServiceSelection()},c.prototype.getFlowName=function(){return"MemberAreaRescheduleFlow"},c.prototype.isSlotNotAvailableError=function(a){return a&&409===a.status&&a.data&&"SLOT_NOT_AVAILABLE"===a.data.errorCode},c.prototype.isGeneralError=function(a){return a&&500===a.status},c}(b.BookOfferingFlow);b.MemberAreaRescheduleFlow=c}(c=b.flow||(b.flow={}))}(c=b.navigation||(b.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.bookings.user.account.AccountManagementPages,d=function(a){function b(b,c,d,e,f,g,h,i,j,k){var l=a.call(this,b,c,d,f,j,k)||this;return l.booking=e,l.bookingHistorySrv=g,l.offeringDtoModifierSrv=h,l.$routeParams=k,l}return __extends(b,a),b.prototype.getFlowName=function(){return"RescheduleFlow"},b.prototype.init=function(a){this.selectedOffering=this.offeringDtoModifierSrv.adjustSelectedOfferingForSidebar(this.selectedOffering,this.booking),this.appointmentService.initiate(this.selectedOffering,a),this.appointmentService.setCurrentBooking(this.booking)},b.prototype.addSteps=function(){var b=this;a.prototype.addSteps.call(this),this.addStep(c.BOOKINGS,{next:function(){return b.gotoStepAfterServiceSelection()}}),this.addStep(this.clientPages.VISITOR_CALENDAR,{next:function(){return b.bookingHistorySrv.reschedulingBooking().then(function(){return b.goToCongrats()})}}),this.addStep(this.clientPages.VISITOR_GROUPS_CALENDAR,{next:function(){return b.bookingHistorySrv.reschedulingBooking().then(function(){return b.goToCongrats()})}})},b}(b.BookOfferingFlow);b.RescheduleFlow=d}(c=b.flow||(b.flow={}))}(c=b.navigation||(b.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f){return a.call(this,b,c,null,null,e,f)||this}return __extends(b,a),b.prototype.getFlowName=function(){return"OverEditorFlow"},b}(a.BookOfferingFlow);a.OverEditorFlow=b}(b=a.flow||(a.flow={}))}(b=a.navigation||(a.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i){var j=a.call(this,b,c,d,e,h,i)||this;return j.clientPages=b,j.routeManager=c,j.selectedOffering=e,j.intent=f,j.$routeParams=i,j}return __extends(b,a),b.prototype.getFlowName=function(){return"WidgetFlow"},b.prototype.goToFirstPage=function(){this.hasSelectedOffeing()?this.shouldGoToBookOffering()?this.replacePageToStepAfterServiceSelection():this.replacePageToOfferingPage():this.routeManager.replacePage(this.clientPages.VISITOR_SERVICES)},b.prototype.shouldGoToBookOffering=function(){return this.intent===WidgetDeepLinkIntent.BOOK_OFFERING},b.prototype.hasSelectedOffeing=function(){return null!==this.selectedOffering},b}(a.BookOfferingFlow);a.WidgetFlow=b}(b=a.flow||(a.flow={}))}(b=a.navigation||(a.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i){var j=a.call(this,b,c,e,f,h,i)||this;return j.offeringValidationsSrv=d,j.appointmentService=e,j.selectedOffering=f,j.experimentsEnabler=g,j.isMobile=h,j.$routeParams=i,j}return __extends(b,a),b.prototype.goToFirstPage=function(){this.selectedOffering.type===OfferingType.GROUP&&this.routeManager.replacePage(this.clientPages.VISITOR_GROUPS_CALENDAR),this.selectedOffering.type===OfferingType.COURSE&&this.handleCourseRoute(),this.selectedOffering.type===OfferingType.INDIVIDUAL&&this.routeManager.replacePage(this.clientPages.VISITOR_CALENDAR)},b.prototype.handleCourseRoute=function(){this.offeringValidationsSrv.isOfferingExpired(this.selectedOffering)?this.routeManager.replacePage(this.clientPages.OFFERING_PAGE):this.routeManager.replacePage(this.clientPages.VISITOR_CONTACT_INFO)},b.prototype.getFlowName=function(){return"BookDeepLinkFlow"},b}(a.BookOfferingFlow);a.BookDeepLinkFlow=b}(b=a.flow||(a.flow={}))}(b=a.navigation||(a.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i,j,k,l,m){var n=a.call(this,b,c,e,f,l,m)||this;n.offeringValidationsSrv=d,n.appointmentService=e,n.selectedOffering=f,n.selectedSession=g,n.selectedPricingPlan=h,n.timeZone=i,n.staffMember=j,n.experimentsEnabler=k,n.isMobile=l,n.$routeParams=m;var o={startTime:""+g.start,endTime:""+g.end,timeZone:i,staffMember:j,groupInstance:g.classInstance,purchasedPricingPlan:h,bookedAs:n.getBookedAs()};return n.appointmentService.setSelectedTime(o),n}return __extends(b,a),b.prototype.getBookedAs=function(){return this.selectedPricingPlan?OfferedAsType.PRICING_PLAN:void 0},b.prototype.goToFirstPage=function(){this.isMobile?this.routeManager.replacePage(this.clientPages.VISITOR_CONFIRMATION):this.routeManager.replacePage(this.clientPages.VISITOR_CONTACT_INFO)},b.prototype.getFlowName=function(){return this.isMobile?"MobileContactInfoDeepLinkFlow":"ContactInfoDeepLinkFlow"},b}(a.BookOfferingFlow);a.ContactInfoDeepLinkFlow=b}(b=a.flow||(a.flow={}))}(b=a.navigation||(a.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.routeManager=a,this.clientPages=b}return a.prototype.prev=function(){this.navigateToDefaultStep()},a.prototype.next=function(){this.navigateToDefaultStep()},a.prototype.navigateToDefaultStep=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_SERVICES)},a}();a.FallbackStep=b}(b=a.flow||(a.flow={}))}(b=a.navigation||(a.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e){this.wizardCacheAdapter=a,this.currentStepAdapter=b,this.fallbackStepFactoryAdapter=c,this.backAdapter=d,this.experimentsEnabler=e}return a.prototype.init=function(){this.isRestoreInProgress=!1,this.restoreFlowData()},a.prototype.next=function(){this.doNavigation("next")},a.prototype.prev=function(){this.backAdapter()},a.prototype.doNavigation=function(a){var b=this.currentStepAdapter();this.isNavigationPossible(b,a)?this.currentFlow.getFlowStep(b)[a]():this.doFallbackNavigation(b,a)},a.prototype.goToFirstPage=function(){var a=this.getCurrentValidFlow();a.goToFirstPage()},a.prototype.getCurrentValidFlowName=function(){var a=this.getCurrentValidFlow();return a?a.getFlowName():null},a.prototype.getCurrentValidFlow=function(){return this.currentFlow||this.fallbackFlow},a.prototype.storeFlowData=function(b,c){this.wizardCacheAdapter.set(a.CACHE_KEY,{flowInitMethod:b,args:Array.prototype.slice.call(c)})},a.prototype.initializeFlowData=function(){this.currentFlow.addSteps(),this.currentFlow.init(this.isRestoreInProgress)},a.prototype.restoreFlowData=function(){var b=this;this.isRestoreInProgress=!0;var c=this.wizardCacheAdapter.get(a.CACHE_KEY);c&&c.flowInitMethod?this[c.flowInitMethod].apply(this,c.args).then(function(){return b.isRestoreInProgress=!1}):this.isRestoreInProgress=!1},a.prototype.doFallbackNavigation=function(a,b){if(this.fallbackFlowNavigationPossible(a,b))this.fallbackFlow[b](a);else{var c=this.fallbackStepFactoryAdapter();c[b]()}},a.prototype.isNavigationPossible=function(a,b){return this.isNavigationPossibleForFlow(this.currentFlow,a,b)},a.prototype.fallbackFlowNavigationPossible=function(a,b){return this.isNavigationPossibleForFlow(this.fallbackFlow,a,b)},a.prototype.isNavigationPossibleForFlow=function(a,b,c){return a&&a.isNavigationAllowed(b,c)},a.CACHE_KEY="flowManagerData",a}();a.FlowManagerCore=b}(b=a.navigation||(a.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(b){var c;!function(b){var c=a.bookings.navigation.flow.OverEditorFlow,d=a.bookings.navigation.flow.FallbackStep,e=a.bookings.navigation.flow.BookDeepLinkFlow,f=a.bookings.navigation.flow.VisitorOfferingPageFlow,g=a.bookings.navigation.flow.BookOfferingFlow,h=a.bookings.navigation.flow.ContactInfoDeepLinkFlow,i=a.bookings.navigation.flow.WidgetFlow,j=a.bookings.navigation.flow.MemberAreaBookAnotherFlow,k=a.bookings.navigation.flow.VisitorAddAnotherFlow,l=a.bookings.navigation.flow.RescheduleFlow,m=a.bookings.navigation.flow.MemberAreaRescheduleFlow,n=function(a){function b(b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t=a.call(this,{set:function(a,b){return t.cacheSrv.setToCache(a,b)},get:function(a){return t.cacheSrv.getFromCache(a)}},function(){return b.getCurrentPagePartialPath()},function(){return new d(b,t.clientPages)},function(){return q.history.back()},n)||this;return t.routeManager=b,t.appointmentService=c,t.cacheSrv=e,t.clientPages=f,t.appConfig=g,t.overEditor=h,t.$q=i,t.offeringDtoModifierSrv=j,t.offeringDetailsGetterSrv=k,t.$routeParams=l,t.bookingHistorySrv=m,t.experimentsEnabler=n,t.offeringValidationsSrv=o,t.transactionIdSrv=p,t.slotNotAvailableModalSrv=r,t.generalErrorModalSrv=s,t}return __extends(b,a),b.$inject=["routeManager","appointmentService","cacheSrv","clientPages","appConfig","overEditor","$q","offeringDtoModifierSrv","offeringDetailsGetterSrv","$routeParams","bookingHistorySrv","experimentsEnabler","offeringValidationsSrv","transactionIdSrv","$window","slotNotAvailableModalSrv","generalErrorModalSrv"],b.prototype.init=function(){this.overEditor.isOverEditor&&(this.fallbackFlow=new c(this.clientPages,this.routeManager,this.experimentsEnabler,this.appConfig.getIsMobile(),this.$routeParams),this.fallbackFlow.addSteps()),a.prototype.init.call(this)},b.prototype.initializeFlowData=function(){this.isRestoreInProgress=this.isRestoreInProgress||!!this.transactionIdSrv.getTransactionIdFromCache(),a.prototype.initializeFlowData.call(this)},b.prototype.initiateOfferingWidget=function(a,b){var c=this;return this.storeFlowData("initiateOfferingWidget",arguments),this.getSelectedOfferingDetailsByOffering(a).then(function(a){c.currentFlow=new i(c.clientPages,c.routeManager,c.appointmentService,a,b,c.experimentsEnabler,c.appConfig.getIsMobile(),c.$routeParams),c.initializeFlowData()})},b.prototype.initiateBookFromCorvidLink=function(a,b,c,d,e){var f=this;return this.storeFlowData("initiateBookFromCorvidLink",arguments),this.getSelectedOfferingDetailsByOffering(a).then(function(a){f.currentFlow=new h(f.clientPages,f.routeManager,f.offeringValidationsSrv,f.appointmentService,a,b,c,d,e,f.experimentsEnabler,f.appConfig.getIsMobile(),f.$routeParams),f.isRestoreInProgress=!0,f.initializeFlowData()})},b.prototype.initiateOfferingSelection=function(a){var b=this;return this.storeFlowData("initiateOfferingSelection",arguments),this.getSelectedOfferingDetailsByOffering(a).then(function(a){b.currentFlow=new g(b.clientPages,b.routeManager,b.appointmentService,a,b.appConfig.getIsMobile(),b.$routeParams),b.initializeFlowData()})},b.prototype.initiateBookFromOfferPage=function(a){var b=this;return this.storeFlowData("initiateBookFromOfferPage",arguments),this.getSelectedOfferingDetailsByOffering(a).then(function(a){return b.initBookOfferingPage(a)})},b.prototype.initiateBookFromOfferPageLink=function(a){return this.storeFlowData("initiateBookFromOfferPageLink",arguments),this.initBookOfferingPage(a),this.$q.when({})},b.prototype.initBookOfferingPage=function(a){this.currentFlow=new f(this.clientPages,this.routeManager,this.appointmentService,a,this.experimentsEnabler,this.appConfig.getIsMobile(),this.$routeParams),this.initializeFlowData()},b.prototype.initOverEditorBookOfferingPage=function(a){return this.storeFlowData("initOverEditorBookOfferingPage",arguments),this.initBookOfferingPage(a),this.$q.when({})},b.prototype.initiateBookDeepLink=function(a){var b=this;return this.storeFlowData("initiateBookDeepLink",arguments),this.getSelectedOfferingDetailsByOffering(a).then(function(a){b.currentFlow=new e(b.clientPages,b.routeManager,b.offeringValidationsSrv,b.appointmentService,a,b.experimentsEnabler,b.appConfig.getIsMobile(),b.$routeParams),b.initializeFlowData()})},b.prototype.initiateReschedule=function(a){var b=this;return this.storeFlowData("initiateReschedule",arguments),this.getSelectedOfferingDetailsByBooking(a).then(function(c){b.currentFlow=new l(b.clientPages,b.routeManager,b.appointmentService,a,c,b.bookingHistorySrv,b.offeringDtoModifierSrv,b.experimentsEnabler,b.appConfig.getIsMobile(),b.$routeParams)}).then(function(){return b.initializeFlowData()})},b.prototype.initiateBookAnother=function(a){var b=this;return this.storeFlowData("initiateBookAnother",arguments),this.getSelectedOfferingDetailsByBooking(a).then(function(a){b.currentFlow=new k(b.clientPages,b.routeManager,b.appointmentService,a,b.experimentsEnabler,b.appConfig.getIsMobile(),b.$routeParams)}).then(function(){return b.initializeFlowData()})},b.prototype.initiateMemberAreaBookAnother=function(){return this.storeFlowData("initiateMemberAreaBookAnother",arguments),this.bookAnotherMemberArea.apply(this,arguments)},b.prototype.initiateMemberAreaReschedule=function(){return this.storeFlowData("initiateMemberAreaReschedule",arguments),this.rescheduleMemberArea.apply(this,arguments)},b.prototype.isRescheduleFlow=function(){return!!this.appointmentService.getCurrentBooking()},b.prototype.getSelectedOfferingDetailsByBooking=function(a){var b=a.offeringDetails.parentOfferingId||a.offeringDetails.id,c=!1;return this.getSelectedOfferingByOfferingId(b,c)},b.prototype.getSelectedOfferingDetailsByOffering=function(a){return this.getSelectedOfferingByOfferingId(a&&a.id,a&&a.dummy)},b.prototype.getSelectedOfferingByOfferingId=function(a,b){return a?this.offeringDetailsGetterSrv.gettingSelectedOfferingById(a,b):this.$q.when(null)},b.prototype.bookAnotherMemberArea=function(a){var b=this;return this.getSelectedOfferingDetailsByBooking(a).then(function(a){b.currentFlow=new j(b.clientPages,b.routeManager,b.appointmentService,a,b.experimentsEnabler,b.appConfig.getIsMobile(),b.$routeParams),b.initializeFlowData()})},b.prototype.rescheduleMemberArea=function(a){var b=this;return this.getSelectedOfferingDetailsByBooking(a).then(function(c){b.currentFlow=new m(b.clientPages,b.routeManager,b.appointmentService,a,c,b.bookingHistorySrv,b.offeringDtoModifierSrv,b.experimentsEnabler,b.appConfig.getIsMobile(),b.$routeParams,b.slotNotAvailableModalSrv,b.generalErrorModalSrv),b.initializeFlowData()})},b}(b.FlowManagerCore);b.FlowManagerSrv=n,angular.module("schedulerAngularClientAppInternal").service("flowManagerSrv",n)}(c=b.navigation||(b.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){function b(a,b){return a===c.INDIVIDUAL?0===b%3?"CUSTOMER":1===b%3?"BUSINESS":"OTHER":0===b%2?"BUSINESS":"OTHER"}var c=WixBookingsUoUDomain.OfferingType;a.createBookingHistoryStaffList=function(a){return new Array(a).fill(null).map(function(a,b){return{id:"staff-id-"+b,fullName:"Staff Name "+b}})},a.createBookingHistoryOfferings=function(a){return new Array(a).fill(null).map(function(a,d){var e=d%2?c.INDIVIDUAL:c.GROUP;return{type:e,id:"offering-id-"+d,name:"Offering: "+d+" - "+e,duration:10*(d+1),price:10.5,minCharge:0===d%2?2:null,currency:"USD",location:b(e,d),categoryId:0===d%2?"cat_id_1":"cat_id_2",locationText:0===d%2?"Other Location "+d:""}})},a.createServerBooking=function(a,b,d){return{bookingId:"booking-id-"+a,start:Date.now()+1e7,end:Date.now()+1e8,staffId:b[a%b.length].id,offeringId:d[a%d.length].id,locationInfo:"At the park, near bench "+a,numOfParticipants:1,allowedActions:{cancel:!!(a%5),reschedule:!!(a%3),bookAnother:!!(a%2)},groupInstanceId:d[a%d.length].type===c.GROUP?"id_"+a:null}},a.createBookingsFromServer=function(b,c,d){return new Array(b).fill(null).map(function(b,e){return a.createServerBooking(e,c,d)})},a.createTestingBookingList=function(a){var b;inject(function(a){return b=a});var d=new Array(a).fill(null).map(function(a,d){var e={name:"some offering name",id:"related-offering-id-"+d,type:c.INDIVIDUAL},f={fullName:"Staff Name",id:"related-staff-id-"+d};return b.buildBooking({bookingId:"booking-id-"+d,staffId:f.id,offeringId:e.id,start:Date.now()+1e5,end:Date.now()+1e8,location:"Some location "+d,allowedActions:{cancel:!0,reschedule:!0,bookAnother:!0}},f,e)});return{bookings:d}}}(b=a.account||(a.account={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a}();a.LoggedInUserIsOwner=b,angular.module("schedulerAngularClientAppInternal").component("bksNotificationModal",{template:'<div data-hook="notification-modal" class="notification-modal">\n                    <div class="notification-modal__content">\n                        <div data-hook="notification-modal-close" \n                             class="notification-modal__close scheduler-svg-font-icons-close"\n                             ng-click="$ctrl.dismiss()"></div>\n                        <div data-hook="notification-modal-message"\n                             class="notification-modal__message"\n                             ng-transclude></div>\n                        <button type="button" \n                              data-hook="notification-modal-confirm-button"\n                              ng-click="$ctrl.confirm()"\n                              class="notification-modal__action btn-primary">{{$ctrl.okLabel}}</button>\n                    </div>\n                 </div>',controller:b,transclude:!0,bindings:{dismiss:"&",confirm:"&",okLabel:"@"}})}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(){angular.module("schedulerAngularClientAppInternal").component("bksWalletPaymentNotificationModal",{template:'<div class="wallet-payment-notification__popover">\n                    <div data-hook="wallet-payment-notification" class="wallet-payment-notification__container">\n                       <div data-hook="wallet-payment-notification-title" class="wallet-payment-notification__title">{{$ctrl.notificationTitle}}</div>\n                       <div data-hook="wallet-payment-notification-message" class="wallet-payment-notification__message">{{$ctrl.notificationMessage}}</div>\n                    </div>\n                 </div>\n                 <div class="wallet-payment-notification__background"></div>',bindings:{notificationTitle:"@",notificationMessage:"@"}})}(b=a.payment||(a.payment={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.URL_PREFIX="_api/bookings-viewer/",a.VISITOR_OFFERINGS="offerings/",a.BOOKING_API_PREFIX="_api/bookings-server/",a.BOOKING_AVAILABILITY=a.BOOKING_API_PREFIX+"v1/bookings/availability",a}();a.OfferingsApiConst=b;var c=function(){function a(a,c){var d=this;this.commonApiBase=a,this.$http=c,this.gettingOfferingsList=this.commonApiBase.httpWrapper(function(){return d.$http.get(d.prefix()+b.VISITOR_OFFERINGS)
}),this.gettingOfferingDetailsById=this.commonApiBase.httpWrapper(function(a){return d.$http.get(d.prefix()+b.VISITOR_OFFERINGS+a)}),this.getOfferingAvailabilityByScheduleId=this.commonApiBase.httpWrapper(function(a){return d.$http.get(b.BOOKING_AVAILABILITY+"?partySize=1&scheduleId="+a)})}return a.$inject=["commonApiBase","$http"],a.prototype.prefix=function(){return b.URL_PREFIX},a}();a.OfferingsApi=c,angular.module("schedulerAngularClientAppInternal").service("offeringsApi",c)}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=WixBookingsUoUDomain.OfferedAsType,c=WixBookingsUoUDomain.OfferingType,d=function(a){return a.schedulePolicy.staffMembersIds},e=function(a){var b=a.schedule.classHours,c=Object.keys(b).map(function(a){return b[a]}).reduce(function(a,b){return b&&b.workingHours&&b.workingHours.forEach(function(b){b.staffId&&(a[b.staffId]=!0)}),a},{});return Object.keys(c)},f=function(){function a(){}return a.fromDto=function(a){switch(a.type){case c.INDIVIDUAL:return d;case c.COURSE:case c.GROUP:return e}},a}(),g=function(){function a(){}return a.fromDto=function(a,b){return a?new h(a,f.fromDto(a),b):null},a}();a.OfferingFactory=g;var h=function(){function c(a,b,c){this.dto=a,this.staffMembersExtractor=b,this.isPricingPlanInstalled=c}return c.prototype.toDto=function(){return this.dto},Object.defineProperty(c.prototype,"staffMemberIds",{get:function(){return this.staffMembersExtractor(this.dto)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"id",{get:function(){return this.dto.id},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"type",{get:function(){return this.dto.type},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"categoryId",{get:function(){return this.dto.categoryId},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"order",{get:function(){return this.dto.order},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"name",{get:function(){return this.dto.info.name},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"description",{get:function(){return this.dto.info.description},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"images",{get:function(){return this.dto.info.images},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"urlName",{get:function(){return this.dto.urlName},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"capacity",{get:function(){return this.dto.schedulePolicy.capacity},enumerable:!0,configurable:!0}),c.prototype.hasDuration=function(){return"durationInMinutes"in this.dto.schedule},c.prototype.hasRepeatEveryXWeeks=function(){return"repeatEveryXWeeks"in this.dto.schedule},Object.defineProperty(c.prototype,"duration",{get:function(){return this.hasDuration()?this.dto.schedule.durationInMinutes:null},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isDurationVaries",{get:function(){return this.dto.schedule.isDurationVaries},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"currency",{get:function(){return this.dto.payment.currency},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"schedule",{get:function(){return this.dto.schedule},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"startDate",{get:function(){return this.dto.schedule.startDate},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"endDate",{get:function(){return this.dto.schedule.endDate},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"price",{get:function(){return this.dto.payment.price},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isFree",{get:function(){return this.dto.payment.isFree},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"priceText",{get:function(){return this.dto.payment.priceText},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"paymentType",{get:function(){return this.dto.payment.paymentType},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isHidden",{get:function(){return this.dto.schedulePolicy.uouHidden},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isCourseFull",{get:function(){return this.dto.schedulePolicy.isCourseFull},set:function(a){this.dto.schedulePolicy.isCourseFull=a},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"dummy",{get:function(){return!!this.dto.dummy},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"offeredAs",{get:function(){if(this.dto.offeredAs.indexOf(b.ONE_TIME)>=0&&this.dto.offeredAs.indexOf(b.PRICING_PLAN)>=0){if(0===this.pricingPlanInfo.pricingPlans.length)return[b.ONE_TIME];if(!this.isPricingPlanInstalled)return[b.ONE_TIME]}return this.dto.offeredAs},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"pricingPlanInfo",{get:function(){return this.dto.pricingPlanInfo},enumerable:!0,configurable:!0}),c.prototype.toLegacyService=function(){return a.OfferingDomainToLegacyServiceMapper.map(this)},Object.defineProperty(c.prototype,"isPossibleToBook",{get:function(){return!this.dto.schedulePolicy.displayOnlyNoBookFlow},enumerable:!0,configurable:!0}),c}();a.Offering=h}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(b,c){var d=this;this.dto=b,this.categoryToOfferingsMapping=new Map,this.offeringDomains=b.offerings.map(function(b){return a.OfferingFactory.fromDto(b,c)}),this.offeringDomains.forEach(function(a){return d.addOfferingDomainToMap(a)}),this.filterEmptyCategory()}return b.prototype.filterEmptyCategory=function(){var a=this;this.dto.categories=this.dto.categories.filter(function(b){return a.categoryToOfferingsMapping.get(b.id)&&a.categoryToOfferingsMapping.get(b.id).length>0})},Object.defineProperty(b.prototype,"categories",{get:function(){return this.dto.categories},enumerable:!0,configurable:!0}),b.prototype.getForCategoryId=function(a){return this.categoryToOfferingsMapping.get(a)||[]},b.prototype.getAll=function(){return this.offeringDomains},b.prototype.find=function(a){return this.offeringDomains.find(function(b){return b.id===a})||null},b.prototype.addOfferingDomainToMap=function(a){var b=a.categoryId;this.categoryToOfferingsMapping.has(b)||this.categoryToOfferingsMapping.set(b,[]),this.categoryToOfferingsMapping.get(b).push(a)},b}();a.OfferingsProvider=b}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a,b,c,d,e,f){this.offeringsApi=a,this.boostInjectionPersister=b,this.overEditor=c,this.$q=d,this.experimentsEnabler=e,this.membershipSrv=f}return b.$inject=["offeringsApi","boostInjectionPersister","overEditor","$q","experimentsEnabler","membershipSrv"],b.prototype.gettingOfferingsList=function(){var b=this;return this.membershipSrv.isPricingPlanInstalled().then(function(c){return b.gettingRawOfferings().then(function(b){return new a.OfferingsProvider(b,c)})})},b.prototype.getBy=function(a){return this.gettingOfferingsList().then(function(b){return b.find(a)})},b.prototype.gettingRawOfferings=function(){var a=this;return this.gettingOfferingFromServer().then(function(b){return a.overEditor.enrichOfferingListIfOverEditor(b)})},b.prototype.gettingOfferingFromServer=function(){var a=this.boostInjectionPersister.getOfferingsList();return a?this.$q.when(a):this.offeringsApi.gettingOfferingsList()},b}();a.OfferingsListGetterSrv=b,angular.module("schedulerAngularClientAppInternal").service("offeringsListGetterSrv",b)}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.selectedCategoryId=null}return a.prototype.setSelectedCategoryId=function(a){this.selectedCategoryId=a},a.prototype.getSelectedCategoryId=function(){return this.selectedCategoryId},a}();a.SelectedCategorySrv=b,angular.module("schedulerAngularClientAppInternal").service("selectedCategorySrv",b)}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=WixBookingsUoUDomain.OfferingType,c=function(){function a(){}return a.mainDataMapper=function(a){return{id:a.id,type:a.type,order:a.order,urlName:a.urlName,categoryId:a.categoryId,offeredAs:a.offeredAs}},a.infoMapper=function(a){return __assign({},a.info)},a.locationMapper=function(a){return{locationText:a.location.locationText,location:a.location.type}},a.paymentMapper=function(a){return __assign({},a.payment)},a.scheduleMapper=function(a){return __assign({},a.schedule)},a.schedulePolicyMapper=function(a){return __assign({},a.schedulePolicy,{numberOfParticipants:1})},a.pricingPlanMapper=function(a){return{pricingPlanInfo:a}},a.conferenceProviderMapper=function(a){return{conferenceProvider:a.conferenceProvider}},a.groupScheduleMapper=function(b){return __assign({},a.scheduleMapper(b),{duration:b.schedule.durationInMinutes,classHours:b.schedule.classHours})},a.groupSchedulePolicyMapper=function(b){return __assign({},a.schedulePolicyMapper(b))},a.individualScheduleMapper=function(b){return __assign({},a.scheduleMapper(b),{duration:b.schedule.durationInMinutes})},a.individualSchedulePolicyMapper=function(b){return __assign({},a.schedulePolicyMapper(b),{staffMembers:b.schedulePolicy.staffMembersIds})},a.courseScheduleMapper=function(b,c){return __assign({},a.scheduleMapper(b),{classHours:b.schedule.classHours},c.hasRepeatEveryXWeeks()?{repeatEveryXWeeks:b.schedule.repeatEveryXWeeks}:{})},a.courseSchedulePolicyMapper=function(b){return __assign({},a.schedulePolicyMapper(b))},a.commonMapper=function(b){return __assign({},a.infoMapper(b),a.locationMapper(b),a.paymentMapper(b),a.mainDataMapper(b))},a.groupOfferingMapper=function(b){return __assign({},a.groupSchedulePolicyMapper(b),a.groupScheduleMapper(b),a.pricingPlanMapper(b.pricingPlanInfo),a.commonMapper(b),a.conferenceProviderMapper(b))},a.individualOfferingMapper=function(b){return __assign({},a.individualSchedulePolicyMapper(b),a.individualScheduleMapper(b),a.pricingPlanMapper(b.pricingPlanInfo),a.commonMapper(b),a.conferenceProviderMapper(b))},a.courseOfferingMapper=function(b,c){return __assign({},a.courseSchedulePolicyMapper(b),a.courseScheduleMapper(b,c),a.commonMapper(b),a.conferenceProviderMapper(b))},a.map=function(c){var d,e=c.toDto();switch(e.type){case b.GROUP:d=a.groupOfferingMapper;break;case b.INDIVIDUAL:d=a.individualOfferingMapper;break;case b.COURSE:d=a.courseOfferingMapper}return __assign({},d(e,c),{dummy:c.dummy,isPricingPlanInstalled:c.isPricingPlanInstalled})},a}();a.OfferingDomainToLegacyServiceMapper=c}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.domain=a,this.showFullText=!1}return Object.defineProperty(a.prototype,"id",{get:function(){return this.domain.id},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"type",{get:function(){return this.domain.type},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"name",{get:function(){return this.domain.name},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"description",{get:function(){return this.domain.description},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"images",{get:function(){return this.domain.images},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"capacity",{get:function(){return this.domain.capacity},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"duration",{get:function(){return this.domain.duration},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"currency",{get:function(){return this.domain.currency},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"offeredAs",{get:function(){return this.domain.offeredAs},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"startDate",{get:function(){return this.domain.startDate},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"price",{get:function(){return this.domain.price},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isFree",{get:function(){return this.domain.isFree},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"priceText",{get:function(){return this.domain.priceText},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"urlName",{get:function(){return this.domain.urlName},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"pricingPlanInfo",{get:function(){return this.domain.pricingPlanInfo},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isPricingPlanInstalled",{get:function(){return this.domain.isPricingPlanInstalled},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"paymentType",{get:function(){return this.domain.paymentType},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isPossibleToBook",{get:function(){return this.domain.isPossibleToBook},enumerable:!0,configurable:!0}),a.prototype.toLegacyService=function(){return this.domain.toLegacyService()},a.prototype.toDomainOffering=function(){return this.domain},a}();a.OfferingListItemVm=b}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(){var a=function(){function a(a,b){this.$filter=a,this.offeringSettingKeysGetterSrv=b}return a.$inject=["$filter","offeringSettingKeysGetterSrv"],a.prototype.$onInit=function(){this.offeringLearnMoreSeoUrl=this.pageUrl+"/"+this.offering.urlName},a.prototype.getButtonText=function(){var a=this.offering.isPossibleToBook?this.settingKeys.text.bookButtonText:this.settingKeys.text.moreInfoButtonText;return this.offering.isPossibleToBook?this.$filter("wixSdkTranslate")("service-select-button",a):this.$filter("wixSdkTranslate")("service-tile.more-info",a)},a.prototype.getCustomClass=function(){return this.settingKeys.design.offeringType},Object.defineProperty(a.prototype,"settingKeys",{get:function(){return this.offeringSettingKeysGetterSrv.getKeys().offeringsList},enumerable:!0,configurable:!0}),a}();angular.module("schedulerAngularClientAppInternal").component("bksOfferingTile",{template:'<boost-service-tile service="$ctrl.offering"\n                                       size="{{$ctrl.size}}"\n                                       template="{{$ctrl.template}}"\n                                       config="$ctrl.tileConfig"\n                                       button-text="{{$ctrl.getButtonText()}}"\n                                       custom-class="{{$ctrl.getCustomClass()}}"\n                                       learn-more-seo-url="{{$ctrl.offeringLearnMoreSeoUrl}}"\n                                       style="width:100%;"></boost-service-tile>',controller:a,bindings:{offering:"=",size:"@",template:"@",tileConfig:"=config",pageUrl:"@"}})}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(){var b=function(a){function b(b,c){var d,e=a.call(this,b,c)||this;return e.offeringTypeForStyles===OfferingType.INDIVIDUAL?(e.tileTemplate=b.getServiceListTemplate(),e.tileConfig=b.getServiceTileConfig(),d=b.getIndividualCategoryLayout()):(e.tileTemplate=b.getGroupListTemplate(),e.tileConfig=b.getGroupsTileConfig(),d=b.getGroupsCategoryLayoutType()),e.columnsAmount=b.getNumberOfColumns(e.tileTemplate,d),e.serviceItemClass=e.mapColumnsAmountToClass(),e}return __extends(b,a),b.$inject=["appSettings","SERVICE_CATEGORY_LAYOUT"],b}(a.boost.visitor.ServicesList);angular.module("schedulerAngularClientAppInternal").component("bksOfferingItemsList",{templateUrl:"modules/offering/offering-list/offering-items-list/offering-items-list.preload.html",bindings:{offerings:"=",offeringTypeForStyles:"@",category:"=",pageUrl:"@"},controller:b})}(c=b.offerings||(b.offerings={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.visitor.preview.ModalTypes,d=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){var x=this;this.$scope=a,this.$rootScope=b,this.SERVICE_CATEGORY_LAYOUT=c,this.groupsSrv=d,this.flowManagerSrv=e,this.clientPages=f,this.TILE_LIST_EVENTS=g,this.overEditor=h,this.visitorBILogger=i,this.offeringValidationsSrv=j,this.appSettings=k,this.IS_ONBOARDING=l,this.offeringSettingKeysGetterSrv=m,this.$filter=n,this.experimentsEnabler=o,this.pricingPlanApiSrv=p,this.trackingSrv=q,this.previewModalSrv=r,this.appConfig=s,this.selectedCategorySrv=t,this.appointmentService=u,this.modal=v,this.couponsSrv=w,this.groupSelectedButNotPremium=!1,this.pricingPlanOfferingSelectedButNotConnected=!1,this.updateOfferingsPerCategory=function(a){x.updateCategoryId(a),x.currentOfferings=x.getOfferingsForCategory(a),x.trackingSrv.trackOfferingsViewFromOfferingList(x.currentOfferings.map(function(a){return a.toDomainOffering()}))},this.categories=this.offeringsList.categories,this.isNoServicesOverEditor=h.isOverEditor&&this.offeringsList.getAll().length&&this.offeringsList.getAll()[0].dummy,this.serviceStyleClass=this.offeringSettingKeysGetterSrv.getKeys().offeringsList.design.offeringType,this.offeringTypeForSettings="service"===this.serviceStyleClass?OfferingType.INDIVIDUAL:OfferingType.GROUP,this.offeringTypeForSettings===OfferingType.INDIVIDUAL?(this.categoriesType=k.getIndividualCategoryLayout(this.categories.length),this.tileTemplate=k.getServiceListTemplate()):(this.categoriesType=k.getGroupsCategoryLayoutType(this.categories.length),this.tileTemplate=k.getGroupListTemplate()),this.registerListeners(),this.initiateSelectedCategory(),u.clearBookingFlow(),w.clearLastAppliedCoupon()}return a.$inject=["$scope","$rootScope","SERVICE_CATEGORY_LAYOUT","groupsSrv","flowManagerSrv","clientPages","TILE_LIST_EVENTS","overEditor","visitorBILogger","offeringValidationsSrv","appSettings","IS_ONBOARDING","offeringSettingKeysGetterSrv","$filter","experimentsEnabler","pricingPlanApiSrv","trackingSrv","previewModalSrv","appConfig","selectedCategorySrv","appointmentService","modal","couponsSrv"],a.prototype.initiateSelectedCategory=function(){this.categories&&this.categories.length>0&&this.updateOfferingsPerCategory(this.selectedCategorySrv.getSelectedCategoryId()||this.categories[0].id)},a.prototype.registerListeners=function(){var a=this;this.$scope.$on(this.TILE_LIST_EVENTS.TILE_SELECTED,function(b,c){a.next(c)}),this.$scope.$on(this.TILE_LIST_EVENTS.TILE_SHOW_DETAILS,function(b,c,d){a.nextToMoreDetails(c,d)})},a.prototype.isPageTitleShown=function(){return this.offeringSettingKeysGetterSrv.getOfferingTitleDefinitions().titleCanBeVisible&&!!this.getTitleText()},a.prototype.getPageTitle=function(){var a=this.offeringSettingKeysGetterSrv.getOfferingTitleDefinitions().titleOverrideValue;return a||this.getTitleText()},a.prototype.shouldShowErrorMessage=function(){return this.groupSelectedButNotPremium||this.pricingPlanOfferingSelectedButNotConnected},a.prototype.getErrorMessageTranslationKey=function(){return this.groupSelectedButNotPremium?"offering-list.premium-not-enabled.message":this.pricingPlanOfferingSelectedButNotConnected?"offering-list.pricing-plan-not-enabled.message":""},a.prototype.getTitleText=function(){var a=this.offeringSettingKeysGetterSrv.getKeys().offeringsList.text.title;return this.$filter("wixSdkTranslate")("offering-list.title",a)},a.prototype.hasOfferings=function(){return this.currentOfferings&&this.currentOfferings.length>0},a.prototype.isShowInstruction=function(){return this.overEditor.isEditModeAndNotVisitedOwner()&&this.IS_ONBOARDING},a.prototype.isCategoriesAvailable=function(){return this.categoriesType!==this.SERVICE_CATEGORY_LAYOUT.NONE},a.prototype.updateCategoryId=function(a){this.selectedCategory=a,this.selectedCategorySrv.setSelectedCategoryId(a)},a.prototype.next=function(a){var b=this;this.visitorBILogger.bookIt(a.type,a.id,a.pricingPlanInfo&&a.pricingPlanInfo.pricingPlans&&!!a.pricingPlanInfo.pricingPlans.length,a.offeredAs,!1,a.isPossibleToBook),this.trackingSrv.trackOfferingBookingClick(a.toDomainOffering()),this.flowManagerSrv.initiateOfferingSelection(a.toLegacyService()).then(function(){return b.navigate(a)})},a.prototype.nextToMoreDetails=function(a,b){var c=this;this.visitorBILogger.logShowOfferingDetails(b,a.isPossibleToBook),this.trackingSrv.trackOfferingClickFromOfferingList(a.toDomainOffering(),this.currentOfferings.indexOf(a)),this.flowManagerSrv.initiateBookFromOfferPage(a.toLegacyService()).then(function(){c.flowManagerSrv.next()})},a.prototype.navigate=function(a){this.offeringValidationsSrv.isOfferingAllowedForSelectionByPremium(a.type)||this.isUnBookableOffering(a)?this.offeringValidationsSrv.isOfferingOfferedAsPricingPlan(a)&&a.isPossibleToBook?this.doPricingPlanNavigation(a):this.flowManagerSrv.next():(this.visitorBILogger.bookedGroupButNotPremium(),this.groupsSrv.notifyingNonPremiumEnrollmentAttempt(),this.showGroupButNotPremiumNotification())},a.prototype.isUnBookableOffering=function(a){return!a.isPossibleToBook},a.prototype.doPricingPlanNavigation=function(a){var b=this.offeringValidationsSrv.isOfferingConnectedToPricingPlan(a),c=a.isPricingPlanInstalled;c&&b?this.flowManagerSrv.next():(this.pricingPlanApiSrv.notifyingNonPricingPlanEnrollmentAttempt(a),this.showPlanNotConnectedNotification())},a.prototype.showGroupButNotPremiumNotification=function(){var a=this;this.previewModalSrv.openModal(c.PREVIEW_PREMIUM_MODAL),this.appConfig.getIsOwner().then(function(b){b||(a.groupSelectedButNotPremium=!0,a.modal.openNonBookableOfferingSelected(a.getErrorMessageTranslationKey()))})},a.prototype.showPlanNotConnectedNotification=function(){this.pricingPlanOfferingSelectedButNotConnected=!0,this.modal.openNonBookableOfferingSelected(this.getErrorMessageTranslationKey())},a.prototype.getOfferingsForCategory=function(a){var c=this.isCategoriesAvailable()?this.offeringsList.getForCategoryId(a):this.offeringsList.getAll();return c.map(function(a){return new b.OfferingListItemVm(a)})},a}();b.OfferingListPage=d,angular.module("schedulerOfferingsAppInternal").component("bksOfferingListPage",{templateUrl:"modules/offering/offering-list/offering-list-page/desktop/offering-list-page.preload.html",bindings:{offeringsList:"=",pageUrl:"@"},controller:d})}(c=b.offerings||(b.offerings={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(b){var c;!function(b){var c=a.visitor.preview.ModalTypes,d=a.boost.common.constants.Timezones,e=a.bookings.common.domain.DefaultTimezoneOptions,f=function(a){function b(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G){var H=a.call(this,b,f,g,c)||this;return H.$rootScope=c,H.routeManager=d,H.clientPages=e,H.$wix=h,H.$translate=i,H.experimentManager=j,H.experimentsEnabler=k,H.flowManagerSrv=l,H.offeringValidationsSrv=m,H.$routeParams=n,H.switchTimezoneSrv=o,H.visitorTimezoneSrv=p,H.groupsSrv=q,H.visitorBILogger=r,H.scrollToElementSrv=s,H.commonServices=t,H.wixBiLogger=u,H.pricingPlanApiSrv=v,H.previewModalSrv=w,H.premiumService=x,H.overEditor=y,H.trackingSrv=z,H.historyAdapter=A,H.appConfig=B,H.modal=C,H.timezoneUtils=D,H.appointmentService=E,H.futureBookingSrv=F,H.siteUrlManagerSrv=G,H.shouldShowPremiumGroupMessage=!1,H.pricingPlanOfferingSelectedButNotConnected=!1,H.currentTimezone=H.determineInitialTimezone(H.$routeParams.timezone),H.defineProps(),H.sendAnalytics(),H.initOfferingUrl(),H}return __extends(b,a),b.$inject=["$locale","$rootScope","routeManager","clientPages","wixAngularTopology","commonApiConst","$wix","$translate","experimentManager","experimentsEnabler","flowManagerSrv","offeringValidationsSrv","$routeParams","switchTimezoneSrv","visitorTimezoneSrv","groupsSrv","visitorBILogger","scrollToElementSrv","commonServices","wixBiLogger","pricingPlanApiSrv","previewModalSrv","premiumService","overEditor","trackingSrv","historyAdapter","appConfig","modal","timezoneUtils","appointmentService","futureBookingSrv","siteUrlManagerSrv"],b.prototype.defineProps=function(){this.initExperiments(),this.initBiParams(),this.initCallbackProps(),this.initOffering(),this.initBusinessInfo(),this.initOnOfferingsListRequestedAction(),this.experimentsEnabler.isBookingsOfferingPageTimezoneEnabled()&&!this.visitorTimezoneSrv.isBusinessTimezoneEqualToVisitorTimezone(this.businessTimezone,this.userTimezone)&&this.initTimezoneObject(),this.initViewMode()},b.prototype.initViewMode=function(){this.props.viewMode={deviceType:this.$wix.Utils.getDeviceType()}},b.prototype.initOfferingUrl=function(){this.offering&&this.siteUrlManagerSrv.replaceUrl(this.offering.urlName)},b.prototype.sendAnalytics=function(){this.offering&&this.trackingSrv.trackOfferingPageLoads({id:this.offering.id,name:this.offering.name,categoryId:this.offering.categoryId,type:this.offering.type,price:this.offering.price,currency:this.offering.currency})},b.prototype.getBiOfferingType=function(){return this.offering.type},b.prototype.showBackButton=function(){return!this.overEditor.isPreviewMode()&&!this.historyAdapter.isHistoryEmpty()},b.prototype.shouldShowErrorMessage=function(){return this.shouldShowPremiumGroupMessage||this.pricingPlanOfferingSelectedButNotConnected},b.prototype.getErrorMessageTranslationKey=function(){return this.shouldShowPremiumGroupMessage?"offering-list.premium-not-enabled.message":this.pricingPlanOfferingSelectedButNotConnected?"offering-list.pricing-plan-not-enabled.message":""},b.prototype.backAction=function(){this.visitorBILogger.backButtonPressed("offering_page",this.getBiOfferingType()),this.props.onOfferingsListRequested(WixBookingsUoUOfferingPage.OnOfferingListRequestedReason.BACK)},b.prototype.initOnOfferingsListRequestedAction=function(){var a=this;this.props.onOfferingsListRequested=function(b){return b===WixBookingsUoUOfferingPage.OnOfferingListRequestedReason.NOT_FOUND?a.routeManager.replacePage(a.clientPages.VISITOR_SERVICES):a.flowManagerSrv.prev()}},b.prototype.navigateToCalendar=function(){this.flowManagerSrv.next()},b.prototype.initOffering=function(){this.experimentsEnabler.isBookingsOfferingPageTimezoneEnabled()&&this.offering&&(this.offering.classHours=this.timezoneUtils.applyTimezoneOnWorkingHours(this.offering.classHours,this.businessTimezone.name,this.getCurrentTimezoneName())),this.props.offering=this.offering},b.prototype.getCurrentTimezoneName=function(){return this.currentTimezone===d.BUSINESS?this.businessTimezone.name:this.userTimezone.name},b.prototype.initExperiments=function(){this.props.experiments=this.experimentManager.provider.experiments,this.props.isPricingPlanEnabled=!0},b.prototype.initBusinessInfo=function(){this.props.businessInfo=this.businessInfo,this.props.timezoneNote=this.timezoneNote},b.prototype.scrollToElementBySelector=function(a,b){return void 0===b&&(b=0),this.scrollToElementSrv.scroll(a,b)},b.prototype.onTimezoneSwitch=function(a){var b=this.offering.type,c="offering_page";this.visitorBILogger.timezoneSwitched({timezone:a,type:b,referralInfo:c}),this.routeManager.gotoPage(this.clientPages.OFFERING_PAGE+"/"+a)},b.prototype.determineInitialTimezone=function(a){return angular.isDefined(a)?+a:this.businessInfo.timezoneProperties.defaultTimezone===e.BUSINESS?d.BUSINESS:d.USER},b.prototype.initTimezoneObject=function(){var a=this,b=this.experimentsEnabler.isBookingsOfferingPageTimezoneEnabled(),c=+!this.currentTimezone,e=this.businessTimezone.name,f=this.userTimezone.name,g=[{value:d.BUSINESS,content:this.switchTimezoneSrv.getDropdownTextBasedOnTimezone({timezone:d.BUSINESS,businessTimezone:e,userTimezone:f})},{value:d.USER,content:this.switchTimezoneSrv.getDropdownTextBasedOnTimezone({timezone:d.USER,businessTimezone:e,userTimezone:f})}];this.props.timezoneIndicatorProperties={label:this.switchTimezoneSrv.getBookingBaseOnTimeZoneText({timezone:this.currentTimezone,isBookingsTimezoneIndicatorImprovementEnabled:b,businessTimezone:e,userTimezone:f}),actionText:this.switchTimezoneSrv.getActionTextBaseOnTimeZone(this.currentTimezone,this.appConfig.getIsMobile()),onTimezoneSwitch:function(b){return void 0===b&&(b=c),a.onTimezoneSwitch(b)},mobileDropdownOptions:g,selectedOption:this.currentTimezone,isNoteOnly:!this.businessInfo.timezoneProperties.clientCanChooseTimezone}},b.prototype.initCallbackProps=function(){var a=this;this.props.onScrollBottom=function(b){return void 0===b&&(b='[data-hook="reservation-summary"]'),a.scrollToElementBySelector(b,25)},this.props.setUrlState=function(){return null},this.props.getScaleToFillImageUrl=function(b){var c=b.relativeUri,d=b.sourceWidth,e=b.sourceHeight,f=b.targetHeight,g=b.targetWidth;return a.commonServices.getImageUrl([{relativeUri:c,width:d,height:e}],{height:f,width:g})},this.props.onBook=function(){if(a.trackingSrv.trackOfferingBookingClick(a.offering),a.offeringValidationsSrv.isOfferingAllowedForSelectionByPremium(a.offering.type))if(a.offering.type===OfferingType.COURSE&&a.storeSelectedTimezone(),a.offeringValidationsSrv.isOfferingOfferedAsPricingPlan(a.offering))a.doPricingPlanNavigation();else{if(a.experimentsEnabler.isEnforcePolicyOnCourseEnabled()&&a.offering.type===OfferingType.COURSE){if(a.offering.futureBookingsPolicy&&!a.isOfferingOpenForBookInAdvance())return a.notifyNotOpenForBookInAdvance(a.offering.futureBookingsPolicy.limitXMinutesToTheFuture),void 0;if(a.isOfferingPassBookingWindow())return a.notifyOfferingPassBookingWindow(),void 0}a.offering.type!==OfferingType.COURSE||a.premiumService.isOfferingTypeFeatureEnabled(a.offering.type)||a.overEditor.isDemoMode||a.previewModalSrv.openModal(c.PREVIEW_PREMIUM_MODAL),a.navigateToCalendar()}else a.showGroupButNotPremiumNotification(),a.visitorBILogger.bookedGroupButNotPremium(),a.groupsSrv.notifyingNonPremiumEnrollmentAttempt()}},b.prototype.isOfferingOpenForBookInAdvance=function(){if(this.offering.futureBookingsPolicy){var a=this.offering.futureBookingsPolicy,b=a.shouldLimit,c=a.limitXMinutesToTheFuture;return this.futureBookingSrv.isTimeInBookingWindow({startTime:moment(this.offering.startDate),shouldLimit:b,limitXMinutesToTheFuture:c})}},b.prototype.isOfferingPassBookingWindow=function(){var a=this.offering.bookUpToXMinutesBefore;return this.futureBookingSrv.isPassBookingWindow({startTime:moment(this.offering.startDate),bookUpToXMinutesBefore:a})
},b.prototype.notifyNotOpenForBookInAdvance=function(a){var b=this.futureBookingSrv.splitDuration(a),c=this.$translate("offering-page.to-far-from-booking",{duration:b}),d=this.$translate("offering-page.modal.confirm");this.openMessageModal(c,d)},b.prototype.notifyOfferingPassBookingWindow=function(){var a=this.$translate("offering-page.to-close-for-booking"),b=this.$translate("offering-page.modal.confirm");this.openMessageModal(a,b)},b.prototype.openMessageModal=function(a,b){this.previewModalSrv.openModal(c.MESSAGE_MODAL,"dynamic",a,b)},b.prototype.doPricingPlanNavigation=function(){var a=this.offeringValidationsSrv.isOfferingConnectedToPricingPlan(this.offering),b=this.offering.isPricingPlanInstalled;b&&a?this.flowManagerSrv.next():(this.showPlanNotConnectedNotification(),this.pricingPlanApiSrv.notifyingNonPricingPlanEnrollmentAttempt(this.offering))},b.prototype.showGroupButNotPremiumNotification=function(){var a=this;this.previewModalSrv.openModal(c.PREVIEW_PREMIUM_MODAL),this.appConfig.getIsOwner().then(function(b){b||(a.shouldShowPremiumGroupMessage=!0,a.modal.openNonBookableOfferingSelected(a.getErrorMessageTranslationKey()))})},b.prototype.showPlanNotConnectedNotification=function(){this.pricingPlanOfferingSelectedButNotConnected=!0,this.modal.openNonBookableOfferingSelected(this.getErrorMessageTranslationKey())},b.prototype.initBiParams=function(){this.props.defaultBIParams=this.wixBiLogger.getConfig().defaultEventArgs},b.prototype.storeSelectedTimezone=function(){var a=this.appointmentService.getSelectedTime();this.appointmentService.setSelectedTime(__assign({},a,{timeZone:this.getCurrentTimezoneName()}))},b.prototype.getModuleName=function(){return b.MODULE},b.MODULE="bookings-offering-page",b}(a.bookings.common.ReactRendererCtrl);b.OfferingPage=f,angular.module("schedulerAngularClientAppInternal").component("bksOfferingPage",{template:'\n      <div class=\'visitor-header visitor-header--no-title\'>\n        <div class="visitor-header--back">\n          <div class="header__back-btn" data-hook="back-button" ng-if="$ctrl.showBackButton()" ng-click="$ctrl.backAction()" role="button" tabindex="0">\n            <div aria-hidden="true" class="back-btn-icon scheduler-svg-font-icons-arrow-left"></div>\n            <div class="back-btn-text">{{\'visitor.navigate.back\'|translate}}</div>\n          </div>\n        </div>\n      </div>\n      <div class="offering-page" ng-class="{\'offering-page-wrapper\': $ctrl.shouldShowErrorMessage()}" data-hook="offering-page">\n        '+a.bookings.common.ReactRendererCtrl.getTemplate("BookingsOfferingPage")+"\n      </div>",bindings:{offering:"<",timezoneNote:"@",businessInfo:"<",userTimezone:"=",businessTimezone:"="},controller:f}).factory("BookingsOfferingPage",function(){return WixBookingsUoUOfferingPage.default})}(c=b.offering_page||(b.offering_page={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(b,c,d,e,f,g){var h=a.call(this,b,d,e,c)||this;return h.$rootScope=c,h.timezoneUtils=f,h.appointmentService=g,h.defineProps(),h}return __extends(b,a),b.$inject=["$locale","$rootScope","wixAngularTopology","commonApiConst","timezoneUtils","appointmentService"],b.prototype.getModuleName=function(){return b.MODULE},b.prototype.shouldShowIntervals=function(){return this.props.offering&&this.props.offering.type===OfferingType.COURSE},b.prototype.defineProps=function(){this.initOffering()},b.prototype.initOffering=function(){var a=this.appointmentService.getSelectedOffering(),b=this.appointmentService.getSelectedTime().timeZone;this.businessTimezone!==b&&(a.classHours=this.timezoneUtils.applyTimezoneOnWorkingHours(a.classHours,this.businessTimezone,b)),this.props.offering=a},b.MODULE="bookings-offering-page",b}(a.bookings.common.ReactRendererCtrl);b.CourseSchedulingIntervalsCtrl=c,angular.module("schedulerAngularClientAppInternal").component("bksCourseSchedulingIntervals",{template:'\n       <div ng-if="$ctrl.shouldShowIntervals()" data-hook="course-scheduling-intervals-wrapper" data-business-timezone="{{$ctrl.businessTimezone}}">\n          '+a.bookings.common.ReactRendererCtrl.getTemplate("BksCourseSchedulingIntervals")+"\n      </div>",controller:c,bindings:{businessTimezone:"@"}}).factory("BksCourseSchedulingIntervals",function(){return WixBookingsUoUOfferingPage.CourseSchedulingIntervals})}(c=b.offerings||(b.offerings={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){function b(a,b){return a&&!a.Styles.getStyleParams()&&b&&"site"===a.Utils.getViewMode()}function c(a,b,c){a&&(b[c](),b[c]=function(b){void 0===b&&(b=function(){return null});var c=a;return b(c),c})}function d(a,d){if(b(a,d)){var e=JSON.parse(d);e&&(c(e.styleParams,a.Styles,"getStyleParams"),c(e.siteColors,a.Styles,"getSiteColors"),c(e.textPresets,a.Styles,"getSiteTextPresets"))}}a.initSdkFromSiteQuery=d}(b=a.sdk||(a.sdk={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));